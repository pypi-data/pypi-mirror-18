THEANO_FLAGS=floatX=float32,device=gpu,nvcc.fastmath=True,optimizer=None
/l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab
Enabled computing test values for tensor variables.
Warning: GpuArray backend will fail random number generation!
Reading vocabulary from /l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab.
Number of words in vocabulary: 10001
Number of word classes: 10001
2016-11-25 01:23:39,272 train: TRAINING OPTIONS
2016-11-25 01:23:39,272 train: batch_size: 32
2016-11-25 01:23:39,272 train: patience: 0
2016-11-25 01:23:39,272 train: sequence_length: 25
2016-11-25 01:23:39,272 train: min_epochs: 1
2016-11-25 01:23:39,272 train: validation_frequency: 1
2016-11-25 01:23:39,272 train: stopping_criterion: no-improvement
2016-11-25 01:23:39,272 train: max_annealing_count: 0
2016-11-25 01:23:39,272 train: max_epochs: 15
2016-11-25 01:23:39,272 train: OPTIMIZATION OPTIONS
2016-11-25 01:23:39,272 train: gradient_decay_rate: 0.9
2016-11-25 01:23:39,272 train: max_gradient_norm: 5.0
2016-11-25 01:23:39,272 train: sqr_gradient_decay_rate: 0.999
2016-11-25 01:23:39,272 train: epsilon: 1e-06
2016-11-25 01:23:39,272 train: learning_rate: 10.0
2016-11-25 01:23:39,273 train: ignore_unk: False
2016-11-25 01:23:39,273 train: momentum: 0.9
2016-11-25 01:23:39,273 train: cost_function: blackout
2016-11-25 01:23:39,273 train: num_noise_samples: 25
2016-11-25 01:23:39,273 train: method: sgd
2016-11-25 01:23:39,273 train: unk_penalty: None
2016-11-25 01:23:39,273 train: weights: [ 1.]
Creating trainer.
Computing unigram probabilities and the number of mini-batches in training data.
2016-11-25 01:23:40,449 __init__: One epoch of training data contains 1778 mini-batch updates.
2016-11-25 01:23:40,449 __init__: Class unigram probabilities are in the range [0.00000103, 0.05232915].
2016-11-25 01:23:40,449 __init__: Finding sentence start positions in /teamwork/t40511_asr/c/penn-treebank-project/ptb.train.txt.
2016-11-25 01:23:40,511 _reset: Generating a random order of input lines.
Building neural network.
2016-11-25 01:23:40,518 __init__: Creating layers.
2016-11-25 01:23:40,518 __init__: - NetworkInput name=word_input inputs=[] size=10001
2016-11-25 01:23:40,518 __init__: - ProjectionLayer name=projection_layer inputs=[word_input] size=100
2016-11-25 01:23:40,557 __init__: - LSTMLayer name=hidden_layer inputs=[projection_layer] size=256
2016-11-25 01:23:40,675 __init__: - SoftmaxLayer name=output_layer inputs=[hidden_layer] size=10001
2016-11-25 01:23:40,792 __init__: Initializing parameters.
2016-11-25 01:23:40,792 __init__: - layers/projection_layer/W size=1000100 type=float32
2016-11-25 01:23:40,792 __init__: - layers/hidden_layer/layer_input/W size=102400 type=float32
2016-11-25 01:23:40,792 __init__: - layers/hidden_layer/step_input/W size=262144 type=float32
2016-11-25 01:23:40,792 __init__: - layers/hidden_layer/layer_input/b size=1024 type=float32
2016-11-25 01:23:40,793 __init__: - layers/output_layer/input/W size=2560256 type=float32
2016-11-25 01:23:40,793 __init__: - layers/output_layer/input/b size=10001 type=float32
2016-11-25 01:23:40,793 __init__: Total number of parameters: 3935925
Compiling optimization function.
Building text scorer for cross-validation.
Validation text: /teamwork/t40511_asr/c/penn-treebank-project/ptb.valid.txt
Training neural network.
2016-11-25 01:26:52,482 _log_update: [200] (11.2 %) of epoch 1 -- lr = 1e+01, cost = 3.86, duration = 92.8 ms
2016-11-25 01:29:58,388 _log_update: [400] (22.5 %) of epoch 1 -- lr = 1e+01, cost = 3.82, duration = 93.4 ms
2016-11-25 01:33:06,336 _log_update: [600] (33.7 %) of epoch 1 -- lr = 1e+01, cost = 3.54, duration = 94.1 ms
2016-11-25 01:36:15,790 _log_update: [800] (45.0 %) of epoch 1 -- lr = 1e+01, cost = 3.48, duration = 94.7 ms
2016-11-25 01:39:26,101 _log_update: [1000] (56.2 %) of epoch 1 -- lr = 1e+01, cost = 3.41, duration = 94.9 ms
2016-11-25 01:42:37,683 _log_update: [1200] (67.5 %) of epoch 1 -- lr = 1e+01, cost = 3.22, duration = 95.3 ms
2016-11-25 01:45:52,781 _log_update: [1400] (78.7 %) of epoch 1 -- lr = 1e+01, cost = 3.22, duration = 95.8 ms
2016-11-25 01:49:04,069 _log_update: [1600] (90.0 %) of epoch 1 -- lr = 1e+01, cost = 2.98, duration = 95.7 ms
2016-11-25 01:52:30,853 _validate: [1772] First validation sample, perplexity 271.71.
2016-11-25 01:54:40,293 _validate: [1775] Center of validation, perplexity 270.21.
2016-11-25 01:56:49,030 _validate: [1778] Last validation sample, perplexity 276.50.
2016-11-25 01:56:49,050 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-25 01:56:49,050 _log_validation: [1778] Validation set cost history: [270.2]
2016-11-25 01:56:49,051 _reset: Generating a random order of input lines.
Finished training epoch 1 in 0 hours 33.0 minutes. Best validation perplexity 270.21.
2016-11-25 01:57:10,126 _log_update: [22] (1.2 %) of epoch 2 -- lr = 1e+01, cost = 2.94, duration = 95.0 ms
2016-11-25 02:00:21,335 _log_update: [222] (12.5 %) of epoch 2 -- lr = 1e+01, cost = 3.04, duration = 95.3 ms
2016-11-25 02:03:32,867 _log_update: [422] (23.7 %) of epoch 2 -- lr = 1e+01, cost = 2.91, duration = 95.4 ms
2016-11-25 02:06:43,971 _log_update: [622] (35.0 %) of epoch 2 -- lr = 1e+01, cost = 2.76, duration = 95.3 ms
2016-11-25 02:09:55,329 _log_update: [822] (46.2 %) of epoch 2 -- lr = 1e+01, cost = 2.82, duration = 95.4 ms
2016-11-25 02:13:07,023 _log_update: [1022] (57.5 %) of epoch 2 -- lr = 1e+01, cost = 2.69, duration = 95.5 ms
2016-11-25 02:16:18,934 _log_update: [1222] (68.7 %) of epoch 2 -- lr = 1e+01, cost = 2.91, duration = 95.5 ms
2016-11-25 02:19:30,368 _log_update: [1422] (80.0 %) of epoch 2 -- lr = 1e+01, cost = 2.74, duration = 95.3 ms
2016-11-25 02:22:41,607 _log_update: [1622] (91.2 %) of epoch 2 -- lr = 1e+01, cost = 2.69, duration = 95.2 ms
2016-11-25 02:25:46,944 _validate: [1772] First validation sample, perplexity 197.53.
2016-11-25 02:27:56,251 _validate: [1775] Center of validation, perplexity 196.21.
2016-11-25 02:30:05,925 _validate: [1778] Last validation sample, perplexity 196.01.
2016-11-25 02:30:05,942 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-25 02:30:05,942 _log_validation: [1778] Validation set cost history: 270.2 [197.1]
2016-11-25 02:30:05,944 _reset: Generating a random order of input lines.
Finished training epoch 2 in 0 hours 33.3 minutes. Best validation perplexity 197.05.
2016-11-25 02:30:48,179 _log_update: [44] (2.5 %) of epoch 3 -- lr = 1e+01, cost = 2.80, duration = 95.8 ms
2016-11-25 02:34:00,231 _log_update: [244] (13.7 %) of epoch 3 -- lr = 1e+01, cost = 2.63, duration = 96.3 ms
2016-11-25 02:37:12,520 _log_update: [444] (25.0 %) of epoch 3 -- lr = 1e+01, cost = 2.34, duration = 95.8 ms
2016-11-25 02:40:24,640 _log_update: [644] (36.2 %) of epoch 3 -- lr = 1e+01, cost = 2.38, duration = 95.9 ms
2016-11-25 02:43:36,641 _log_update: [844] (47.5 %) of epoch 3 -- lr = 1e+01, cost = 2.67, duration = 95.5 ms
2016-11-25 02:46:51,831 _log_update: [1044] (58.7 %) of epoch 3 -- lr = 1e+01, cost = 2.60, duration = 95.5 ms
2016-11-25 02:50:03,806 _log_update: [1244] (70.0 %) of epoch 3 -- lr = 1e+01, cost = 2.57, duration = 95.9 ms
2016-11-25 02:53:16,145 _log_update: [1444] (81.2 %) of epoch 3 -- lr = 1e+01, cost = 2.40, duration = 96.0 ms
2016-11-25 02:56:28,463 _log_update: [1644] (92.5 %) of epoch 3 -- lr = 1e+01, cost = 2.59, duration = 95.9 ms
2016-11-25 02:59:13,669 _validate: [1772] First validation sample, perplexity 169.56.
2016-11-25 03:01:23,059 _validate: [1775] Center of validation, perplexity 169.50.
2016-11-25 03:03:32,856 _validate: [1778] Last validation sample, perplexity 170.03.
2016-11-25 03:03:32,873 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-25 03:03:32,873 _log_validation: [1778] Validation set cost history: 270.2 197.1 [169.8]
2016-11-25 03:03:32,873 _reset: Generating a random order of input lines.
Finished training epoch 3 in 0 hours 33.4 minutes. Best validation perplexity 169.81.
2016-11-25 03:04:36,195 _log_update: [66] (3.7 %) of epoch 4 -- lr = 1e+01, cost = 2.43, duration = 95.7 ms
2016-11-25 03:07:48,817 _log_update: [266] (15.0 %) of epoch 4 -- lr = 1e+01, cost = 2.57, duration = 96.2 ms
2016-11-25 03:11:01,508 _log_update: [466] (26.2 %) of epoch 4 -- lr = 1e+01, cost = 2.56, duration = 95.7 ms
2016-11-25 03:14:14,037 _log_update: [666] (37.5 %) of epoch 4 -- lr = 1e+01, cost = 2.32, duration = 95.9 ms
2016-11-25 03:17:26,686 _log_update: [866] (48.7 %) of epoch 4 -- lr = 1e+01, cost = 2.20, duration = 96.2 ms
2016-11-25 03:20:39,792 _log_update: [1066] (60.0 %) of epoch 4 -- lr = 1e+01, cost = 2.44, duration = 95.8 ms
2016-11-25 03:23:52,411 _log_update: [1266] (71.2 %) of epoch 4 -- lr = 1e+01, cost = 2.60, duration = 96.0 ms
2016-11-25 03:27:04,829 _log_update: [1466] (82.5 %) of epoch 4 -- lr = 1e+01, cost = 2.41, duration = 95.8 ms
2016-11-25 03:30:17,080 _log_update: [1666] (93.7 %) of epoch 4 -- lr = 1e+01, cost = 2.67, duration = 95.8 ms
2016-11-25 03:32:41,397 _validate: [1772] First validation sample, perplexity 156.83.
2016-11-25 03:34:51,029 _validate: [1775] Center of validation, perplexity 155.25.
2016-11-25 03:37:00,876 _validate: [1778] Last validation sample, perplexity 156.34.
2016-11-25 03:37:00,893 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-25 03:37:00,893 _log_validation: [1778] Validation set cost history: 270.2 197.1 169.8 [156.7]
2016-11-25 03:37:00,893 _reset: Generating a random order of input lines.
Finished training epoch 4 in 0 hours 33.5 minutes. Best validation perplexity 156.72.
2016-11-25 03:38:25,358 _log_update: [88] (4.9 %) of epoch 5 -- lr = 1e+01, cost = 2.28, duration = 95.6 ms
2016-11-25 03:41:38,281 _log_update: [288] (16.2 %) of epoch 5 -- lr = 1e+01, cost = 2.32, duration = 95.9 ms
2016-11-25 03:44:50,922 _log_update: [488] (27.4 %) of epoch 5 -- lr = 1e+01, cost = 2.19, duration = 96.7 ms
2016-11-25 03:48:06,849 _log_update: [688] (38.7 %) of epoch 5 -- lr = 1e+01, cost = 2.50, duration = 95.7 ms
2016-11-25 03:51:19,206 _log_update: [888] (49.9 %) of epoch 5 -- lr = 1e+01, cost = 2.43, duration = 97.0 ms
2016-11-25 03:54:31,605 _log_update: [1088] (61.2 %) of epoch 5 -- lr = 1e+01, cost = 2.19, duration = 95.5 ms
2016-11-25 03:57:43,625 _log_update: [1288] (72.4 %) of epoch 5 -- lr = 1e+01, cost = 2.33, duration = 96.0 ms
2016-11-25 04:00:56,020 _log_update: [1488] (83.7 %) of epoch 5 -- lr = 1e+01, cost = 2.34, duration = 95.6 ms
2016-11-25 04:04:08,273 _log_update: [1688] (94.9 %) of epoch 5 -- lr = 1e+01, cost = 2.27, duration = 95.9 ms
2016-11-25 04:06:11,339 _validate: [1772] First validation sample, perplexity 149.52.
2016-11-25 04:08:20,864 _validate: [1775] Center of validation, perplexity 150.69.
2016-11-25 04:10:30,630 _validate: [1778] Last validation sample, perplexity 150.42.
2016-11-25 04:10:30,645 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-25 04:10:30,645 _log_validation: [1778] Validation set cost history: 270.2 197.1 169.8 156.7 [150.2]
2016-11-25 04:10:30,647 _reset: Generating a random order of input lines.
Finished training epoch 5 in 0 hours 33.5 minutes. Best validation perplexity 150.18.
2016-11-25 04:12:16,408 _log_update: [110] (6.2 %) of epoch 6 -- lr = 1e+01, cost = 2.18, duration = 95.7 ms
2016-11-25 04:15:28,279 _log_update: [310] (17.4 %) of epoch 6 -- lr = 1e+01, cost = 2.34, duration = 95.4 ms
2016-11-25 04:18:40,610 _log_update: [510] (28.7 %) of epoch 6 -- lr = 1e+01, cost = 2.38, duration = 95.7 ms
2016-11-25 04:21:54,152 _log_update: [710] (39.9 %) of epoch 6 -- lr = 1e+01, cost = 2.19, duration = 95.8 ms
2016-11-25 04:25:06,858 _log_update: [910] (51.2 %) of epoch 6 -- lr = 1e+01, cost = 2.07, duration = 96.5 ms
2016-11-25 04:28:19,705 _log_update: [1110] (62.4 %) of epoch 6 -- lr = 1e+01, cost = 2.00, duration = 96.5 ms
2016-11-25 04:31:32,546 _log_update: [1310] (73.7 %) of epoch 6 -- lr = 1e+01, cost = 2.04, duration = 95.9 ms
2016-11-25 04:34:44,946 _log_update: [1510] (84.9 %) of epoch 6 -- lr = 1e+01, cost = 2.17, duration = 96.4 ms
2016-11-25 04:37:57,735 _log_update: [1710] (96.2 %) of epoch 6 -- lr = 1e+01, cost = 2.15, duration = 96.2 ms
2016-11-25 04:39:39,584 _validate: [1772] First validation sample, perplexity 147.19.
2016-11-25 04:41:49,305 _validate: [1775] Center of validation, perplexity 146.27.
2016-11-25 04:43:58,832 _validate: [1778] Last validation sample, perplexity 147.56.
2016-11-25 04:43:58,848 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-25 04:43:58,848 _log_validation: [1778] Validation set cost history: 270.2 197.1 169.8 156.7 150.2 [146.8]
2016-11-25 04:43:58,849 _reset: Generating a random order of input lines.
Finished training epoch 6 in 0 hours 33.5 minutes. Best validation perplexity 146.84.
2016-11-25 04:46:09,663 _log_update: [132] (7.4 %) of epoch 7 -- lr = 1e+01, cost = 2.03, duration = 96.0 ms
2016-11-25 04:49:22,543 _log_update: [332] (18.7 %) of epoch 7 -- lr = 1e+01, cost = 2.05, duration = 97.7 ms
2016-11-25 04:52:35,559 _log_update: [532] (29.9 %) of epoch 7 -- lr = 1e+01, cost = 2.00, duration = 96.3 ms
2016-11-25 04:55:48,124 _log_update: [732] (41.2 %) of epoch 7 -- lr = 1e+01, cost = 2.10, duration = 96.3 ms
2016-11-25 04:59:00,706 _log_update: [932] (52.4 %) of epoch 7 -- lr = 1e+01, cost = 2.18, duration = 95.6 ms
2016-11-25 05:02:12,878 _log_update: [1132] (63.7 %) of epoch 7 -- lr = 1e+01, cost = 2.10, duration = 96.2 ms
2016-11-25 05:05:24,781 _log_update: [1332] (74.9 %) of epoch 7 -- lr = 1e+01, cost = 1.92, duration = 95.9 ms
2016-11-25 05:08:36,848 _log_update: [1532] (86.2 %) of epoch 7 -- lr = 1e+01, cost = 2.09, duration = 95.7 ms
2016-11-25 05:11:48,871 _log_update: [1732] (97.4 %) of epoch 7 -- lr = 1e+01, cost = 2.21, duration = 96.2 ms
2016-11-25 05:13:09,540 _validate: [1772] First validation sample, perplexity 145.09.
2016-11-25 05:15:19,109 _validate: [1775] Center of validation, perplexity 145.39.
2016-11-25 05:17:28,849 _validate: [1778] Last validation sample, perplexity 148.01.
2016-11-25 05:17:28,864 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-25 05:17:28,864 _log_validation: [1778] Validation set cost history: 270.2 197.1 169.8 156.7 150.2 146.8 [145.4]
2016-11-25 05:17:28,865 _reset: Generating a random order of input lines.
Finished training epoch 7 in 0 hours 33.5 minutes. Best validation perplexity 145.39.
2016-11-25 05:19:57,257 _log_update: [154] (8.7 %) of epoch 8 -- lr = 1e+01, cost = 1.96, duration = 95.5 ms
2016-11-25 05:23:09,619 _log_update: [354] (19.9 %) of epoch 8 -- lr = 1e+01, cost = 2.15, duration = 96.2 ms
2016-11-25 05:26:21,888 _log_update: [554] (31.2 %) of epoch 8 -- lr = 1e+01, cost = 2.20, duration = 96.4 ms
2016-11-25 05:29:33,750 _log_update: [754] (42.4 %) of epoch 8 -- lr = 1e+01, cost = 2.08, duration = 95.8 ms
2016-11-25 05:32:45,911 _log_update: [954] (53.7 %) of epoch 8 -- lr = 1e+01, cost = 2.19, duration = 96.1 ms
2016-11-25 05:35:58,438 _log_update: [1154] (64.9 %) of epoch 8 -- lr = 1e+01, cost = 2.02, duration = 95.8 ms
2016-11-25 05:39:11,123 _log_update: [1354] (76.2 %) of epoch 8 -- lr = 1e+01, cost = 2.00, duration = 95.9 ms
2016-11-25 05:42:23,526 _log_update: [1554] (87.4 %) of epoch 8 -- lr = 1e+01, cost = 2.14, duration = 96.0 ms
2016-11-25 05:45:39,619 _log_update: [1754] (98.7 %) of epoch 8 -- lr = 1e+01, cost = 2.19, duration = 96.0 ms
2016-11-25 05:46:39,254 _validate: [1772] First validation sample, perplexity 146.65.
2016-11-25 05:48:49,033 _validate: [1775] Center of validation, perplexity 146.35.
2016-11-25 05:50:58,974 _validate: [1778] Last validation sample, perplexity 149.69.
2016-11-25 05:50:58,974 _log_validation: [1778] Validation set cost history: 270.2 197.1 169.8 156.7 150.2 146.8 [145.4] 146.7
2016-11-25 05:50:58,974 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-25 05:50:58,975 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-25 05:50:58,978 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-25 05:50:58,979 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-25 05:50:58,980 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-25 05:50:58,980 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-25 05:50:58,981 _reset_state: [1775] (99.83 %) of epoch 7
2016-11-25 05:50:58,982 _log_validation: [1775] Validation set cost history: 270.2 197.1 169.8 156.7 150.2 146.8 [145.4]
2016-11-25 05:50:58,982 set_state: Restored iterator to line 41999 of 42068.
2016-11-25 05:50:58,983 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-25 05:50:58,983 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-25 05:50:58,983 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-25 05:50:58,985 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-25 05:50:58,988 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-25 05:50:58,988 set_state: layers/output_layer/input/b_gradient <- array(10001,)
Model performance stopped improving. Decreasing learning rate from 10.0 to 5.0 and resetting state to 100 % of epoch 7.
2016-11-25 05:50:58,990 _reset: Generating a random order of input lines.
Finished training epoch 7 in 0 hours 33.5 minutes. Best validation perplexity 145.39.
2016-11-25 05:53:48,177 _log_update: [176] (9.9 %) of epoch 8 -- lr = 5, cost = 1.91, duration = 96.5 ms
2016-11-25 05:57:00,838 _log_update: [376] (21.1 %) of epoch 8 -- lr = 5, cost = 1.80, duration = 96.9 ms
2016-11-25 06:00:12,832 _log_update: [576] (32.4 %) of epoch 8 -- lr = 5, cost = 1.77, duration = 95.7 ms
2016-11-25 06:03:25,080 _log_update: [776] (43.6 %) of epoch 8 -- lr = 5, cost = 1.87, duration = 95.4 ms
2016-11-25 06:06:36,875 _log_update: [976] (54.9 %) of epoch 8 -- lr = 5, cost = 1.99, duration = 95.6 ms
2016-11-25 06:09:48,717 _log_update: [1176] (66.1 %) of epoch 8 -- lr = 5, cost = 1.87, duration = 95.4 ms
2016-11-25 06:13:00,930 _log_update: [1376] (77.4 %) of epoch 8 -- lr = 5, cost = 1.99, duration = 95.6 ms
2016-11-25 06:16:13,460 _log_update: [1576] (88.6 %) of epoch 8 -- lr = 5, cost = 1.89, duration = 96.3 ms
2016-11-25 06:20:04,802 _validate: [1772] First validation sample, perplexity 137.58.
2016-11-25 06:22:14,528 _validate: [1775] Center of validation, perplexity 137.42.
2016-11-25 06:22:15,497 _log_update: [1776] (99.9 %) of epoch 8 -- lr = 5, cost = 2.02, duration = 95.2 ms
2016-11-25 06:24:24,175 _validate: [1778] Last validation sample, perplexity 137.53.
2016-11-25 06:24:24,190 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-25 06:24:24,190 _log_validation: [1778] Validation set cost history: 270.2 197.1 169.8 156.7 150.2 146.8 145.4 [137.5]
2016-11-25 06:24:24,191 _reset: Generating a random order of input lines.
Finished training epoch 8 in 0 hours 33.4 minutes. Best validation perplexity 137.53.
2016-11-25 06:27:35,881 _log_update: [198] (11.1 %) of epoch 9 -- lr = 5, cost = 1.96, duration = 96.0 ms
2016-11-25 06:30:48,552 _log_update: [398] (22.4 %) of epoch 9 -- lr = 5, cost = 2.05, duration = 96.0 ms
2016-11-25 06:34:01,684 _log_update: [598] (33.6 %) of epoch 9 -- lr = 5, cost = 1.80, duration = 96.2 ms
2016-11-25 06:37:14,727 _log_update: [798] (44.9 %) of epoch 9 -- lr = 5, cost = 2.02, duration = 96.1 ms
2016-11-25 06:40:28,103 _log_update: [998] (56.1 %) of epoch 9 -- lr = 5, cost = 1.93, duration = 96.0 ms
2016-11-25 06:43:42,987 _log_update: [1198] (67.4 %) of epoch 9 -- lr = 5, cost = 2.06, duration = 95.9 ms
2016-11-25 06:46:59,190 _log_update: [1398] (78.6 %) of epoch 9 -- lr = 5, cost = 1.96, duration = 96.3 ms
2016-11-25 06:50:12,435 _log_update: [1598] (89.9 %) of epoch 9 -- lr = 5, cost = 1.96, duration = 96.2 ms
2016-11-25 06:53:42,659 _validate: [1772] First validation sample, perplexity 139.99.
2016-11-25 06:55:52,191 _validate: [1775] Center of validation, perplexity 140.21.
2016-11-25 06:58:02,067 _validate: [1778] Last validation sample, perplexity 139.70.
2016-11-25 06:58:02,068 _log_validation: [1778] Validation set cost history: 270.2 197.1 169.8 156.7 150.2 146.8 145.4 [137.5] 140.0
2016-11-25 06:58:02,068 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-25 06:58:02,069 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-25 06:58:02,072 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-25 06:58:02,072 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-25 06:58:02,074 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-25 06:58:02,074 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-25 06:58:02,075 _reset_state: [1775] (99.83 %) of epoch 8
2016-11-25 06:58:02,076 _log_validation: [1775] Validation set cost history: 270.2 197.1 169.8 156.7 150.2 146.8 145.4 [137.5]
2016-11-25 06:58:02,076 set_state: Restored iterator to line 42001 of 42068.
2016-11-25 06:58:02,077 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-25 06:58:02,077 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-25 06:58:02,077 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-25 06:58:02,079 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-25 06:58:02,082 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-25 06:58:02,082 set_state: layers/output_layer/input/b_gradient <- array(10001,)
Model performance stopped improving. Decreasing learning rate from 5.0 to 2.5 and resetting state to 100 % of epoch 8.
2016-11-25 06:58:02,083 _reset: Generating a random order of input lines.
Finished training epoch 8 in 0 hours 33.6 minutes. Best validation perplexity 137.53.
2016-11-25 06:58:21,379 _log_update: [20] (1.1 %) of epoch 9 -- lr = 2, cost = 1.79, duration = 97.6 ms
2016-11-25 07:01:34,255 _log_update: [220] (12.4 %) of epoch 9 -- lr = 2, cost = 1.82, duration = 96.2 ms
2016-11-25 07:04:47,268 _log_update: [420] (23.6 %) of epoch 9 -- lr = 2, cost = 1.91, duration = 96.0 ms
2016-11-25 07:07:59,881 _log_update: [620] (34.9 %) of epoch 9 -- lr = 2, cost = 1.89, duration = 96.0 ms
2016-11-25 07:11:12,143 _log_update: [820] (46.1 %) of epoch 9 -- lr = 2, cost = 1.80, duration = 96.0 ms
2016-11-25 07:14:24,204 _log_update: [1020] (57.4 %) of epoch 9 -- lr = 2, cost = 1.82, duration = 95.9 ms
2016-11-25 07:17:36,365 _log_update: [1220] (68.6 %) of epoch 9 -- lr = 2, cost = 2.11, duration = 96.0 ms
2016-11-25 07:20:49,014 _log_update: [1420] (79.9 %) of epoch 9 -- lr = 2, cost = 1.90, duration = 95.7 ms
2016-11-25 07:24:01,064 _log_update: [1620] (91.1 %) of epoch 9 -- lr = 2, cost = 2.00, duration = 95.6 ms
2016-11-25 07:27:09,100 _validate: [1772] First validation sample, perplexity 136.05.
2016-11-25 07:29:18,334 _validate: [1775] Center of validation, perplexity 135.76.
2016-11-25 07:31:28,115 _validate: [1778] Last validation sample, perplexity 135.98.
2016-11-25 07:31:28,131 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-25 07:31:28,131 _log_validation: [1778] Validation set cost history: 270.2 197.1 169.8 156.7 150.2 146.8 145.4 137.5 [135.9]
2016-11-25 07:31:28,131 _reset: Generating a random order of input lines.
Finished training epoch 9 in 0 hours 33.4 minutes. Best validation perplexity 135.86.
2016-11-25 07:32:08,420 _log_update: [42] (2.4 %) of epoch 10 -- lr = 2, cost = 1.88, duration = 95.8 ms
2016-11-25 07:35:21,055 _log_update: [242] (13.6 %) of epoch 10 -- lr = 2, cost = 1.76, duration = 95.8 ms
2016-11-25 07:38:33,690 _log_update: [442] (24.9 %) of epoch 10 -- lr = 2, cost = 1.69, duration = 95.6 ms
2016-11-25 07:41:45,724 _log_update: [642] (36.1 %) of epoch 10 -- lr = 2, cost = 1.79, duration = 95.9 ms
2016-11-25 07:44:58,363 _log_update: [842] (47.4 %) of epoch 10 -- lr = 2, cost = 1.78, duration = 104.1 ms
2016-11-25 07:48:13,855 _log_update: [1042] (58.6 %) of epoch 10 -- lr = 2, cost = 1.65, duration = 95.7 ms
2016-11-25 07:51:26,731 _log_update: [1242] (69.9 %) of epoch 10 -- lr = 2, cost = 1.72, duration = 96.1 ms
2016-11-25 07:54:39,479 _log_update: [1442] (81.1 %) of epoch 10 -- lr = 2, cost = 2.01, duration = 95.8 ms
2016-11-25 07:57:52,292 _log_update: [1642] (92.4 %) of epoch 10 -- lr = 2, cost = 1.70, duration = 96.3 ms
2016-11-25 08:00:39,593 _validate: [1772] First validation sample, perplexity 138.40.
2016-11-25 08:02:49,199 _validate: [1775] Center of validation, perplexity 138.12.
2016-11-25 08:04:59,067 _validate: [1778] Last validation sample, perplexity 138.02.
2016-11-25 08:04:59,067 _log_validation: [1778] Validation set cost history: 270.2 197.1 169.8 156.7 150.2 146.8 145.4 137.5 [135.9] 138.3
2016-11-25 08:04:59,068 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-25 08:04:59,068 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-25 08:04:59,071 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-25 08:04:59,072 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-25 08:04:59,073 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-25 08:04:59,074 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-25 08:04:59,075 _reset_state: [1775] (99.83 %) of epoch 9
2016-11-25 08:04:59,075 _log_validation: [1775] Validation set cost history: 270.2 197.1 169.8 156.7 150.2 146.8 145.4 137.5 [135.9]
2016-11-25 08:04:59,076 set_state: Restored iterator to line 42001 of 42068.
2016-11-25 08:04:59,076 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-25 08:04:59,077 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-25 08:04:59,077 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-25 08:04:59,078 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-25 08:04:59,081 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-25 08:04:59,082 set_state: layers/output_layer/input/b_gradient <- array(10001,)
Model performance stopped improving. Decreasing learning rate from 2.5 to 1.25 and resetting state to 100 % of epoch 9.
2016-11-25 08:04:59,083 _reset: Generating a random order of input lines.
Finished training epoch 9 in 0 hours 33.5 minutes. Best validation perplexity 135.86.
2016-11-25 08:06:01,037 _log_update: [64] (3.6 %) of epoch 10 -- lr = 1, cost = 1.57, duration = 110.4 ms
2016-11-25 08:09:13,636 _log_update: [264] (14.8 %) of epoch 10 -- lr = 1, cost = 1.63, duration = 96.0 ms
2016-11-25 08:12:25,481 _log_update: [464] (26.1 %) of epoch 10 -- lr = 1, cost = 1.71, duration = 95.7 ms
2016-11-25 08:15:37,145 _log_update: [664] (37.3 %) of epoch 10 -- lr = 1, cost = 1.63, duration = 95.5 ms
2016-11-25 08:18:49,416 _log_update: [864] (48.6 %) of epoch 10 -- lr = 1, cost = 1.72, duration = 95.4 ms
2016-11-25 08:22:01,404 _log_update: [1064] (59.8 %) of epoch 10 -- lr = 1, cost = 1.84, duration = 95.9 ms
2016-11-25 08:25:13,243 _log_update: [1264] (71.1 %) of epoch 10 -- lr = 1, cost = 1.77, duration = 95.7 ms
2016-11-25 08:28:25,047 _log_update: [1464] (82.3 %) of epoch 10 -- lr = 1, cost = 2.01, duration = 95.8 ms
2016-11-25 08:31:37,195 _log_update: [1664] (93.6 %) of epoch 10 -- lr = 1, cost = 1.57, duration = 95.5 ms
2016-11-25 08:34:02,894 _validate: [1772] First validation sample, perplexity 135.95.
2016-11-25 08:36:12,622 _validate: [1775] Center of validation, perplexity 135.95.
2016-11-25 08:38:22,197 _validate: [1778] Last validation sample, perplexity 136.06.
2016-11-25 08:38:22,198 _log_validation: [1778] Validation set cost history: 270.2 197.1 169.8 156.7 150.2 146.8 145.4 137.5 [135.9] 135.9
2016-11-25 08:38:22,198 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-25 08:38:22,199 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-25 08:38:22,202 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-25 08:38:22,202 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-25 08:38:22,204 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-25 08:38:22,204 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-25 08:38:22,205 _reset_state: [1775] (99.83 %) of epoch 9
2016-11-25 08:38:22,206 _log_validation: [1775] Validation set cost history: 270.2 197.1 169.8 156.7 150.2 146.8 145.4 137.5 [135.9]
2016-11-25 08:38:22,206 set_state: Restored iterator to line 42001 of 42068.
2016-11-25 08:38:22,206 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-25 08:38:22,207 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-25 08:38:22,207 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-25 08:38:22,208 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-25 08:38:22,212 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-25 08:38:22,212 set_state: layers/output_layer/input/b_gradient <- array(10001,)
Model performance stopped improving. Decreasing learning rate from 1.25 to 0.625 and resetting state to 100 % of epoch 9.
Finished training epoch 9 in 0 hours 33.4 minutes. Best validation perplexity 135.86.
Training finished in 7 hours 14.6 minutes.
2016-11-25 08:38:22,213 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-25 08:38:22,214 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-25 08:38:22,218 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-25 08:38:22,219 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-25 08:38:22,220 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-25 08:38:22,221 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
Best validation set perplexity: 135.756340105
train finished.
Computing evaluation set perplexity.
Reading vocabulary from network state.
Number of words in vocabulary: 10001
Number of word classes: 10001
Building neural network.
Restoring neural network state.
Building text scorer.
Number of sentences: 3761
Number of words: 86191
Number of predicted probabilities: 82430
Cross entropy (base e): 4.862959239301677
Perplexity: 129.40658109353978
