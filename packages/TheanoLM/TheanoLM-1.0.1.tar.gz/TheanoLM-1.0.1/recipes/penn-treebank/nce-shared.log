/l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab
Reading vocabulary from /l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab.
Number of words in vocabulary: 10001
Number of word classes: 10001
2016-11-22 02:42:49,330 train: TRAINING OPTIONS
2016-11-22 02:42:49,330 train: strategy: local-mean
2016-11-22 02:42:49,330 train: sequence_length: 25
2016-11-22 02:42:49,330 train: validation_frequency: 1
2016-11-22 02:42:49,330 train: max_epochs: 15
2016-11-22 02:42:49,330 train: min_epochs: 1
2016-11-22 02:42:49,330 train: stopping_criterion: no-improvement
2016-11-22 02:42:49,331 train: batch_size: 24
2016-11-22 02:42:49,331 train: max_annealing_count: 0
2016-11-22 02:42:49,331 train: patience: 0
2016-11-22 02:42:49,331 train: OPTIMIZATION OPTIONS
2016-11-22 02:42:49,331 train: ignore_unk: False
2016-11-22 02:42:49,331 train: learning_rate: 5.0
2016-11-22 02:42:49,331 train: weights: [ 1.]
2016-11-22 02:42:49,331 train: cost_function: nce-shared
2016-11-22 02:42:49,331 train: method: sgd
2016-11-22 02:42:49,331 train: num_noise_samples: 100
2016-11-22 02:42:49,331 train: sqr_gradient_decay_rate: 0.999
2016-11-22 02:42:49,331 train: momentum: 0.9
2016-11-22 02:42:49,331 train: gradient_decay_rate: 0.9
2016-11-22 02:42:49,331 train: epsilon: 1e-06
2016-11-22 02:42:49,331 train: max_gradient_norm: 5.0
2016-11-22 02:42:49,332 train: unk_penalty: None
Creating trainer.
Computing unigram probabilities and the number of mini-batches in training data.
2016-11-22 02:42:50,508 __init__: One epoch of training data contains 2371 mini-batch updates.
2016-11-22 02:42:50,509 __init__: Class unigram probabilities are in the range [0.000001, 0.052329].
2016-11-22 02:42:50,511 __init__: Finding sentence start positions in /teamwork/t40511_asr/c/penn-treebank-project/ptb.train.txt.
2016-11-22 02:42:50,534 _reset: Generating a random order of input lines.
Building neural network.
2016-11-22 02:42:50,541 __init__: Creating layers.
2016-11-22 02:42:50,541 __init__: - NetworkInput name=word_input inputs=[] size=10001
2016-11-22 02:42:50,541 __init__: - ProjectionLayer name=projection_layer inputs=[word_input] size=100
2016-11-22 02:42:50,580 __init__: - LSTMLayer name=hidden_layer inputs=[projection_layer] size=256
2016-11-22 02:42:50,749 __init__: - SoftmaxLayer name=output_layer inputs=[hidden_layer] size=10001
2016-11-22 02:42:50,869 __init__: Initializing parameters.
2016-11-22 02:42:50,869 __init__: - layers/projection_layer/W size=1000100 type=float32
2016-11-22 02:42:50,869 __init__: - layers/hidden_layer/layer_input/W size=102400 type=float32
2016-11-22 02:42:50,869 __init__: - layers/hidden_layer/step_input/W size=262144 type=float32
2016-11-22 02:42:50,869 __init__: - layers/hidden_layer/layer_input/b size=1024 type=float32
2016-11-22 02:42:50,869 __init__: - layers/output_layer/input/W size=2560256 type=float32
2016-11-22 02:42:50,870 __init__: - layers/output_layer/input/b size=10001 type=float32
2016-11-22 02:42:50,870 __init__: Total number of parameters: 3935925
Compiling optimization function.
Building text scorer.
Training neural network.
2016-11-22 02:43:14,225 _log_update: [200] (8.4 %) of epoch 1 -- lr = 5, cost = 10.92, duration = 6.4 ms
2016-11-22 02:43:26,989 _log_update: [400] (16.9 %) of epoch 1 -- lr = 5, cost = 8.33, duration = 6.3 ms
2016-11-22 02:43:39,752 _log_update: [600] (25.3 %) of epoch 1 -- lr = 5, cost = 4.50, duration = 6.3 ms
2016-11-22 02:43:52,511 _log_update: [800] (33.7 %) of epoch 1 -- lr = 5, cost = 3.95, duration = 6.3 ms
2016-11-22 02:44:05,278 _log_update: [1000] (42.2 %) of epoch 1 -- lr = 5, cost = 4.34, duration = 6.3 ms
2016-11-22 02:44:18,033 _log_update: [1200] (50.6 %) of epoch 1 -- lr = 5, cost = 3.86, duration = 6.3 ms
2016-11-22 02:44:30,784 _log_update: [1400] (59.0 %) of epoch 1 -- lr = 5, cost = 4.57, duration = 6.3 ms
2016-11-22 02:44:43,525 _log_update: [1600] (67.5 %) of epoch 1 -- lr = 5, cost = 7.28, duration = 6.3 ms
2016-11-22 02:44:56,311 _log_update: [1800] (75.9 %) of epoch 1 -- lr = 5, cost = 4.62, duration = 6.5 ms
2016-11-22 02:45:09,195 _log_update: [2000] (84.4 %) of epoch 1 -- lr = 5, cost = 3.32, duration = 6.4 ms
2016-11-22 02:45:22,188 _log_update: [2200] (92.8 %) of epoch 1 -- lr = 5, cost = 3.33, duration = 6.3 ms
2016-11-22 02:45:39,606 _validate: [2362] First validation sample, perplexity 1221.38.
2016-11-22 02:46:07,685 _validate: [2366] Center of validation, perplexity 1243.01.
2016-11-22 02:46:42,764 _validate: [2371] Last validation sample, perplexity 1553.40.
2016-11-22 02:46:42,791 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 02:46:42,791 _log_validation: [2371] Validation set cost history: [1382.1]
2016-11-22 02:46:42,792 _reset: Generating a random order of input lines.
Finished training epoch 1 in 0 hours 3.7 minutes. Best validation perplexity 1382.10.
2016-11-22 02:46:44,646 _log_update: [29] (1.2 %) of epoch 2 -- lr = 5, cost = 3.24, duration = 6.4 ms
2016-11-22 02:46:57,382 _log_update: [229] (9.7 %) of epoch 2 -- lr = 5, cost = 3.12, duration = 6.3 ms
2016-11-22 02:47:10,130 _log_update: [429] (18.1 %) of epoch 2 -- lr = 5, cost = 3.94, duration = 6.3 ms
2016-11-22 02:47:22,866 _log_update: [629] (26.5 %) of epoch 2 -- lr = 5, cost = 2.94, duration = 6.3 ms
2016-11-22 02:47:35,602 _log_update: [829] (35.0 %) of epoch 2 -- lr = 5, cost = 3.13, duration = 6.3 ms
2016-11-22 02:47:48,337 _log_update: [1029] (43.4 %) of epoch 2 -- lr = 5, cost = 3.00, duration = 6.3 ms
2016-11-22 02:48:01,078 _log_update: [1229] (51.8 %) of epoch 2 -- lr = 5, cost = 3.05, duration = 6.3 ms
2016-11-22 02:48:13,816 _log_update: [1429] (60.3 %) of epoch 2 -- lr = 5, cost = 2.76, duration = 6.3 ms
2016-11-22 02:48:26,552 _log_update: [1629] (68.7 %) of epoch 2 -- lr = 5, cost = 3.35, duration = 6.3 ms
2016-11-22 02:48:39,293 _log_update: [1829] (77.1 %) of epoch 2 -- lr = 5, cost = 3.09, duration = 6.3 ms
2016-11-22 02:48:52,032 _log_update: [2029] (85.6 %) of epoch 2 -- lr = 5, cost = 2.67, duration = 6.3 ms
2016-11-22 02:49:04,767 _log_update: [2229] (94.0 %) of epoch 2 -- lr = 5, cost = 3.19, duration = 6.3 ms
2016-11-22 02:49:20,160 _validate: [2362] First validation sample, perplexity 1301.47.
2016-11-22 02:49:48,152 _validate: [2366] Center of validation, perplexity 1183.39.
2016-11-22 02:50:23,161 _validate: [2371] Last validation sample, perplexity 1133.00.
2016-11-22 02:50:23,181 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 02:50:23,181 _log_validation: [2371] Validation set cost history: 1382.1 [1194.5]
2016-11-22 02:50:23,182 _reset: Generating a random order of input lines.
Finished training epoch 2 in 0 hours 3.7 minutes. Best validation perplexity 1194.52.
2016-11-22 02:50:26,887 _log_update: [58] (2.4 %) of epoch 3 -- lr = 5, cost = 3.03, duration = 6.3 ms
2016-11-22 02:50:39,622 _log_update: [258] (10.9 %) of epoch 3 -- lr = 5, cost = 3.02, duration = 6.3 ms
2016-11-22 02:50:52,362 _log_update: [458] (19.3 %) of epoch 3 -- lr = 5, cost = 3.11, duration = 6.3 ms
2016-11-22 02:51:05,138 _log_update: [658] (27.8 %) of epoch 3 -- lr = 5, cost = 6.89, duration = 6.3 ms
2016-11-22 02:51:17,874 _log_update: [858] (36.2 %) of epoch 3 -- lr = 5, cost = 2.36, duration = 6.3 ms
2016-11-22 02:51:30,615 _log_update: [1058] (44.6 %) of epoch 3 -- lr = 5, cost = 2.61, duration = 6.4 ms
2016-11-22 02:51:43,344 _log_update: [1258] (53.1 %) of epoch 3 -- lr = 5, cost = 3.48, duration = 6.3 ms
2016-11-22 02:51:56,071 _log_update: [1458] (61.5 %) of epoch 3 -- lr = 5, cost = 2.18, duration = 6.3 ms
2016-11-22 02:52:08,809 _log_update: [1658] (69.9 %) of epoch 3 -- lr = 5, cost = 6.01, duration = 6.3 ms
2016-11-22 02:52:21,545 _log_update: [1858] (78.4 %) of epoch 3 -- lr = 5, cost = 2.54, duration = 6.4 ms
2016-11-22 02:52:34,276 _log_update: [2058] (86.8 %) of epoch 3 -- lr = 5, cost = 2.65, duration = 6.4 ms
2016-11-22 02:52:47,009 _log_update: [2258] (95.2 %) of epoch 3 -- lr = 5, cost = 2.77, duration = 6.4 ms
2016-11-22 02:53:00,568 _validate: [2362] First validation sample, perplexity 1426.13.
2016-11-22 02:53:28,585 _validate: [2366] Center of validation, perplexity 1101.20.
2016-11-22 02:54:03,615 _validate: [2371] Last validation sample, perplexity 1049.37.
2016-11-22 02:54:03,631 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 02:54:03,631 _log_validation: [2371] Validation set cost history: 1382.1 1194.5 [1149.0]
2016-11-22 02:54:03,632 _reset: Generating a random order of input lines.
Finished training epoch 3 in 0 hours 3.7 minutes. Best validation perplexity 1149.03.
2016-11-22 02:54:09,184 _log_update: [87] (3.7 %) of epoch 4 -- lr = 5, cost = 3.04, duration = 6.3 ms
2016-11-22 02:54:21,927 _log_update: [287] (12.1 %) of epoch 4 -- lr = 5, cost = 2.64, duration = 6.3 ms
2016-11-22 02:54:34,661 _log_update: [487] (20.5 %) of epoch 4 -- lr = 5, cost = 2.52, duration = 6.4 ms
2016-11-22 02:54:47,397 _log_update: [687] (29.0 %) of epoch 4 -- lr = 5, cost = 4.48, duration = 6.3 ms
2016-11-22 02:55:00,130 _log_update: [887] (37.4 %) of epoch 4 -- lr = 5, cost = 3.46, duration = 6.9 ms
2016-11-22 02:55:12,869 _log_update: [1087] (45.8 %) of epoch 4 -- lr = 5, cost = 2.56, duration = 6.3 ms
2016-11-22 02:55:25,610 _log_update: [1287] (54.3 %) of epoch 4 -- lr = 5, cost = 3.10, duration = 6.3 ms
2016-11-22 02:55:38,342 _log_update: [1487] (62.7 %) of epoch 4 -- lr = 5, cost = 3.17, duration = 6.3 ms
2016-11-22 02:55:51,076 _log_update: [1687] (71.2 %) of epoch 4 -- lr = 5, cost = 2.63, duration = 6.3 ms
2016-11-22 02:56:03,835 _log_update: [1887] (79.6 %) of epoch 4 -- lr = 5, cost = 2.66, duration = 6.3 ms
2016-11-22 02:56:16,574 _log_update: [2087] (88.0 %) of epoch 4 -- lr = 5, cost = 2.66, duration = 6.3 ms
2016-11-22 02:56:29,316 _log_update: [2287] (96.5 %) of epoch 4 -- lr = 5, cost = 2.58, duration = 6.3 ms
2016-11-22 02:56:41,025 _validate: [2362] First validation sample, perplexity 996.31.
2016-11-22 02:57:09,054 _validate: [2366] Center of validation, perplexity 948.23.
2016-11-22 02:57:44,074 _validate: [2371] Last validation sample, perplexity 924.82.
2016-11-22 02:57:44,091 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 02:57:44,091 _log_validation: [2371] Validation set cost history: 1382.1 1194.5 1149.0 [949.6]
2016-11-22 02:57:44,092 _reset: Generating a random order of input lines.
Finished training epoch 4 in 0 hours 3.7 minutes. Best validation perplexity 949.58.
2016-11-22 02:57:51,485 _log_update: [116] (4.9 %) of epoch 5 -- lr = 5, cost = 2.90, duration = 6.3 ms
2016-11-22 02:58:04,234 _log_update: [316] (13.3 %) of epoch 5 -- lr = 5, cost = 2.28, duration = 6.3 ms
2016-11-22 02:58:16,976 _log_update: [516] (21.8 %) of epoch 5 -- lr = 5, cost = 5.28, duration = 6.3 ms
2016-11-22 02:58:29,711 _log_update: [716] (30.2 %) of epoch 5 -- lr = 5, cost = 2.33, duration = 6.3 ms
2016-11-22 02:58:42,442 _log_update: [916] (38.6 %) of epoch 5 -- lr = 5, cost = 2.37, duration = 6.3 ms
2016-11-22 02:58:55,173 _log_update: [1116] (47.1 %) of epoch 5 -- lr = 5, cost = 2.47, duration = 6.3 ms
2016-11-22 02:59:07,915 _log_update: [1316] (55.5 %) of epoch 5 -- lr = 5, cost = 2.25, duration = 6.3 ms
2016-11-22 02:59:20,656 _log_update: [1516] (63.9 %) of epoch 5 -- lr = 5, cost = 2.65, duration = 6.3 ms
2016-11-22 02:59:33,390 _log_update: [1716] (72.4 %) of epoch 5 -- lr = 5, cost = 2.85, duration = 6.3 ms
2016-11-22 02:59:46,121 _log_update: [1916] (80.8 %) of epoch 5 -- lr = 5, cost = 2.53, duration = 6.3 ms
2016-11-22 02:59:58,853 _log_update: [2116] (89.2 %) of epoch 5 -- lr = 5, cost = 2.42, duration = 6.3 ms
2016-11-22 03:00:11,599 _log_update: [2316] (97.7 %) of epoch 5 -- lr = 5, cost = 2.21, duration = 6.3 ms
2016-11-22 03:00:21,468 _validate: [2362] First validation sample, perplexity 671.74.
2016-11-22 03:00:49,439 _validate: [2366] Center of validation, perplexity 721.92.
2016-11-22 03:01:24,467 _validate: [2371] Last validation sample, perplexity 682.68.
2016-11-22 03:01:24,482 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 03:01:24,482 _log_validation: [2371] Validation set cost history: 1382.1 1194.5 1149.0 949.6 [686.9]
2016-11-22 03:01:24,483 _reset: Generating a random order of input lines.
Finished training epoch 5 in 0 hours 3.7 minutes. Best validation perplexity 686.89.
2016-11-22 03:01:33,721 _log_update: [145] (6.1 %) of epoch 6 -- lr = 5, cost = 2.27, duration = 6.3 ms
2016-11-22 03:01:46,457 _log_update: [345] (14.6 %) of epoch 6 -- lr = 5, cost = 2.24, duration = 6.3 ms
2016-11-22 03:01:59,182 _log_update: [545] (23.0 %) of epoch 6 -- lr = 5, cost = 3.03, duration = 6.3 ms
2016-11-22 03:02:11,938 _log_update: [745] (31.4 %) of epoch 6 -- lr = 5, cost = 2.33, duration = 6.6 ms
2016-11-22 03:02:24,698 _log_update: [945] (39.9 %) of epoch 6 -- lr = 5, cost = 3.75, duration = 6.3 ms
2016-11-22 03:02:37,429 _log_update: [1145] (48.3 %) of epoch 6 -- lr = 5, cost = 2.23, duration = 6.3 ms
2016-11-22 03:02:50,159 _log_update: [1345] (56.7 %) of epoch 6 -- lr = 5, cost = 1.96, duration = 6.3 ms
2016-11-22 03:03:02,894 _log_update: [1545] (65.2 %) of epoch 6 -- lr = 5, cost = 2.74, duration = 6.3 ms
2016-11-22 03:03:15,633 _log_update: [1745] (73.6 %) of epoch 6 -- lr = 5, cost = 2.36, duration = 6.3 ms
2016-11-22 03:03:28,367 _log_update: [1945] (82.0 %) of epoch 6 -- lr = 5, cost = 2.79, duration = 6.3 ms
2016-11-22 03:03:41,101 _log_update: [2145] (90.5 %) of epoch 6 -- lr = 5, cost = 2.87, duration = 6.3 ms
2016-11-22 03:03:53,832 _log_update: [2345] (98.9 %) of epoch 6 -- lr = 5, cost = 2.52, duration = 6.3 ms
2016-11-22 03:04:01,838 _validate: [2362] First validation sample, perplexity 528.68.
2016-11-22 03:04:29,813 _validate: [2366] Center of validation, perplexity 507.23.
2016-11-22 03:05:04,828 _validate: [2371] Last validation sample, perplexity 479.67.
2016-11-22 03:05:04,843 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 03:05:04,844 _log_validation: [2371] Validation set cost history: 1382.1 1194.5 1149.0 949.6 686.9 [499.1]
2016-11-22 03:05:04,845 _reset: Generating a random order of input lines.
Finished training epoch 6 in 0 hours 3.7 minutes. Best validation perplexity 499.13.
2016-11-22 03:05:15,934 _log_update: [174] (7.3 %) of epoch 7 -- lr = 5, cost = 2.26, duration = 6.3 ms
2016-11-22 03:05:28,665 _log_update: [374] (15.8 %) of epoch 7 -- lr = 5, cost = 2.78, duration = 6.3 ms
2016-11-22 03:05:41,393 _log_update: [574] (24.2 %) of epoch 7 -- lr = 5, cost = 2.43, duration = 6.3 ms
2016-11-22 03:05:54,128 _log_update: [774] (32.6 %) of epoch 7 -- lr = 5, cost = 1.92, duration = 6.3 ms
2016-11-22 03:06:06,856 _log_update: [974] (41.1 %) of epoch 7 -- lr = 5, cost = 2.44, duration = 6.3 ms
2016-11-22 03:06:19,596 _log_update: [1174] (49.5 %) of epoch 7 -- lr = 5, cost = 2.52, duration = 6.3 ms
2016-11-22 03:06:32,326 _log_update: [1374] (58.0 %) of epoch 7 -- lr = 5, cost = 2.46, duration = 6.3 ms
2016-11-22 03:06:45,063 _log_update: [1574] (66.4 %) of epoch 7 -- lr = 5, cost = 2.11, duration = 6.3 ms
2016-11-22 03:06:57,798 _log_update: [1774] (74.8 %) of epoch 7 -- lr = 5, cost = 2.97, duration = 6.3 ms
2016-11-22 03:07:10,543 _log_update: [1974] (83.3 %) of epoch 7 -- lr = 5, cost = 2.37, duration = 6.3 ms
2016-11-22 03:07:23,275 _log_update: [2174] (91.7 %) of epoch 7 -- lr = 5, cost = 2.58, duration = 6.3 ms
2016-11-22 03:07:42,169 _validate: [2362] First validation sample, perplexity 395.89.
2016-11-22 03:08:10,171 _validate: [2366] Center of validation, perplexity 399.18.
2016-11-22 03:08:45,181 _validate: [2371] Last validation sample, perplexity 395.13.
2016-11-22 03:08:45,197 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 03:08:45,197 _log_validation: [2371] Validation set cost history: 1382.1 1194.5 1149.0 949.6 686.9 499.1 [396.5]
2016-11-22 03:08:45,198 _reset: Generating a random order of input lines.
Finished training epoch 7 in 0 hours 3.7 minutes. Best validation perplexity 396.49.
2016-11-22 03:08:45,396 _log_update: [3] (0.1 %) of epoch 8 -- lr = 5, cost = 3.81, duration = 6.3 ms
2016-11-22 03:08:58,134 _log_update: [203] (8.6 %) of epoch 8 -- lr = 5, cost = 2.43, duration = 6.3 ms
2016-11-22 03:09:10,888 _log_update: [403] (17.0 %) of epoch 8 -- lr = 5, cost = 2.28, duration = 6.3 ms
2016-11-22 03:09:23,630 _log_update: [603] (25.4 %) of epoch 8 -- lr = 5, cost = 2.37, duration = 6.3 ms
2016-11-22 03:09:36,373 _log_update: [803] (33.9 %) of epoch 8 -- lr = 5, cost = 2.48, duration = 6.3 ms
2016-11-22 03:09:49,112 _log_update: [1003] (42.3 %) of epoch 8 -- lr = 5, cost = 2.02, duration = 6.4 ms
2016-11-22 03:10:01,863 _log_update: [1203] (50.7 %) of epoch 8 -- lr = 5, cost = 3.79, duration = 6.3 ms
2016-11-22 03:10:14,592 _log_update: [1403] (59.2 %) of epoch 8 -- lr = 5, cost = 2.45, duration = 6.3 ms
2016-11-22 03:10:27,331 _log_update: [1603] (67.6 %) of epoch 8 -- lr = 5, cost = 2.23, duration = 6.3 ms
2016-11-22 03:10:40,064 _log_update: [1803] (76.0 %) of epoch 8 -- lr = 5, cost = 3.40, duration = 6.3 ms
2016-11-22 03:10:52,799 _log_update: [2003] (84.5 %) of epoch 8 -- lr = 5, cost = 2.18, duration = 6.3 ms
2016-11-22 03:11:05,556 _log_update: [2203] (92.9 %) of epoch 8 -- lr = 5, cost = 2.32, duration = 6.3 ms
2016-11-22 03:11:22,616 _validate: [2362] First validation sample, perplexity 651.45.
2016-11-22 03:11:50,644 _validate: [2366] Center of validation, perplexity 615.95.
2016-11-22 03:12:25,728 _validate: [2371] Last validation sample, perplexity 605.95.
2016-11-22 03:12:25,729 _log_validation: [2371] Validation set cost history: 1382.1 1194.5 1149.0 949.6 686.9 499.1 [396.5] 618.7
2016-11-22 03:12:25,729 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-22 03:12:25,732 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-22 03:12:25,733 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-22 03:12:25,733 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-22 03:12:25,734 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-22 03:12:25,735 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-22 03:12:25,736 _reset_state: [2366] (99.79 %) of epoch 7
2016-11-22 03:12:25,736 _log_validation: [2366] Validation set cost history: 1382.1 1194.5 1149.0 949.6 686.9 499.1 [396.5]
2016-11-22 03:12:25,737 set_state: Restored iterator to line 41986 of 42068.
2016-11-22 03:12:25,740 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-22 03:12:25,741 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-22 03:12:25,741 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-22 03:12:25,742 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-22 03:12:25,742 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-22 03:12:25,743 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
Model performance stopped improving. Decreasing learning rate from 5.0 to 2.5 and resetting state to 100 % of epoch 7.
2016-11-22 03:12:25,744 _reset: Generating a random order of input lines.
Finished training epoch 7 in 0 hours 3.7 minutes. Best validation perplexity 396.49.
2016-11-22 03:12:27,792 _log_update: [32] (1.3 %) of epoch 8 -- lr = 2, cost = 2.35, duration = 6.3 ms
2016-11-22 03:12:40,530 _log_update: [232] (9.8 %) of epoch 8 -- lr = 2, cost = 1.97, duration = 6.3 ms
2016-11-22 03:12:53,269 _log_update: [432] (18.2 %) of epoch 8 -- lr = 2, cost = 3.84, duration = 6.3 ms
2016-11-22 03:13:06,014 _log_update: [632] (26.7 %) of epoch 8 -- lr = 2, cost = 2.35, duration = 6.3 ms
2016-11-22 03:13:18,752 _log_update: [832] (35.1 %) of epoch 8 -- lr = 2, cost = 3.07, duration = 6.3 ms
2016-11-22 03:13:31,495 _log_update: [1032] (43.5 %) of epoch 8 -- lr = 2, cost = 2.33, duration = 6.4 ms
2016-11-22 03:13:44,234 _log_update: [1232] (52.0 %) of epoch 8 -- lr = 2, cost = 2.33, duration = 6.3 ms
2016-11-22 03:13:56,971 _log_update: [1432] (60.4 %) of epoch 8 -- lr = 2, cost = 2.07, duration = 6.3 ms
2016-11-22 03:14:09,725 _log_update: [1632] (68.8 %) of epoch 8 -- lr = 2, cost = 2.29, duration = 6.3 ms
2016-11-22 03:14:22,474 _log_update: [1832] (77.3 %) of epoch 8 -- lr = 2, cost = 1.94, duration = 6.3 ms
2016-11-22 03:14:35,220 _log_update: [2032] (85.7 %) of epoch 8 -- lr = 2, cost = 2.24, duration = 6.3 ms
2016-11-22 03:14:47,959 _log_update: [2232] (94.1 %) of epoch 8 -- lr = 2, cost = 2.22, duration = 6.3 ms
2016-11-22 03:15:03,173 _validate: [2362] First validation sample, perplexity 359.70.
2016-11-22 03:15:31,201 _validate: [2366] Center of validation, perplexity 368.16.
2016-11-22 03:16:06,217 _validate: [2371] Last validation sample, perplexity 378.28.
2016-11-22 03:16:06,232 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 03:16:06,232 _log_validation: [2371] Validation set cost history: 1382.1 1194.5 1149.0 949.6 686.9 499.1 396.5 [370.6]
2016-11-22 03:16:06,233 _reset: Generating a random order of input lines.
Finished training epoch 8 in 0 hours 3.7 minutes. Best validation perplexity 370.63.
2016-11-22 03:16:10,128 _log_update: [61] (2.6 %) of epoch 9 -- lr = 2, cost = 2.36, duration = 6.4 ms
2016-11-22 03:16:22,860 _log_update: [261] (11.0 %) of epoch 9 -- lr = 2, cost = 2.26, duration = 6.3 ms
2016-11-22 03:16:35,598 _log_update: [461] (19.4 %) of epoch 9 -- lr = 2, cost = 4.00, duration = 6.3 ms
2016-11-22 03:16:48,329 _log_update: [661] (27.9 %) of epoch 9 -- lr = 2, cost = 3.17, duration = 6.3 ms
2016-11-22 03:17:01,064 _log_update: [861] (36.3 %) of epoch 9 -- lr = 2, cost = 3.94, duration = 6.3 ms
2016-11-22 03:17:13,797 _log_update: [1061] (44.7 %) of epoch 9 -- lr = 2, cost = 2.30, duration = 6.3 ms
2016-11-22 03:17:26,525 _log_update: [1261] (53.2 %) of epoch 9 -- lr = 2, cost = 2.43, duration = 6.3 ms
2016-11-22 03:17:39,264 _log_update: [1461] (61.6 %) of epoch 9 -- lr = 2, cost = 2.37, duration = 6.3 ms
2016-11-22 03:17:51,992 _log_update: [1661] (70.1 %) of epoch 9 -- lr = 2, cost = 2.06, duration = 6.3 ms
2016-11-22 03:18:04,758 _log_update: [1861] (78.5 %) of epoch 9 -- lr = 2, cost = 1.97, duration = 6.4 ms
2016-11-22 03:18:17,547 _log_update: [2061] (86.9 %) of epoch 9 -- lr = 2, cost = 2.20, duration = 6.4 ms
2016-11-22 03:18:30,339 _log_update: [2261] (95.4 %) of epoch 9 -- lr = 2, cost = 3.52, duration = 6.3 ms
2016-11-22 03:18:43,790 _validate: [2362] First validation sample, perplexity 271.83.
2016-11-22 03:19:11,769 _validate: [2366] Center of validation, perplexity 264.15.
2016-11-22 03:19:46,767 _validate: [2371] Last validation sample, perplexity 265.73.
2016-11-22 03:19:46,782 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 03:19:46,782 _log_validation: [2371] Validation set cost history: 1382.1 1194.5 1149.0 949.6 686.9 499.1 396.5 370.6 [267.1]
2016-11-22 03:19:46,783 _reset: Generating a random order of input lines.
Finished training epoch 9 in 0 hours 3.7 minutes. Best validation perplexity 267.06.
2016-11-22 03:19:52,519 _log_update: [90] (3.8 %) of epoch 10 -- lr = 2, cost = 2.14, duration = 6.3 ms
2016-11-22 03:20:05,261 _log_update: [290] (12.2 %) of epoch 10 -- lr = 2, cost = 2.19, duration = 6.3 ms
2016-11-22 03:20:18,006 _log_update: [490] (20.7 %) of epoch 10 -- lr = 2, cost = 2.15, duration = 6.3 ms
2016-11-22 03:20:30,734 _log_update: [690] (29.1 %) of epoch 10 -- lr = 2, cost = 2.05, duration = 6.3 ms
2016-11-22 03:20:43,467 _log_update: [890] (37.5 %) of epoch 10 -- lr = 2, cost = 2.48, duration = 6.3 ms
2016-11-22 03:20:56,240 _log_update: [1090] (46.0 %) of epoch 10 -- lr = 2, cost = 2.05, duration = 6.3 ms
2016-11-22 03:21:08,985 _log_update: [1290] (54.4 %) of epoch 10 -- lr = 2, cost = 2.26, duration = 6.4 ms
2016-11-22 03:21:21,723 _log_update: [1490] (62.8 %) of epoch 10 -- lr = 2, cost = 1.95, duration = 6.3 ms
2016-11-22 03:21:34,451 _log_update: [1690] (71.3 %) of epoch 10 -- lr = 2, cost = 2.17, duration = 6.3 ms
2016-11-22 03:21:47,191 _log_update: [1890] (79.7 %) of epoch 10 -- lr = 2, cost = 2.38, duration = 6.3 ms
2016-11-22 03:21:59,928 _log_update: [2090] (88.1 %) of epoch 10 -- lr = 2, cost = 2.10, duration = 6.3 ms
2016-11-22 03:22:12,677 _log_update: [2290] (96.6 %) of epoch 10 -- lr = 2, cost = 3.31, duration = 6.4 ms
2016-11-22 03:22:24,191 _validate: [2362] First validation sample, perplexity 272.48.
2016-11-22 03:22:52,191 _validate: [2366] Center of validation, perplexity 265.26.
2016-11-22 03:23:27,208 _validate: [2371] Last validation sample, perplexity 264.27.
2016-11-22 03:23:27,223 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 03:23:27,224 _log_validation: [2371] Validation set cost history: 1382.1 1194.5 1149.0 949.6 686.9 499.1 396.5 370.6 267.1 [266.7]
2016-11-22 03:23:27,225 _reset: Generating a random order of input lines.
Finished training epoch 10 in 0 hours 3.7 minutes. Best validation perplexity 266.69.
2016-11-22 03:23:34,812 _log_update: [119] (5.0 %) of epoch 11 -- lr = 2, cost = 2.01, duration = 6.3 ms
2016-11-22 03:23:47,541 _log_update: [319] (13.5 %) of epoch 11 -- lr = 2, cost = 2.51, duration = 6.3 ms
2016-11-22 03:24:00,278 _log_update: [519] (21.9 %) of epoch 11 -- lr = 2, cost = 2.44, duration = 6.3 ms
2016-11-22 03:24:13,007 _log_update: [719] (30.3 %) of epoch 11 -- lr = 2, cost = 1.81, duration = 6.3 ms
2016-11-22 03:24:25,732 _log_update: [919] (38.8 %) of epoch 11 -- lr = 2, cost = 2.18, duration = 6.4 ms
2016-11-22 03:24:38,462 _log_update: [1119] (47.2 %) of epoch 11 -- lr = 2, cost = 1.70, duration = 6.3 ms
2016-11-22 03:24:51,191 _log_update: [1319] (55.6 %) of epoch 11 -- lr = 2, cost = 2.04, duration = 6.3 ms
2016-11-22 03:25:03,928 _log_update: [1519] (64.1 %) of epoch 11 -- lr = 2, cost = 2.11, duration = 6.3 ms
2016-11-22 03:25:16,658 _log_update: [1719] (72.5 %) of epoch 11 -- lr = 2, cost = 1.94, duration = 6.3 ms
2016-11-22 03:25:29,392 _log_update: [1919] (80.9 %) of epoch 11 -- lr = 2, cost = 2.06, duration = 6.3 ms
2016-11-22 03:25:42,119 _log_update: [2119] (89.4 %) of epoch 11 -- lr = 2, cost = 1.83, duration = 6.3 ms
2016-11-22 03:25:54,871 _log_update: [2319] (97.8 %) of epoch 11 -- lr = 2, cost = 2.50, duration = 6.3 ms
2016-11-22 03:26:04,532 _validate: [2362] First validation sample, perplexity 261.40.
2016-11-22 03:26:32,495 _validate: [2366] Center of validation, perplexity 254.00.
2016-11-22 03:27:07,465 _validate: [2371] Last validation sample, perplexity 247.82.
2016-11-22 03:27:07,481 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 03:27:07,481 _log_validation: [2371] Validation set cost history: 1382.1 1194.5 1149.0 949.6 686.9 499.1 396.5 370.6 267.1 266.7 [253.3]
2016-11-22 03:27:07,482 _reset: Generating a random order of input lines.
Finished training epoch 11 in 0 hours 3.7 minutes. Best validation perplexity 253.33.
2016-11-22 03:27:16,913 _log_update: [148] (6.2 %) of epoch 12 -- lr = 2, cost = 1.90, duration = 6.3 ms
2016-11-22 03:27:29,652 _log_update: [348] (14.7 %) of epoch 12 -- lr = 2, cost = 2.16, duration = 6.3 ms
2016-11-22 03:27:42,394 _log_update: [548] (23.1 %) of epoch 12 -- lr = 2, cost = 2.09, duration = 6.3 ms
2016-11-22 03:27:55,141 _log_update: [748] (31.5 %) of epoch 12 -- lr = 2, cost = 1.94, duration = 6.4 ms
2016-11-22 03:28:07,880 _log_update: [948] (40.0 %) of epoch 12 -- lr = 2, cost = 2.30, duration = 6.3 ms
2016-11-22 03:28:20,610 _log_update: [1148] (48.4 %) of epoch 12 -- lr = 2, cost = 1.92, duration = 6.3 ms
2016-11-22 03:28:33,349 _log_update: [1348] (56.9 %) of epoch 12 -- lr = 2, cost = 2.31, duration = 6.3 ms
2016-11-22 03:28:46,086 _log_update: [1548] (65.3 %) of epoch 12 -- lr = 2, cost = 2.23, duration = 6.3 ms
2016-11-22 03:28:58,826 _log_update: [1748] (73.7 %) of epoch 12 -- lr = 2, cost = 2.46, duration = 6.3 ms
2016-11-22 03:29:11,567 _log_update: [1948] (82.2 %) of epoch 12 -- lr = 2, cost = 2.24, duration = 6.3 ms
2016-11-22 03:29:24,307 _log_update: [2148] (90.6 %) of epoch 12 -- lr = 2, cost = 2.05, duration = 6.3 ms
2016-11-22 03:29:37,045 _log_update: [2348] (99.0 %) of epoch 12 -- lr = 2, cost = 2.28, duration = 6.3 ms
2016-11-22 03:29:44,850 _validate: [2362] First validation sample, perplexity 282.48.
2016-11-22 03:30:12,841 _validate: [2366] Center of validation, perplexity 280.43.
2016-11-22 03:30:47,872 _validate: [2371] Last validation sample, perplexity 299.60.
2016-11-22 03:30:47,872 _log_validation: [2371] Validation set cost history: 1382.1 1194.5 1149.0 949.6 686.9 499.1 396.5 370.6 267.1 266.7 [253.3] 283.8
2016-11-22 03:30:47,873 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-22 03:30:47,876 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-22 03:30:47,876 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-22 03:30:47,877 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-22 03:30:47,877 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-22 03:30:47,878 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-22 03:30:47,879 _reset_state: [2366] (99.79 %) of epoch 11
2016-11-22 03:30:47,880 _log_validation: [2366] Validation set cost history: 1382.1 1194.5 1149.0 949.6 686.9 499.1 396.5 370.6 267.1 266.7 [253.3]
2016-11-22 03:30:47,880 set_state: Restored iterator to line 41979 of 42068.
2016-11-22 03:30:47,883 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-22 03:30:47,884 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-22 03:30:47,884 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-22 03:30:47,885 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-22 03:30:47,885 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-22 03:30:47,887 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
Model performance stopped improving. Decreasing learning rate from 2.5 to 1.25 and resetting state to 100 % of epoch 11.
2016-11-22 03:30:47,888 _reset: Generating a random order of input lines.
Finished training epoch 11 in 0 hours 3.7 minutes. Best validation perplexity 253.33.
2016-11-22 03:30:59,182 _log_update: [177] (7.5 %) of epoch 12 -- lr = 1, cost = 2.15, duration = 6.3 ms
2016-11-22 03:31:11,926 _log_update: [377] (15.9 %) of epoch 12 -- lr = 1, cost = 2.08, duration = 6.3 ms
2016-11-22 03:31:24,667 _log_update: [577] (24.3 %) of epoch 12 -- lr = 1, cost = 2.22, duration = 6.3 ms
2016-11-22 03:31:37,403 _log_update: [777] (32.8 %) of epoch 12 -- lr = 1, cost = 1.95, duration = 6.3 ms
2016-11-22 03:31:50,132 _log_update: [977] (41.2 %) of epoch 12 -- lr = 1, cost = 1.78, duration = 6.3 ms
2016-11-22 03:32:02,873 _log_update: [1177] (49.6 %) of epoch 12 -- lr = 1, cost = 2.22, duration = 6.3 ms
2016-11-22 03:32:15,604 _log_update: [1377] (58.1 %) of epoch 12 -- lr = 1, cost = 2.20, duration = 6.3 ms
2016-11-22 03:32:28,327 _log_update: [1577] (66.5 %) of epoch 12 -- lr = 1, cost = 2.42, duration = 6.3 ms
2016-11-22 03:32:41,067 _log_update: [1777] (74.9 %) of epoch 12 -- lr = 1, cost = 2.21, duration = 6.3 ms
2016-11-22 03:32:53,787 _log_update: [1977] (83.4 %) of epoch 12 -- lr = 1, cost = 1.83, duration = 6.3 ms
2016-11-22 03:33:06,535 _log_update: [2177] (91.8 %) of epoch 12 -- lr = 1, cost = 2.65, duration = 6.3 ms
2016-11-22 03:33:25,229 _validate: [2362] First validation sample, perplexity 206.67.
2016-11-22 03:33:53,195 _validate: [2366] Center of validation, perplexity 206.04.
2016-11-22 03:34:28,178 _validate: [2371] Last validation sample, perplexity 210.47.
2016-11-22 03:34:28,193 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 03:34:28,193 _log_validation: [2371] Validation set cost history: 1382.1 1194.5 1149.0 949.6 686.9 499.1 396.5 370.6 267.1 266.7 253.3 [208.2]
2016-11-22 03:34:28,194 _reset: Generating a random order of input lines.
Finished training epoch 12 in 0 hours 3.7 minutes. Best validation perplexity 208.23.
2016-11-22 03:34:28,583 _log_update: [6] (0.3 %) of epoch 13 -- lr = 1, cost = 1.89, duration = 6.3 ms
2016-11-22 03:34:41,316 _log_update: [206] (8.7 %) of epoch 13 -- lr = 1, cost = 1.96, duration = 6.3 ms
2016-11-22 03:34:54,046 _log_update: [406] (17.1 %) of epoch 13 -- lr = 1, cost = 2.30, duration = 6.3 ms
2016-11-22 03:35:06,785 _log_update: [606] (25.6 %) of epoch 13 -- lr = 1, cost = 1.81, duration = 6.3 ms
2016-11-22 03:35:19,515 _log_update: [806] (34.0 %) of epoch 13 -- lr = 1, cost = 2.09, duration = 6.3 ms
2016-11-22 03:35:32,242 _log_update: [1006] (42.4 %) of epoch 13 -- lr = 1, cost = 1.78, duration = 6.3 ms
2016-11-22 03:35:44,970 _log_update: [1206] (50.9 %) of epoch 13 -- lr = 1, cost = 2.40, duration = 6.3 ms
2016-11-22 03:35:57,711 _log_update: [1406] (59.3 %) of epoch 13 -- lr = 1, cost = 1.71, duration = 6.3 ms
2016-11-22 03:36:10,451 _log_update: [1606] (67.7 %) of epoch 13 -- lr = 1, cost = 3.11, duration = 6.3 ms
2016-11-22 03:36:23,189 _log_update: [1806] (76.2 %) of epoch 13 -- lr = 1, cost = 2.66, duration = 6.3 ms
2016-11-22 03:36:35,922 _log_update: [2006] (84.6 %) of epoch 13 -- lr = 1, cost = 1.83, duration = 6.3 ms
2016-11-22 03:36:48,655 _log_update: [2206] (93.0 %) of epoch 13 -- lr = 1, cost = 4.04, duration = 6.3 ms
2016-11-22 03:37:05,518 _validate: [2362] First validation sample, perplexity 191.67.
2016-11-22 03:37:33,470 _validate: [2366] Center of validation, perplexity 189.27.
2016-11-22 03:38:08,459 _validate: [2371] Last validation sample, perplexity 186.71.
2016-11-22 03:38:08,474 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 03:38:08,474 _log_validation: [2371] Validation set cost history: 1382.1 1194.5 1149.0 949.6 686.9 499.1 396.5 370.6 267.1 266.7 253.3 208.2 [188.8]
2016-11-22 03:38:08,475 _reset: Generating a random order of input lines.
Finished training epoch 13 in 0 hours 3.7 minutes. Best validation perplexity 188.78.
2016-11-22 03:38:10,712 _log_update: [35] (1.5 %) of epoch 14 -- lr = 1, cost = 1.87, duration = 6.3 ms
2016-11-22 03:38:23,454 _log_update: [235] (9.9 %) of epoch 14 -- lr = 1, cost = 2.20, duration = 6.3 ms
2016-11-22 03:38:36,178 _log_update: [435] (18.3 %) of epoch 14 -- lr = 1, cost = 1.75, duration = 6.3 ms
2016-11-22 03:38:48,912 _log_update: [635] (26.8 %) of epoch 14 -- lr = 1, cost = 2.25, duration = 6.3 ms
2016-11-22 03:39:01,647 _log_update: [835] (35.2 %) of epoch 14 -- lr = 1, cost = 2.13, duration = 6.3 ms
2016-11-22 03:39:14,387 _log_update: [1035] (43.7 %) of epoch 14 -- lr = 1, cost = 2.01, duration = 6.3 ms
2016-11-22 03:39:27,124 _log_update: [1235] (52.1 %) of epoch 14 -- lr = 1, cost = 1.96, duration = 6.3 ms
2016-11-22 03:39:39,855 _log_update: [1435] (60.5 %) of epoch 14 -- lr = 1, cost = 2.01, duration = 6.3 ms
2016-11-22 03:39:52,584 _log_update: [1635] (69.0 %) of epoch 14 -- lr = 1, cost = 2.31, duration = 6.3 ms
2016-11-22 03:40:05,323 _log_update: [1835] (77.4 %) of epoch 14 -- lr = 1, cost = 1.98, duration = 6.3 ms
2016-11-22 03:40:18,053 _log_update: [2035] (85.8 %) of epoch 14 -- lr = 1, cost = 1.78, duration = 6.3 ms
2016-11-22 03:40:30,782 _log_update: [2235] (94.3 %) of epoch 14 -- lr = 1, cost = 3.84, duration = 6.3 ms
2016-11-22 03:40:45,795 _validate: [2362] First validation sample, perplexity 194.83.
2016-11-22 03:41:13,872 _validate: [2366] Center of validation, perplexity 193.70.
2016-11-22 03:41:48,906 _validate: [2371] Last validation sample, perplexity 198.63.
2016-11-22 03:41:48,906 _log_validation: [2371] Validation set cost history: 1382.1 1194.5 1149.0 949.6 686.9 499.1 396.5 370.6 267.1 266.7 253.3 208.2 [188.8] 194.7
2016-11-22 03:41:48,907 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-22 03:41:48,910 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-22 03:41:48,910 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-22 03:41:48,911 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-22 03:41:48,911 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-22 03:41:48,912 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-22 03:41:48,913 _reset_state: [2366] (99.79 %) of epoch 13
2016-11-22 03:41:48,914 _log_validation: [2366] Validation set cost history: 1382.1 1194.5 1149.0 949.6 686.9 499.1 396.5 370.6 267.1 266.7 253.3 208.2 [188.8]
2016-11-22 03:41:48,914 set_state: Restored iterator to line 41991 of 42068.
2016-11-22 03:41:48,917 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-22 03:41:48,918 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-22 03:41:48,918 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-22 03:41:48,919 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-22 03:41:48,919 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-22 03:41:48,921 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
Model performance stopped improving. Decreasing learning rate from 1.25 to 0.625 and resetting state to 100 % of epoch 13.
2016-11-22 03:41:48,922 _reset: Generating a random order of input lines.
Finished training epoch 13 in 0 hours 3.7 minutes. Best validation perplexity 188.78.
2016-11-22 03:41:53,000 _log_update: [64] (2.7 %) of epoch 14 -- lr = 0.6, cost = 2.12, duration = 6.3 ms
2016-11-22 03:42:05,739 _log_update: [264] (11.1 %) of epoch 14 -- lr = 0.6, cost = 1.83, duration = 6.3 ms
2016-11-22 03:42:18,486 _log_update: [464] (19.6 %) of epoch 14 -- lr = 0.6, cost = 2.06, duration = 6.3 ms
2016-11-22 03:42:31,217 _log_update: [664] (28.0 %) of epoch 14 -- lr = 0.6, cost = 2.17, duration = 6.3 ms
2016-11-22 03:42:43,942 _log_update: [864] (36.4 %) of epoch 14 -- lr = 0.6, cost = 1.84, duration = 6.3 ms
2016-11-22 03:42:56,674 _log_update: [1064] (44.9 %) of epoch 14 -- lr = 0.6, cost = 2.97, duration = 6.4 ms
2016-11-22 03:43:09,409 _log_update: [1264] (53.3 %) of epoch 14 -- lr = 0.6, cost = 1.83, duration = 6.2 ms
2016-11-22 03:43:22,146 _log_update: [1464] (61.7 %) of epoch 14 -- lr = 0.6, cost = 2.06, duration = 6.3 ms
2016-11-22 03:43:34,879 _log_update: [1664] (70.2 %) of epoch 14 -- lr = 0.6, cost = 2.08, duration = 6.3 ms
2016-11-22 03:43:47,612 _log_update: [1864] (78.6 %) of epoch 14 -- lr = 0.6, cost = 2.45, duration = 6.3 ms
2016-11-22 03:44:00,345 _log_update: [2064] (87.1 %) of epoch 14 -- lr = 0.6, cost = 3.77, duration = 6.3 ms
2016-11-22 03:44:13,083 _log_update: [2264] (95.5 %) of epoch 14 -- lr = 0.6, cost = 1.80, duration = 6.3 ms
2016-11-22 03:44:26,254 _validate: [2362] First validation sample, perplexity 183.38.
2016-11-22 03:44:54,233 _validate: [2366] Center of validation, perplexity 182.24.
2016-11-22 03:45:29,662 _validate: [2371] Last validation sample, perplexity 182.15.
2016-11-22 03:45:29,677 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 03:45:29,677 _log_validation: [2371] Validation set cost history: 1382.1 1194.5 1149.0 949.6 686.9 499.1 396.5 370.6 267.1 266.7 253.3 208.2 188.8 [182.7]
2016-11-22 03:45:29,678 _reset: Generating a random order of input lines.
Finished training epoch 14 in 0 hours 3.7 minutes. Best validation perplexity 182.67.
2016-11-22 03:45:35,611 _log_update: [93] (3.9 %) of epoch 15 -- lr = 0.6, cost = 1.99, duration = 6.3 ms
2016-11-22 03:45:48,337 _log_update: [293] (12.4 %) of epoch 15 -- lr = 0.6, cost = 2.42, duration = 6.3 ms
2016-11-22 03:46:01,105 _log_update: [493] (20.8 %) of epoch 15 -- lr = 0.6, cost = 2.16, duration = 6.4 ms
2016-11-22 03:46:13,895 _log_update: [693] (29.2 %) of epoch 15 -- lr = 0.6, cost = 2.59, duration = 6.3 ms
2016-11-22 03:46:26,688 _log_update: [893] (37.7 %) of epoch 15 -- lr = 0.6, cost = 2.03, duration = 6.3 ms
2016-11-22 03:46:39,485 _log_update: [1093] (46.1 %) of epoch 15 -- lr = 0.6, cost = 1.85, duration = 6.4 ms
2016-11-22 03:46:52,274 _log_update: [1293] (54.5 %) of epoch 15 -- lr = 0.6, cost = 2.19, duration = 6.4 ms
2016-11-22 03:47:05,053 _log_update: [1493] (63.0 %) of epoch 15 -- lr = 0.6, cost = 1.93, duration = 6.3 ms
2016-11-22 03:47:17,782 _log_update: [1693] (71.4 %) of epoch 15 -- lr = 0.6, cost = 2.48, duration = 6.3 ms
2016-11-22 03:47:30,517 _log_update: [1893] (79.8 %) of epoch 15 -- lr = 0.6, cost = 1.85, duration = 6.3 ms
2016-11-22 03:47:43,254 _log_update: [2093] (88.3 %) of epoch 15 -- lr = 0.6, cost = 1.71, duration = 6.3 ms
2016-11-22 03:47:55,990 _log_update: [2293] (96.7 %) of epoch 15 -- lr = 0.6, cost = 2.30, duration = 6.3 ms
2016-11-22 03:48:07,324 _validate: [2362] First validation sample, perplexity 186.95.
2016-11-22 03:48:35,317 _validate: [2366] Center of validation, perplexity 187.35.
2016-11-22 03:49:10,350 _validate: [2371] Last validation sample, perplexity 187.39.
2016-11-22 03:49:10,350 _log_validation: [2371] Validation set cost history: 1382.1 1194.5 1149.0 949.6 686.9 499.1 396.5 370.6 267.1 266.7 253.3 208.2 188.8 [182.7] 187.2
2016-11-22 03:49:10,351 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-22 03:49:10,354 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-22 03:49:10,354 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-22 03:49:10,355 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-22 03:49:10,355 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-22 03:49:10,356 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-22 03:49:10,357 _reset_state: [2366] (99.79 %) of epoch 14
2016-11-22 03:49:10,358 _log_validation: [2366] Validation set cost history: 1382.1 1194.5 1149.0 949.6 686.9 499.1 396.5 370.6 267.1 266.7 253.3 208.2 188.8 [182.7]
2016-11-22 03:49:10,358 set_state: Restored iterator to line 41983 of 42068.
2016-11-22 03:49:10,361 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-22 03:49:10,362 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-22 03:49:10,362 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-22 03:49:10,363 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-22 03:49:10,363 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-22 03:49:10,365 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
Model performance stopped improving. Decreasing learning rate from 0.625 to 0.3125 and resetting state to 100 % of epoch 14.
2016-11-22 03:49:10,366 _reset: Generating a random order of input lines.
Finished training epoch 14 in 0 hours 3.7 minutes. Best validation perplexity 182.67.
2016-11-22 03:49:18,145 _log_update: [122] (5.1 %) of epoch 15 -- lr = 0.3, cost = 2.02, duration = 6.3 ms
2016-11-22 03:49:30,890 _log_update: [322] (13.6 %) of epoch 15 -- lr = 0.3, cost = 1.90, duration = 6.4 ms
2016-11-22 03:49:43,638 _log_update: [522] (22.0 %) of epoch 15 -- lr = 0.3, cost = 2.10, duration = 6.3 ms
2016-11-22 03:49:56,385 _log_update: [722] (30.5 %) of epoch 15 -- lr = 0.3, cost = 1.86, duration = 6.4 ms
2016-11-22 03:50:09,132 _log_update: [922] (38.9 %) of epoch 15 -- lr = 0.3, cost = 1.83, duration = 6.3 ms
2016-11-22 03:50:21,871 _log_update: [1122] (47.3 %) of epoch 15 -- lr = 0.3, cost = 2.02, duration = 6.3 ms
2016-11-22 03:50:34,603 _log_update: [1322] (55.8 %) of epoch 15 -- lr = 0.3, cost = 1.66, duration = 6.3 ms
2016-11-22 03:50:47,339 _log_update: [1522] (64.2 %) of epoch 15 -- lr = 0.3, cost = 1.95, duration = 6.3 ms
2016-11-22 03:51:00,113 _log_update: [1722] (72.6 %) of epoch 15 -- lr = 0.3, cost = 1.99, duration = 7.0 ms
2016-11-22 03:51:12,847 _log_update: [1922] (81.1 %) of epoch 15 -- lr = 0.3, cost = 1.97, duration = 6.3 ms
2016-11-22 03:51:25,593 _log_update: [2122] (89.5 %) of epoch 15 -- lr = 0.3, cost = 2.00, duration = 6.3 ms
2016-11-22 03:51:38,325 _log_update: [2322] (97.9 %) of epoch 15 -- lr = 0.3, cost = 1.85, duration = 6.3 ms
2016-11-22 03:51:47,799 _validate: [2362] First validation sample, perplexity 170.44.
2016-11-22 03:52:15,794 _validate: [2366] Center of validation, perplexity 170.78.
2016-11-22 03:52:50,862 _validate: [2371] Last validation sample, perplexity 170.62.
2016-11-22 03:52:50,878 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-22 03:52:50,878 _log_validation: [2371] Validation set cost history: 1382.1 1194.5 1149.0 949.6 686.9 499.1 396.5 370.6 267.1 266.7 253.3 208.2 188.8 182.7 [170.8]
2016-11-22 03:52:50,879 _reset: Generating a random order of input lines.
Finished training epoch 15 in 0 hours 3.7 minutes. Best validation perplexity 170.79.
Stopping because 15 epochs was reached.
Training finished in 1 hours 9.8 minutes.
2016-11-22 03:52:50,886 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-22 03:52:50,890 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-22 03:52:50,890 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-22 03:52:50,891 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-22 03:52:50,891 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-22 03:52:50,892 set_state: layers/projection_layer/W <- array(10001, 100)
Best validation set perplexity: 170.782855315
train finished.
Computing evaluation set perplexity.
Reading vocabulary from network state.
Number of words in vocabulary: 10001
Number of word classes: 10001
Building neural network.
Restoring neural network state.
Building text scorer.
Scoring text.
Number of sentences: 3761
Number of words: 86191
Number of predicted probabilities: 82430
Cross entropy (base e): 5.10141615055595
Perplexity: 164.25435156430277
