THEANO_FLAGS=floatX=float32,device=gpu,nvcc.fastmath=True
/l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab
Reading vocabulary from /l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab.
Number of words in vocabulary: 10001
Number of word classes: 10001
2016-11-24 20:31:22,304 train: TRAINING OPTIONS
2016-11-24 20:31:22,304 train: validation_frequency: 1
2016-11-24 20:31:22,304 train: max_epochs: 15
2016-11-24 20:31:22,304 train: min_epochs: 1
2016-11-24 20:31:22,304 train: sequence_length: 25
2016-11-24 20:31:22,304 train: stopping_criterion: no-improvement
2016-11-24 20:31:22,304 train: batch_size: 32
2016-11-24 20:31:22,304 train: patience: 0
2016-11-24 20:31:22,304 train: max_annealing_count: 0
2016-11-24 20:31:22,305 train: OPTIMIZATION OPTIONS
2016-11-24 20:31:22,305 train: ignore_unk: False
2016-11-24 20:31:22,305 train: sqr_gradient_decay_rate: 0.999
2016-11-24 20:31:22,305 train: num_noise_samples: 25
2016-11-24 20:31:22,305 train: gradient_decay_rate: 0.9
2016-11-24 20:31:22,305 train: cost_function: nce
2016-11-24 20:31:22,305 train: momentum: 0.9
2016-11-24 20:31:22,305 train: epsilon: 1e-06
2016-11-24 20:31:22,305 train: learning_rate: 20.0
2016-11-24 20:31:22,305 train: unk_penalty: None
2016-11-24 20:31:22,305 train: max_gradient_norm: 5.0
2016-11-24 20:31:22,305 train: weights: [ 1.]
2016-11-24 20:31:22,305 train: method: sgd
Creating trainer.
Computing unigram probabilities and the number of mini-batches in training data.
2016-11-24 20:31:23,548 __init__: One epoch of training data contains 1778 mini-batch updates.
2016-11-24 20:31:23,548 __init__: Class unigram probabilities are in the range [0.00000103, 0.05232915].
2016-11-24 20:31:23,549 __init__: Finding sentence start positions in /teamwork/t40511_asr/c/penn-treebank-project/ptb.train.txt.
2016-11-24 20:31:23,572 _reset: Generating a random order of input lines.
Building neural network.
2016-11-24 20:31:23,579 __init__: Creating layers.
2016-11-24 20:31:23,579 __init__: - NetworkInput name=word_input inputs=[] size=10001
2016-11-24 20:31:23,579 __init__: - ProjectionLayer name=projection_layer inputs=[word_input] size=100
2016-11-24 20:31:23,618 __init__: - LSTMLayer name=hidden_layer inputs=[projection_layer] size=256
2016-11-24 20:31:23,735 __init__: - SoftmaxLayer name=output_layer inputs=[hidden_layer] size=10001
2016-11-24 20:31:23,851 __init__: Initializing parameters.
2016-11-24 20:31:23,851 __init__: - layers/projection_layer/W size=1000100 type=float32
2016-11-24 20:31:23,851 __init__: - layers/hidden_layer/layer_input/W size=102400 type=float32
2016-11-24 20:31:23,851 __init__: - layers/hidden_layer/step_input/W size=262144 type=float32
2016-11-24 20:31:23,851 __init__: - layers/hidden_layer/layer_input/b size=1024 type=float32
2016-11-24 20:31:23,851 __init__: - layers/output_layer/input/W size=2560256 type=float32
2016-11-24 20:31:23,851 __init__: - layers/output_layer/input/b size=10001 type=float32
2016-11-24 20:31:23,851 __init__: Total number of parameters: 3935925
Compiling optimization function.
Building text scorer for cross-validation.
Validation text: /teamwork/t40511_asr/c/penn-treebank-project/ptb.valid.txt
Training neural network.
2016-11-24 20:38:30,047 _log_update: [200] (11.2 %) of epoch 1 -- lr = 2e+01, cost = 4.45, duration = 37.5 ms
2016-11-24 20:39:45,326 _log_update: [400] (22.5 %) of epoch 1 -- lr = 2e+01, cost = 3.98, duration = 37.5 ms
2016-11-24 20:41:03,215 _log_update: [600] (33.7 %) of epoch 1 -- lr = 2e+01, cost = 3.64, duration = 37.5 ms
2016-11-24 20:42:18,421 _log_update: [800] (45.0 %) of epoch 1 -- lr = 2e+01, cost = 3.67, duration = 37.5 ms
2016-11-24 20:43:33,592 _log_update: [1000] (56.2 %) of epoch 1 -- lr = 2e+01, cost = 3.53, duration = 37.4 ms
2016-11-24 20:44:48,770 _log_update: [1200] (67.5 %) of epoch 1 -- lr = 2e+01, cost = 3.38, duration = 37.5 ms
2016-11-24 20:46:04,438 _log_update: [1400] (78.7 %) of epoch 1 -- lr = 2e+01, cost = 3.46, duration = 37.5 ms
2016-11-24 20:47:19,672 _log_update: [1600] (90.0 %) of epoch 1 -- lr = 2e+01, cost = 3.16, duration = 37.5 ms
2016-11-24 20:48:31,106 _validate: [1772] First validation sample, perplexity 357.57.
2016-11-24 20:48:52,393 _validate: [1775] Center of validation, perplexity 316.24.
2016-11-24 20:49:13,725 _validate: [1778] Last validation sample, perplexity 276.00.
2016-11-24 20:49:13,747 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-24 20:49:13,747 _log_validation: [1778] Validation set cost history: [316.2]
2016-11-24 20:49:13,748 _reset: Generating a random order of input lines.
Finished training epoch 1 in 0 hours 12.0 minutes. Best validation perplexity 316.24.
2016-11-24 20:49:21,933 _log_update: [22] (1.2 %) of epoch 2 -- lr = 2e+01, cost = 3.08, duration = 37.1 ms
2016-11-24 20:50:36,244 _log_update: [222] (12.5 %) of epoch 2 -- lr = 2e+01, cost = 3.31, duration = 37.1 ms
2016-11-24 20:51:50,607 _log_update: [422] (23.7 %) of epoch 2 -- lr = 2e+01, cost = 3.37, duration = 37.1 ms
2016-11-24 20:53:04,910 _log_update: [622] (35.0 %) of epoch 2 -- lr = 2e+01, cost = 3.07, duration = 37.1 ms
2016-11-24 20:54:19,207 _log_update: [822] (46.2 %) of epoch 2 -- lr = 2e+01, cost = 3.21, duration = 37.0 ms
2016-11-24 20:55:33,464 _log_update: [1022] (57.5 %) of epoch 2 -- lr = 2e+01, cost = 2.91, duration = 37.1 ms
2016-11-24 20:56:47,766 _log_update: [1222] (68.7 %) of epoch 2 -- lr = 2e+01, cost = 3.19, duration = 37.1 ms
2016-11-24 20:58:02,061 _log_update: [1422] (80.0 %) of epoch 2 -- lr = 2e+01, cost = 2.99, duration = 37.1 ms
2016-11-24 20:59:16,324 _log_update: [1622] (91.2 %) of epoch 2 -- lr = 2e+01, cost = 2.99, duration = 37.0 ms
2016-11-24 21:00:18,525 _validate: [1772] First validation sample, perplexity 261.92.
2016-11-24 21:00:39,129 _validate: [1775] Center of validation, perplexity 252.94.
2016-11-24 21:00:59,759 _validate: [1778] Last validation sample, perplexity 226.88.
2016-11-24 21:00:59,779 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-24 21:00:59,780 _log_validation: [1778] Validation set cost history: 316.2 [252.9]
2016-11-24 21:00:59,780 _reset: Generating a random order of input lines.
Finished training epoch 2 in 0 hours 11.8 minutes. Best validation perplexity 252.94.
2016-11-24 21:01:16,140 _log_update: [44] (2.5 %) of epoch 3 -- lr = 2e+01, cost = 3.01, duration = 37.1 ms
2016-11-24 21:02:30,436 _log_update: [244] (13.7 %) of epoch 3 -- lr = 2e+01, cost = 2.95, duration = 37.0 ms
2016-11-24 21:03:44,784 _log_update: [444] (25.0 %) of epoch 3 -- lr = 2e+01, cost = 2.78, duration = 37.1 ms
2016-11-24 21:04:59,080 _log_update: [644] (36.2 %) of epoch 3 -- lr = 2e+01, cost = 2.81, duration = 37.0 ms
2016-11-24 21:06:13,391 _log_update: [844] (47.5 %) of epoch 3 -- lr = 2e+01, cost = 2.98, duration = 37.1 ms
2016-11-24 21:07:27,703 _log_update: [1044] (58.7 %) of epoch 3 -- lr = 2e+01, cost = 2.94, duration = 37.1 ms
2016-11-24 21:08:41,992 _log_update: [1244] (70.0 %) of epoch 3 -- lr = 2e+01, cost = 2.92, duration = 37.0 ms
2016-11-24 21:09:56,256 _log_update: [1444] (81.2 %) of epoch 3 -- lr = 2e+01, cost = 2.76, duration = 37.0 ms
2016-11-24 21:11:10,579 _log_update: [1644] (92.5 %) of epoch 3 -- lr = 2e+01, cost = 2.87, duration = 37.0 ms
2016-11-24 21:12:04,583 _validate: [1772] First validation sample, perplexity 200.08.
2016-11-24 21:12:25,137 _validate: [1775] Center of validation, perplexity 204.98.
2016-11-24 21:12:46,341 _validate: [1778] Last validation sample, perplexity 231.08.
2016-11-24 21:12:46,357 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-24 21:12:46,357 _log_validation: [1778] Validation set cost history: 316.2 252.9 [202.0]
2016-11-24 21:12:46,358 _reset: Generating a random order of input lines.
Finished training epoch 3 in 0 hours 11.8 minutes. Best validation perplexity 202.02.
2016-11-24 21:13:10,878 _log_update: [66] (3.7 %) of epoch 4 -- lr = 2e+01, cost = 2.84, duration = 37.0 ms
2016-11-24 21:14:25,134 _log_update: [266] (15.0 %) of epoch 4 -- lr = 2e+01, cost = 2.87, duration = 37.0 ms
2016-11-24 21:15:39,390 _log_update: [466] (26.2 %) of epoch 4 -- lr = 2e+01, cost = 2.86, duration = 37.0 ms
2016-11-24 21:16:53,632 _log_update: [666] (37.5 %) of epoch 4 -- lr = 2e+01, cost = 2.64, duration = 37.0 ms
2016-11-24 21:18:07,849 _log_update: [866] (48.7 %) of epoch 4 -- lr = 2e+01, cost = 2.60, duration = 37.0 ms
2016-11-24 21:19:22,098 _log_update: [1066] (60.0 %) of epoch 4 -- lr = 2e+01, cost = 2.94, duration = 37.0 ms
2016-11-24 21:20:36,368 _log_update: [1266] (71.2 %) of epoch 4 -- lr = 2e+01, cost = 2.93, duration = 37.0 ms
2016-11-24 21:21:50,620 _log_update: [1466] (82.5 %) of epoch 4 -- lr = 2e+01, cost = 2.84, duration = 37.0 ms
2016-11-24 21:23:04,801 _log_update: [1666] (93.7 %) of epoch 4 -- lr = 2e+01, cost = 2.91, duration = 36.9 ms
2016-11-24 21:23:50,578 _validate: [1772] First validation sample, perplexity 189.03.
2016-11-24 21:24:11,084 _validate: [1775] Center of validation, perplexity 185.53.
2016-11-24 21:24:32,236 _validate: [1778] Last validation sample, perplexity 185.48.
2016-11-24 21:24:32,252 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-24 21:24:32,252 _log_validation: [1778] Validation set cost history: 316.2 252.9 202.0 [186.7]
2016-11-24 21:24:32,252 _reset: Generating a random order of input lines.
Finished training epoch 4 in 0 hours 11.8 minutes. Best validation perplexity 186.69.
2016-11-24 21:25:04,896 _log_update: [88] (4.9 %) of epoch 5 -- lr = 2e+01, cost = 2.74, duration = 37.0 ms
2016-11-24 21:26:19,102 _log_update: [288] (16.2 %) of epoch 5 -- lr = 2e+01, cost = 2.72, duration = 37.0 ms
2016-11-24 21:27:33,319 _log_update: [488] (27.4 %) of epoch 5 -- lr = 2e+01, cost = 2.71, duration = 37.0 ms
2016-11-24 21:28:47,514 _log_update: [688] (38.7 %) of epoch 5 -- lr = 2e+01, cost = 2.88, duration = 37.0 ms
2016-11-24 21:30:01,718 _log_update: [888] (49.9 %) of epoch 5 -- lr = 2e+01, cost = 2.76, duration = 37.0 ms
2016-11-24 21:31:15,949 _log_update: [1088] (61.2 %) of epoch 5 -- lr = 2e+01, cost = 2.70, duration = 37.0 ms
2016-11-24 21:32:30,132 _log_update: [1288] (72.4 %) of epoch 5 -- lr = 2e+01, cost = 2.65, duration = 37.0 ms
2016-11-24 21:33:44,304 _log_update: [1488] (83.7 %) of epoch 5 -- lr = 2e+01, cost = 2.70, duration = 37.0 ms
2016-11-24 21:34:58,497 _log_update: [1688] (94.9 %) of epoch 5 -- lr = 2e+01, cost = 2.72, duration = 37.1 ms
2016-11-24 21:35:36,118 _validate: [1772] First validation sample, perplexity 196.63.
2016-11-24 21:35:56,625 _validate: [1775] Center of validation, perplexity 180.32.
2016-11-24 21:36:17,788 _validate: [1778] Last validation sample, perplexity 180.82.
2016-11-24 21:36:17,803 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-24 21:36:17,803 _log_validation: [1778] Validation set cost history: 316.2 252.9 202.0 186.7 [184.5]
2016-11-24 21:36:17,804 _reset: Generating a random order of input lines.
Finished training epoch 5 in 0 hours 11.8 minutes. Best validation perplexity 184.52.
2016-11-24 21:36:58,604 _log_update: [110] (6.2 %) of epoch 6 -- lr = 2e+01, cost = 2.58, duration = 37.0 ms
2016-11-24 21:38:12,814 _log_update: [310] (17.4 %) of epoch 6 -- lr = 2e+01, cost = 2.71, duration = 37.0 ms
2016-11-24 21:39:27,003 _log_update: [510] (28.7 %) of epoch 6 -- lr = 2e+01, cost = 2.68, duration = 37.0 ms
2016-11-24 21:40:41,184 _log_update: [710] (39.9 %) of epoch 6 -- lr = 2e+01, cost = 2.56, duration = 37.0 ms
2016-11-24 21:41:55,469 _log_update: [910] (51.2 %) of epoch 6 -- lr = 2e+01, cost = 2.47, duration = 37.0 ms
2016-11-24 21:43:09,670 _log_update: [1110] (62.4 %) of epoch 6 -- lr = 2e+01, cost = 2.54, duration = 37.0 ms
2016-11-24 21:44:23,937 _log_update: [1310] (73.7 %) of epoch 6 -- lr = 2e+01, cost = 2.47, duration = 37.1 ms
2016-11-24 21:45:38,751 _log_update: [1510] (84.9 %) of epoch 6 -- lr = 2e+01, cost = 2.61, duration = 37.0 ms
2016-11-24 21:46:52,975 _log_update: [1710] (96.2 %) of epoch 6 -- lr = 2e+01, cost = 2.56, duration = 37.1 ms
2016-11-24 21:47:22,456 _validate: [1772] First validation sample, perplexity 175.60.
2016-11-24 21:47:42,948 _validate: [1775] Center of validation, perplexity 182.19.
2016-11-24 21:48:04,099 _validate: [1778] Last validation sample, perplexity 175.78.
2016-11-24 21:48:04,114 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-24 21:48:04,114 _log_validation: [1778] Validation set cost history: 316.2 252.9 202.0 186.7 184.5 [177.4]
2016-11-24 21:48:04,115 _reset: Generating a random order of input lines.
Finished training epoch 6 in 0 hours 11.8 minutes. Best validation perplexity 177.39.
2016-11-24 21:48:53,103 _log_update: [132] (7.4 %) of epoch 7 -- lr = 2e+01, cost = 2.45, duration = 37.0 ms
2016-11-24 21:50:07,315 _log_update: [332] (18.7 %) of epoch 7 -- lr = 2e+01, cost = 2.50, duration = 37.0 ms
2016-11-24 21:51:21,568 _log_update: [532] (29.9 %) of epoch 7 -- lr = 2e+01, cost = 2.43, duration = 37.0 ms
2016-11-24 21:52:35,838 _log_update: [732] (41.2 %) of epoch 7 -- lr = 2e+01, cost = 2.52, duration = 37.0 ms
2016-11-24 21:53:50,104 _log_update: [932] (52.4 %) of epoch 7 -- lr = 2e+01, cost = 2.62, duration = 37.0 ms
2016-11-24 21:55:04,356 _log_update: [1132] (63.7 %) of epoch 7 -- lr = 2e+01, cost = 2.50, duration = 37.0 ms
2016-11-24 21:56:18,654 _log_update: [1332] (74.9 %) of epoch 7 -- lr = 2e+01, cost = 2.43, duration = 37.0 ms
2016-11-24 21:57:32,824 _log_update: [1532] (86.2 %) of epoch 7 -- lr = 2e+01, cost = 2.50, duration = 37.0 ms
2016-11-24 21:58:47,017 _log_update: [1732] (97.4 %) of epoch 7 -- lr = 2e+01, cost = 2.73, duration = 37.0 ms
2016-11-24 21:59:08,312 _validate: [1772] First validation sample, perplexity 180.79.
2016-11-24 21:59:28,814 _validate: [1775] Center of validation, perplexity 172.37.
2016-11-24 21:59:49,969 _validate: [1778] Last validation sample, perplexity 175.97.
2016-11-24 21:59:49,984 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-24 21:59:49,984 _log_validation: [1778] Validation set cost history: 316.2 252.9 202.0 186.7 184.5 177.4 [172.4]
2016-11-24 21:59:49,985 _reset: Generating a random order of input lines.
Finished training epoch 7 in 0 hours 11.8 minutes. Best validation perplexity 172.40.
2016-11-24 22:00:47,108 _log_update: [154] (8.7 %) of epoch 8 -- lr = 2e+01, cost = 2.40, duration = 37.0 ms
2016-11-24 22:02:01,328 _log_update: [354] (19.9 %) of epoch 8 -- lr = 2e+01, cost = 2.65, duration = 37.0 ms
2016-11-24 22:03:15,535 _log_update: [554] (31.2 %) of epoch 8 -- lr = 2e+01, cost = 2.55, duration = 37.0 ms
2016-11-24 22:04:29,791 _log_update: [754] (42.4 %) of epoch 8 -- lr = 2e+01, cost = 2.50, duration = 37.0 ms
2016-11-24 22:05:44,015 _log_update: [954] (53.7 %) of epoch 8 -- lr = 2e+01, cost = 2.65, duration = 37.0 ms
2016-11-24 22:06:58,307 _log_update: [1154] (64.9 %) of epoch 8 -- lr = 2e+01, cost = 2.44, duration = 37.0 ms
2016-11-24 22:08:12,587 _log_update: [1354] (76.2 %) of epoch 8 -- lr = 2e+01, cost = 2.39, duration = 37.1 ms
2016-11-24 22:09:26,861 _log_update: [1554] (87.4 %) of epoch 8 -- lr = 2e+01, cost = 2.59, duration = 37.0 ms
2016-11-24 22:10:41,120 _log_update: [1754] (98.7 %) of epoch 8 -- lr = 2e+01, cost = 2.53, duration = 37.0 ms
2016-11-24 22:10:54,280 _validate: [1772] First validation sample, perplexity 183.62.
2016-11-24 22:11:14,796 _validate: [1775] Center of validation, perplexity 163.70.
2016-11-24 22:11:35,964 _validate: [1778] Last validation sample, perplexity 169.24.
2016-11-24 22:11:35,979 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-24 22:11:35,979 _log_validation: [1778] Validation set cost history: 316.2 252.9 202.0 186.7 184.5 177.4 172.4 [169.1]
2016-11-24 22:11:35,980 _reset: Generating a random order of input lines.
Finished training epoch 8 in 0 hours 11.8 minutes. Best validation perplexity 169.11.
2016-11-24 22:12:41,354 _log_update: [176] (9.9 %) of epoch 9 -- lr = 2e+01, cost = 2.68, duration = 37.0 ms
2016-11-24 22:13:55,576 _log_update: [376] (21.1 %) of epoch 9 -- lr = 2e+01, cost = 2.37, duration = 37.0 ms
2016-11-24 22:15:09,816 _log_update: [576] (32.4 %) of epoch 9 -- lr = 2e+01, cost = 2.37, duration = 37.1 ms
2016-11-24 22:16:24,072 _log_update: [776] (43.6 %) of epoch 9 -- lr = 2e+01, cost = 2.39, duration = 37.0 ms
2016-11-24 22:17:38,367 _log_update: [976] (54.9 %) of epoch 9 -- lr = 2e+01, cost = 2.50, duration = 37.1 ms
2016-11-24 22:18:52,688 _log_update: [1176] (66.1 %) of epoch 9 -- lr = 2e+01, cost = 2.41, duration = 37.0 ms
2016-11-24 22:20:06,961 _log_update: [1376] (77.4 %) of epoch 9 -- lr = 2e+01, cost = 2.57, duration = 37.0 ms
2016-11-24 22:21:21,252 _log_update: [1576] (88.6 %) of epoch 9 -- lr = 2e+01, cost = 2.42, duration = 37.1 ms
2016-11-24 22:22:40,463 _validate: [1772] First validation sample, perplexity 164.23.
2016-11-24 22:23:00,982 _validate: [1775] Center of validation, perplexity 162.66.
2016-11-24 22:23:01,381 _log_update: [1776] (99.9 %) of epoch 9 -- lr = 2e+01, cost = 2.53, duration = 37.5 ms
2016-11-24 22:23:21,555 _validate: [1778] Last validation sample, perplexity 168.72.
2016-11-24 22:23:21,570 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-24 22:23:21,570 _log_validation: [1778] Validation set cost history: 316.2 252.9 202.0 186.7 184.5 177.4 172.4 169.1 [167.9]
2016-11-24 22:23:21,571 _reset: Generating a random order of input lines.
Finished training epoch 9 in 0 hours 11.8 minutes. Best validation perplexity 167.85.
2016-11-24 22:24:35,074 _log_update: [198] (11.1 %) of epoch 10 -- lr = 2e+01, cost = 2.36, duration = 37.0 ms
2016-11-24 22:25:49,317 _log_update: [398] (22.4 %) of epoch 10 -- lr = 2e+01, cost = 2.57, duration = 37.0 ms
2016-11-24 22:27:03,567 _log_update: [598] (33.6 %) of epoch 10 -- lr = 2e+01, cost = 2.36, duration = 37.0 ms
2016-11-24 22:28:17,800 _log_update: [798] (44.9 %) of epoch 10 -- lr = 2e+01, cost = 2.55, duration = 37.0 ms
2016-11-24 22:29:32,043 _log_update: [998] (56.1 %) of epoch 10 -- lr = 2e+01, cost = 2.47, duration = 37.0 ms
2016-11-24 22:30:46,269 _log_update: [1198] (67.4 %) of epoch 10 -- lr = 2e+01, cost = 2.61, duration = 37.0 ms
2016-11-24 22:32:00,540 _log_update: [1398] (78.6 %) of epoch 10 -- lr = 2e+01, cost = 2.46, duration = 37.0 ms
2016-11-24 22:33:14,782 _log_update: [1598] (89.9 %) of epoch 10 -- lr = 2e+01, cost = 2.45, duration = 37.0 ms
2016-11-24 22:34:25,812 _validate: [1772] First validation sample, perplexity 162.54.
2016-11-24 22:34:46,327 _validate: [1775] Center of validation, perplexity 163.21.
2016-11-24 22:35:06,892 _validate: [1778] Last validation sample, perplexity 172.43.
2016-11-24 22:35:06,908 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-24 22:35:06,908 _log_validation: [1778] Validation set cost history: 316.2 252.9 202.0 186.7 184.5 177.4 172.4 169.1 167.9 [162.7]
2016-11-24 22:35:06,908 _reset: Generating a random order of input lines.
Finished training epoch 10 in 0 hours 11.8 minutes. Best validation perplexity 162.72.
2016-11-24 22:35:14,338 _log_update: [20] (1.1 %) of epoch 11 -- lr = 2e+01, cost = 2.34, duration = 37.0 ms
2016-11-24 22:36:28,586 _log_update: [220] (12.4 %) of epoch 11 -- lr = 2e+01, cost = 2.37, duration = 37.0 ms
2016-11-24 22:37:42,828 _log_update: [420] (23.6 %) of epoch 11 -- lr = 2e+01, cost = 2.43, duration = 37.0 ms
2016-11-24 22:38:57,039 _log_update: [620] (34.9 %) of epoch 11 -- lr = 2e+01, cost = 2.37, duration = 37.0 ms
2016-11-24 22:40:11,247 _log_update: [820] (46.1 %) of epoch 11 -- lr = 2e+01, cost = 2.39, duration = 37.0 ms
2016-11-24 22:41:25,508 _log_update: [1020] (57.4 %) of epoch 11 -- lr = 2e+01, cost = 2.42, duration = 37.0 ms
2016-11-24 22:42:39,790 _log_update: [1220] (68.6 %) of epoch 11 -- lr = 2e+01, cost = 2.64, duration = 37.0 ms
2016-11-24 22:43:54,075 _log_update: [1420] (79.9 %) of epoch 11 -- lr = 2e+01, cost = 2.54, duration = 37.1 ms
2016-11-24 22:45:08,490 _log_update: [1620] (91.1 %) of epoch 11 -- lr = 2e+01, cost = 2.44, duration = 37.2 ms
2016-11-24 22:46:11,729 _validate: [1772] First validation sample, perplexity 161.74.
2016-11-24 22:46:32,237 _validate: [1775] Center of validation, perplexity 177.46.
2016-11-24 22:46:52,779 _validate: [1778] Last validation sample, perplexity 171.66.
2016-11-24 22:46:52,779 _log_validation: [1778] Validation set cost history: 316.2 252.9 202.0 186.7 184.5 177.4 172.4 169.1 167.9 [162.7] 166.5
2016-11-24 22:46:52,779 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-24 22:46:52,780 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-24 22:46:52,780 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-24 22:46:52,782 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-24 22:46:52,785 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-24 22:46:52,785 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-24 22:46:52,787 _reset_state: [1775] (99.83 %) of epoch 10
2016-11-24 22:46:52,787 _log_validation: [1775] Validation set cost history: 316.2 252.9 202.0 186.7 184.5 177.4 172.4 169.1 167.9 [162.7]
2016-11-24 22:46:52,787 set_state: Restored iterator to line 42001 of 42068.
2016-11-24 22:46:52,788 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-24 22:46:52,789 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-24 22:46:52,790 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-24 22:46:52,793 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-24 22:46:52,794 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-24 22:46:52,794 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
Model performance stopped improving. Decreasing learning rate from 20.0 to 10.0 and resetting state to 100 % of epoch 10.
2016-11-24 22:46:52,795 _reset: Generating a random order of input lines.
Finished training epoch 10 in 0 hours 11.8 minutes. Best validation perplexity 162.72.
2016-11-24 22:47:08,386 _log_update: [42] (2.4 %) of epoch 11 -- lr = 1e+01, cost = 2.41, duration = 37.0 ms
2016-11-24 22:48:22,587 _log_update: [242] (13.6 %) of epoch 11 -- lr = 1e+01, cost = 2.29, duration = 37.0 ms
2016-11-24 22:49:36,774 _log_update: [442] (24.9 %) of epoch 11 -- lr = 1e+01, cost = 2.23, duration = 36.9 ms
2016-11-24 22:50:50,964 _log_update: [642] (36.1 %) of epoch 11 -- lr = 1e+01, cost = 2.30, duration = 37.0 ms
2016-11-24 22:52:05,190 _log_update: [842] (47.4 %) of epoch 11 -- lr = 1e+01, cost = 2.33, duration = 37.0 ms
2016-11-24 22:53:19,401 _log_update: [1042] (58.6 %) of epoch 11 -- lr = 1e+01, cost = 2.09, duration = 37.0 ms
2016-11-24 22:54:33,611 _log_update: [1242] (69.9 %) of epoch 11 -- lr = 1e+01, cost = 2.20, duration = 37.0 ms
2016-11-24 22:55:47,846 _log_update: [1442] (81.1 %) of epoch 11 -- lr = 1e+01, cost = 2.46, duration = 37.0 ms
2016-11-24 22:57:02,064 _log_update: [1642] (92.4 %) of epoch 11 -- lr = 1e+01, cost = 2.21, duration = 37.1 ms
2016-11-24 22:57:56,757 _validate: [1772] First validation sample, perplexity 151.20.
2016-11-24 22:58:17,264 _validate: [1775] Center of validation, perplexity 151.78.
2016-11-24 22:58:37,809 _validate: [1778] Last validation sample, perplexity 152.52.
2016-11-24 22:58:37,824 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-24 22:58:37,825 _log_validation: [1778] Validation set cost history: 316.2 252.9 202.0 186.7 184.5 177.4 172.4 169.1 167.9 162.7 [151.9]
2016-11-24 22:58:37,825 _reset: Generating a random order of input lines.
Finished training epoch 11 in 0 hours 11.8 minutes. Best validation perplexity 151.94.
2016-11-24 22:59:01,575 _log_update: [64] (3.6 %) of epoch 12 -- lr = 1e+01, cost = 2.08, duration = 37.0 ms
2016-11-24 23:00:15,759 _log_update: [264] (14.8 %) of epoch 12 -- lr = 1e+01, cost = 2.22, duration = 37.0 ms
2016-11-24 23:01:30,049 _log_update: [464] (26.1 %) of epoch 12 -- lr = 1e+01, cost = 2.28, duration = 37.1 ms
2016-11-24 23:02:44,334 _log_update: [664] (37.3 %) of epoch 12 -- lr = 1e+01, cost = 2.16, duration = 37.0 ms
2016-11-24 23:03:58,577 _log_update: [864] (48.6 %) of epoch 12 -- lr = 1e+01, cost = 2.25, duration = 37.0 ms
2016-11-24 23:05:12,838 _log_update: [1064] (59.8 %) of epoch 12 -- lr = 1e+01, cost = 2.31, duration = 37.1 ms
2016-11-24 23:06:27,104 _log_update: [1264] (71.1 %) of epoch 12 -- lr = 1e+01, cost = 2.28, duration = 37.0 ms
2016-11-24 23:07:41,379 _log_update: [1464] (82.3 %) of epoch 12 -- lr = 1e+01, cost = 2.44, duration = 37.0 ms
2016-11-24 23:08:55,645 _log_update: [1664] (93.6 %) of epoch 12 -- lr = 1e+01, cost = 2.18, duration = 37.0 ms
2016-11-24 23:09:42,228 _validate: [1772] First validation sample, perplexity 153.35.
2016-11-24 23:10:02,757 _validate: [1775] Center of validation, perplexity 152.92.
2016-11-24 23:10:23,315 _validate: [1778] Last validation sample, perplexity 152.99.
2016-11-24 23:10:23,316 _log_validation: [1778] Validation set cost history: 316.2 252.9 202.0 186.7 184.5 177.4 172.4 169.1 167.9 162.7 [151.9] 152.2
2016-11-24 23:10:23,316 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-24 23:10:23,316 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-24 23:10:23,317 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-24 23:10:23,318 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-24 23:10:23,321 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-24 23:10:23,322 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-24 23:10:23,323 _reset_state: [1775] (99.83 %) of epoch 11
2016-11-24 23:10:23,323 _log_validation: [1775] Validation set cost history: 316.2 252.9 202.0 186.7 184.5 177.4 172.4 169.1 167.9 162.7 [151.9]
2016-11-24 23:10:23,324 set_state: Restored iterator to line 41992 of 42068.
2016-11-24 23:10:23,324 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-24 23:10:23,325 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-24 23:10:23,326 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-24 23:10:23,329 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-24 23:10:23,330 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-24 23:10:23,330 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
Model performance stopped improving. Decreasing learning rate from 10.0 to 5.0 and resetting state to 100 % of epoch 11.
2016-11-24 23:10:23,331 _reset: Generating a random order of input lines.
Finished training epoch 11 in 0 hours 11.8 minutes. Best validation perplexity 151.94.
2016-11-24 23:10:55,280 _log_update: [86] (4.8 %) of epoch 12 -- lr = 5, cost = 2.24, duration = 37.0 ms
2016-11-24 23:12:09,560 _log_update: [286] (16.1 %) of epoch 12 -- lr = 5, cost = 2.28, duration = 37.1 ms
2016-11-24 23:13:23,832 _log_update: [486] (27.3 %) of epoch 12 -- lr = 5, cost = 2.16, duration = 37.1 ms
2016-11-24 23:14:38,130 _log_update: [686] (38.6 %) of epoch 12 -- lr = 5, cost = 2.23, duration = 37.1 ms
2016-11-24 23:15:52,401 _log_update: [886] (49.8 %) of epoch 12 -- lr = 5, cost = 2.25, duration = 37.0 ms
2016-11-24 23:17:06,673 _log_update: [1086] (61.1 %) of epoch 12 -- lr = 5, cost = 2.25, duration = 37.0 ms
2016-11-24 23:18:20,975 _log_update: [1286] (72.3 %) of epoch 12 -- lr = 5, cost = 2.29, duration = 37.0 ms
2016-11-24 23:19:35,306 _log_update: [1486] (83.6 %) of epoch 12 -- lr = 5, cost = 2.28, duration = 37.1 ms
2016-11-24 23:20:49,561 _log_update: [1686] (94.8 %) of epoch 12 -- lr = 5, cost = 2.23, duration = 37.0 ms
2016-11-24 23:21:28,004 _validate: [1772] First validation sample, perplexity 148.73.
2016-11-24 23:21:48,492 _validate: [1775] Center of validation, perplexity 148.50.
2016-11-24 23:22:09,036 _validate: [1778] Last validation sample, perplexity 148.42.
2016-11-24 23:22:09,051 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-24 23:22:09,051 _log_validation: [1778] Validation set cost history: 316.2 252.9 202.0 186.7 184.5 177.4 172.4 169.1 167.9 162.7 151.9 [148.4]
2016-11-24 23:22:09,052 _reset: Generating a random order of input lines.
Finished training epoch 12 in 0 hours 11.8 minutes. Best validation perplexity 148.42.
2016-11-24 23:22:49,148 _log_update: [108] (6.1 %) of epoch 13 -- lr = 5, cost = 2.20, duration = 37.0 ms
2016-11-24 23:24:03,406 _log_update: [308] (17.3 %) of epoch 13 -- lr = 5, cost = 2.17, duration = 37.0 ms
2016-11-24 23:25:17,678 _log_update: [508] (28.6 %) of epoch 13 -- lr = 5, cost = 2.20, duration = 37.1 ms
2016-11-24 23:26:31,932 _log_update: [708] (39.8 %) of epoch 13 -- lr = 5, cost = 2.17, duration = 37.0 ms
2016-11-24 23:27:46,212 _log_update: [908] (51.1 %) of epoch 13 -- lr = 5, cost = 2.22, duration = 37.0 ms
2016-11-24 23:29:00,488 _log_update: [1108] (62.3 %) of epoch 13 -- lr = 5, cost = 2.04, duration = 37.1 ms
2016-11-24 23:30:14,754 _log_update: [1308] (73.6 %) of epoch 13 -- lr = 5, cost = 2.12, duration = 37.0 ms
2016-11-24 23:31:29,042 _log_update: [1508] (84.8 %) of epoch 13 -- lr = 5, cost = 2.27, duration = 37.1 ms
2016-11-24 23:32:43,336 _log_update: [1708] (96.1 %) of epoch 13 -- lr = 5, cost = 2.18, duration = 37.1 ms
2016-11-24 23:33:13,562 _validate: [1772] First validation sample, perplexity 148.29.
2016-11-24 23:33:34,062 _validate: [1775] Center of validation, perplexity 148.47.
2016-11-24 23:33:54,602 _validate: [1778] Last validation sample, perplexity 149.81.
2016-11-24 23:33:54,603 _log_validation: [1778] Validation set cost history: 316.2 252.9 202.0 186.7 184.5 177.4 172.4 169.1 167.9 162.7 151.9 [148.4] 148.5
2016-11-24 23:33:54,603 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-24 23:33:54,603 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-24 23:33:54,604 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-24 23:33:54,605 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-24 23:33:54,608 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-24 23:33:54,609 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-24 23:33:54,610 _reset_state: [1775] (99.83 %) of epoch 12
2016-11-24 23:33:54,610 _log_validation: [1775] Validation set cost history: 316.2 252.9 202.0 186.7 184.5 177.4 172.4 169.1 167.9 162.7 151.9 [148.4]
2016-11-24 23:33:54,611 set_state: Restored iterator to line 42003 of 42068.
2016-11-24 23:33:54,611 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-24 23:33:54,612 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-24 23:33:54,613 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-24 23:33:54,616 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-24 23:33:54,617 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-24 23:33:54,617 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
Model performance stopped improving. Decreasing learning rate from 5.0 to 2.5 and resetting state to 100 % of epoch 12.
2016-11-24 23:33:54,618 _reset: Generating a random order of input lines.
Finished training epoch 12 in 0 hours 11.8 minutes. Best validation perplexity 148.42.
2016-11-24 23:34:42,857 _log_update: [130] (7.3 %) of epoch 13 -- lr = 2, cost = 2.24, duration = 37.0 ms
2016-11-24 23:35:57,098 _log_update: [330] (18.6 %) of epoch 13 -- lr = 2, cost = 2.29, duration = 37.0 ms
2016-11-24 23:37:11,348 _log_update: [530] (29.8 %) of epoch 13 -- lr = 2, cost = 2.06, duration = 37.0 ms
2016-11-24 23:38:25,575 _log_update: [730] (41.1 %) of epoch 13 -- lr = 2, cost = 2.22, duration = 37.0 ms
2016-11-24 23:39:39,847 _log_update: [930] (52.3 %) of epoch 13 -- lr = 2, cost = 2.26, duration = 37.0 ms
2016-11-24 23:40:54,142 _log_update: [1130] (63.6 %) of epoch 13 -- lr = 2, cost = 2.40, duration = 38.3 ms
2016-11-24 23:42:08,415 _log_update: [1330] (74.8 %) of epoch 13 -- lr = 2, cost = 1.97, duration = 37.0 ms
2016-11-24 23:43:22,646 _log_update: [1530] (86.1 %) of epoch 13 -- lr = 2, cost = 2.08, duration = 37.0 ms
2016-11-24 23:44:36,899 _log_update: [1730] (97.3 %) of epoch 13 -- lr = 2, cost = 2.26, duration = 37.1 ms
2016-11-24 23:44:59,020 _validate: [1772] First validation sample, perplexity 147.05.
2016-11-24 23:45:19,879 _validate: [1775] Center of validation, perplexity 147.35.
2016-11-24 23:45:40,431 _validate: [1778] Last validation sample, perplexity 147.20.
2016-11-24 23:45:40,446 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-24 23:45:40,447 _log_validation: [1778] Validation set cost history: 316.2 252.9 202.0 186.7 184.5 177.4 172.4 169.1 167.9 162.7 151.9 148.4 [147.3]
2016-11-24 23:45:40,447 _reset: Generating a random order of input lines.
Finished training epoch 13 in 0 hours 11.8 minutes. Best validation perplexity 147.28.
2016-11-24 23:46:36,938 _log_update: [152] (8.5 %) of epoch 14 -- lr = 2, cost = 2.25, duration = 37.0 ms
2016-11-24 23:47:51,205 _log_update: [352] (19.8 %) of epoch 14 -- lr = 2, cost = 2.11, duration = 37.3 ms
2016-11-24 23:49:05,448 _log_update: [552] (31.0 %) of epoch 14 -- lr = 2, cost = 2.25, duration = 37.0 ms
2016-11-24 23:50:19,686 _log_update: [752] (42.3 %) of epoch 14 -- lr = 2, cost = 2.32, duration = 37.0 ms
2016-11-24 23:51:33,980 _log_update: [952] (53.5 %) of epoch 14 -- lr = 2, cost = 2.12, duration = 37.0 ms
2016-11-24 23:52:48,236 _log_update: [1152] (64.8 %) of epoch 14 -- lr = 2, cost = 2.22, duration = 37.0 ms
2016-11-24 23:54:02,512 _log_update: [1352] (76.0 %) of epoch 14 -- lr = 2, cost = 2.20, duration = 37.0 ms
2016-11-24 23:55:16,765 _log_update: [1552] (87.3 %) of epoch 14 -- lr = 2, cost = 2.27, duration = 37.0 ms
2016-11-24 23:56:31,101 _log_update: [1752] (98.5 %) of epoch 14 -- lr = 2, cost = 2.06, duration = 37.0 ms
2016-11-24 23:56:44,980 _validate: [1772] First validation sample, perplexity 147.61.
2016-11-24 23:57:05,494 _validate: [1775] Center of validation, perplexity 147.69.
2016-11-24 23:57:26,049 _validate: [1778] Last validation sample, perplexity 147.14.
2016-11-24 23:57:26,050 _log_validation: [1778] Validation set cost history: 316.2 252.9 202.0 186.7 184.5 177.4 172.4 169.1 167.9 162.7 151.9 148.4 [147.3] 147.3
2016-11-24 23:57:26,050 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-24 23:57:26,050 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-24 23:57:26,051 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-24 23:57:26,052 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-24 23:57:26,055 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-24 23:57:26,056 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-24 23:57:26,057 _reset_state: [1775] (99.83 %) of epoch 13
2016-11-24 23:57:26,057 _log_validation: [1775] Validation set cost history: 316.2 252.9 202.0 186.7 184.5 177.4 172.4 169.1 167.9 162.7 151.9 148.4 [147.3]
2016-11-24 23:57:26,058 set_state: Restored iterator to line 42001 of 42068.
2016-11-24 23:57:26,058 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-24 23:57:26,059 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-24 23:57:26,060 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-24 23:57:26,063 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-24 23:57:26,064 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-24 23:57:26,064 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
Model performance stopped improving. Decreasing learning rate from 2.5 to 1.25 and resetting state to 100 % of epoch 13.
2016-11-24 23:57:26,065 _reset: Generating a random order of input lines.
Finished training epoch 13 in 0 hours 11.8 minutes. Best validation perplexity 147.28.
2016-11-24 23:58:30,632 _log_update: [174] (9.8 %) of epoch 14 -- lr = 1, cost = 2.23, duration = 37.0 ms
2016-11-24 23:59:44,886 _log_update: [374] (21.0 %) of epoch 14 -- lr = 1, cost = 2.15, duration = 37.0 ms
2016-11-25 00:00:59,134 _log_update: [574] (32.3 %) of epoch 14 -- lr = 1, cost = 2.32, duration = 37.0 ms
2016-11-25 00:02:13,415 _log_update: [774] (43.5 %) of epoch 14 -- lr = 1, cost = 2.23, duration = 37.1 ms
2016-11-25 00:03:27,734 _log_update: [974] (54.8 %) of epoch 14 -- lr = 1, cost = 2.10, duration = 37.0 ms
2016-11-25 00:04:42,033 _log_update: [1174] (66.0 %) of epoch 14 -- lr = 1, cost = 2.18, duration = 37.1 ms
2016-11-25 00:05:56,351 _log_update: [1374] (77.3 %) of epoch 14 -- lr = 1, cost = 2.23, duration = 37.0 ms
2016-11-25 00:07:10,619 _log_update: [1574] (88.5 %) of epoch 14 -- lr = 1, cost = 2.32, duration = 37.1 ms
2016-11-25 00:08:30,643 _validate: [1772] First validation sample, perplexity 146.69.
2016-11-25 00:08:37,850 _log_update: [1774] (99.8 %) of epoch 14 -- lr = 1, cost = 2.35, duration = 37.0 ms
2016-11-25 00:08:51,158 _validate: [1775] Center of validation, perplexity 146.47.
2016-11-25 00:09:11,738 _validate: [1778] Last validation sample, perplexity 146.69.
2016-11-25 00:09:11,753 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-25 00:09:11,753 _log_validation: [1778] Validation set cost history: 316.2 252.9 202.0 186.7 184.5 177.4 172.4 169.1 167.9 162.7 151.9 148.4 147.3 [146.6]
2016-11-25 00:09:11,754 _reset: Generating a random order of input lines.
Finished training epoch 14 in 0 hours 11.8 minutes. Best validation perplexity 146.60.
2016-11-25 00:10:24,581 _log_update: [196] (11.0 %) of epoch 15 -- lr = 1, cost = 2.09, duration = 37.1 ms
2016-11-25 00:11:38,915 _log_update: [396] (22.3 %) of epoch 15 -- lr = 1, cost = 2.20, duration = 37.0 ms
2016-11-25 00:12:53,210 _log_update: [596] (33.5 %) of epoch 15 -- lr = 1, cost = 2.14, duration = 37.0 ms
2016-11-25 00:14:07,487 _log_update: [796] (44.8 %) of epoch 15 -- lr = 1, cost = 2.09, duration = 37.0 ms
2016-11-25 00:15:21,801 _log_update: [996] (56.0 %) of epoch 15 -- lr = 1, cost = 2.26, duration = 37.0 ms
2016-11-25 00:16:36,141 _log_update: [1196] (67.3 %) of epoch 15 -- lr = 1, cost = 2.14, duration = 37.1 ms
2016-11-25 00:17:50,402 _log_update: [1396] (78.5 %) of epoch 15 -- lr = 1, cost = 2.09, duration = 37.0 ms
2016-11-25 00:19:04,718 _log_update: [1596] (89.8 %) of epoch 15 -- lr = 1, cost = 2.08, duration = 37.0 ms
2016-11-25 00:20:16,554 _validate: [1772] First validation sample, perplexity 146.60.
2016-11-25 00:20:37,051 _validate: [1775] Center of validation, perplexity 146.69.
2016-11-25 00:20:57,618 _validate: [1778] Last validation sample, perplexity 146.64.
2016-11-25 00:20:57,618 _log_validation: [1778] Validation set cost history: 316.2 252.9 202.0 186.7 184.5 177.4 172.4 169.1 167.9 162.7 151.9 148.4 147.3 [146.6] 146.7
2016-11-25 00:20:57,618 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-25 00:20:57,619 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-25 00:20:57,619 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-25 00:20:57,620 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-25 00:20:57,623 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-25 00:20:57,624 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-25 00:20:57,625 _reset_state: [1775] (99.83 %) of epoch 14
2016-11-25 00:20:57,625 _log_validation: [1775] Validation set cost history: 316.2 252.9 202.0 186.7 184.5 177.4 172.4 169.1 167.9 162.7 151.9 148.4 147.3 [146.6]
2016-11-25 00:20:57,626 set_state: Restored iterator to line 42007 of 42068.
2016-11-25 00:20:57,626 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-25 00:20:57,627 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-25 00:20:57,628 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-25 00:20:57,631 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-25 00:20:57,632 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-25 00:20:57,632 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
Model performance stopped improving. Decreasing learning rate from 1.25 to 0.625 and resetting state to 100 % of epoch 14.
2016-11-25 00:20:57,633 _reset: Generating a random order of input lines.
Finished training epoch 14 in 0 hours 11.8 minutes. Best validation perplexity 146.60.
2016-11-25 00:21:04,339 _log_update: [18] (1.0 %) of epoch 15 -- lr = 0.6, cost = 2.13, duration = 37.0 ms
2016-11-25 00:22:18,609 _log_update: [218] (12.3 %) of epoch 15 -- lr = 0.6, cost = 2.05, duration = 37.0 ms
2016-11-25 00:23:32,887 _log_update: [418] (23.5 %) of epoch 15 -- lr = 0.6, cost = 2.17, duration = 37.0 ms
2016-11-25 00:24:47,134 _log_update: [618] (34.8 %) of epoch 15 -- lr = 0.6, cost = 2.16, duration = 37.0 ms
2016-11-25 00:26:01,395 _log_update: [818] (46.0 %) of epoch 15 -- lr = 0.6, cost = 2.18, duration = 37.0 ms
2016-11-25 00:27:15,633 _log_update: [1018] (57.3 %) of epoch 15 -- lr = 0.6, cost = 2.28, duration = 37.1 ms
2016-11-25 00:28:29,903 _log_update: [1218] (68.5 %) of epoch 15 -- lr = 0.6, cost = 2.03, duration = 37.0 ms
2016-11-25 00:29:44,175 _log_update: [1418] (79.8 %) of epoch 15 -- lr = 0.6, cost = 2.17, duration = 37.0 ms
2016-11-25 00:30:58,473 _log_update: [1618] (91.0 %) of epoch 15 -- lr = 0.6, cost = 2.11, duration = 37.1 ms
2016-11-25 00:32:02,138 _validate: [1772] First validation sample, perplexity 146.62.
2016-11-25 00:32:22,642 _validate: [1775] Center of validation, perplexity 146.58.
2016-11-25 00:32:43,195 _validate: [1778] Last validation sample, perplexity 146.53.
2016-11-25 00:32:43,195 _log_validation: [1778] Validation set cost history: 316.2 252.9 202.0 186.7 184.5 177.4 172.4 169.1 167.9 162.7 151.9 148.4 147.3 [146.6] 146.6
2016-11-25 00:32:43,195 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-25 00:32:43,196 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-25 00:32:43,196 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-25 00:32:43,197 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-25 00:32:43,200 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-25 00:32:43,201 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-25 00:32:43,202 _reset_state: [1775] (99.83 %) of epoch 14
2016-11-25 00:32:43,203 _log_validation: [1775] Validation set cost history: 316.2 252.9 202.0 186.7 184.5 177.4 172.4 169.1 167.9 162.7 151.9 148.4 147.3 [146.6]
2016-11-25 00:32:43,203 set_state: Restored iterator to line 42007 of 42068.
2016-11-25 00:32:43,203 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
2016-11-25 00:32:43,205 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-25 00:32:43,205 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-25 00:32:43,208 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-25 00:32:43,209 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-25 00:32:43,209 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
Model performance stopped improving. Decreasing learning rate from 0.625 to 0.3125 and resetting state to 100 % of epoch 14.
Finished training epoch 14 in 0 hours 11.8 minutes. Best validation perplexity 146.60.
Training finished in 3 hours 55.5 minutes.
2016-11-25 00:32:43,210 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-25 00:32:43,211 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-25 00:32:43,211 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-25 00:32:43,212 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-25 00:32:43,215 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-25 00:32:43,216 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
Best validation set perplexity: 146.469791349
train finished.
Computing evaluation set perplexity.
Reading vocabulary from network state.
Number of words in vocabulary: 10001
Number of word classes: 10001
Building neural network.
Restoring neural network state.
Building text scorer.
Number of sentences: 3761
Number of words: 86191
Number of predicted probabilities: 82430
Cross entropy (base e): 4.941865082822745
Perplexity: 140.03117590056925
