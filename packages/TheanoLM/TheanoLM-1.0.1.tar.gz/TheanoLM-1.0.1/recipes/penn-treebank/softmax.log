/l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab
Reading vocabulary from /l/senarvi/theanolm-recipes/penn-treebank/nnlm.vocab.
Number of words in vocabulary: 10001
Number of word classes: 10001
2016-11-21 14:45:39,721 train: TRAINING OPTIONS
2016-11-21 14:45:39,722 train: stopping_criterion: no-improvement
2016-11-21 14:45:39,722 train: validation_frequency: 1
2016-11-21 14:45:39,722 train: min_epochs: 1
2016-11-21 14:45:39,722 train: patience: 0
2016-11-21 14:45:39,722 train: batch_size: 32
2016-11-21 14:45:39,722 train: strategy: local-mean
2016-11-21 14:45:39,722 train: sequence_length: 25
2016-11-21 14:45:39,722 train: max_epochs: 15
2016-11-21 14:45:39,722 train: max_annealing_count: 0
2016-11-21 14:45:39,722 train: OPTIMIZATION OPTIONS
2016-11-21 14:45:39,722 train: sqr_gradient_decay_rate: 0.999
2016-11-21 14:45:39,722 train: max_gradient_norm: 5.0
2016-11-21 14:45:39,722 train: weights: [ 1.]
2016-11-21 14:45:39,722 train: gradient_decay_rate: 0.9
2016-11-21 14:45:39,722 train: momentum: 0.9
2016-11-21 14:45:39,722 train: num_noise_samples: 1
2016-11-21 14:45:39,722 train: ignore_unk: False
2016-11-21 14:45:39,723 train: method: sgd
2016-11-21 14:45:39,723 train: learning_rate: 10.0
2016-11-21 14:45:39,723 train: unk_penalty: None
2016-11-21 14:45:39,723 train: cost_function: cross-entropy
2016-11-21 14:45:39,723 train: epsilon: 1e-06
Creating trainer.
Computing unigram probabilities and the number of mini-batches in training data.
2016-11-21 14:45:40,856 __init__: One epoch of training data contains 1778 mini-batch updates.
2016-11-21 14:45:40,856 __init__: Class unigram probabilities are in the range [0.000001, 0.052329].
2016-11-21 14:45:40,856 __init__: Finding sentence start positions in /teamwork/t40511_asr/c/penn-treebank-project/ptb.train.txt.
2016-11-21 14:45:40,879 _reset: Generating a random order of input lines.
Building neural network.
2016-11-21 14:45:40,886 __init__: Creating layers.
2016-11-21 14:45:40,886 __init__: - NetworkInput name=word_input inputs=[] size=10001
2016-11-21 14:45:40,886 __init__: - ProjectionLayer name=projection_layer inputs=[word_input] size=100
2016-11-21 14:45:40,924 __init__: - LSTMLayer name=hidden_layer inputs=[projection_layer] size=256
2016-11-21 14:45:41,044 __init__: - SoftmaxLayer name=output_layer inputs=[hidden_layer] size=10001
2016-11-21 14:45:41,162 __init__: Initializing parameters.
2016-11-21 14:45:41,162 __init__: - layers/projection_layer/W size=1000100 type=float32
2016-11-21 14:45:41,162 __init__: - layers/hidden_layer/layer_input/W size=102400 type=float32
2016-11-21 14:45:41,162 __init__: - layers/hidden_layer/step_input/W size=262144 type=float32
2016-11-21 14:45:41,162 __init__: - layers/hidden_layer/layer_input/b size=1024 type=float32
2016-11-21 14:45:41,162 __init__: - layers/output_layer/input/W size=2560256 type=float32
2016-11-21 14:45:41,162 __init__: - layers/output_layer/input/b size=10001 type=float32
2016-11-21 14:45:41,162 __init__: Total number of parameters: 3935925
Compiling optimization function.
Building text scorer.
Training neural network.
2016-11-21 14:46:18,561 _log_update: [200] (11.2 %) of epoch 1 -- lr = 1e+01, cost = 6.55, duration = 12.6 ms
2016-11-21 14:46:44,060 _log_update: [400] (22.5 %) of epoch 1 -- lr = 1e+01, cost = 6.58, duration = 12.7 ms
2016-11-21 14:47:09,600 _log_update: [600] (33.7 %) of epoch 1 -- lr = 1e+01, cost = 6.10, duration = 12.7 ms
2016-11-21 14:47:35,130 _log_update: [800] (45.0 %) of epoch 1 -- lr = 1e+01, cost = 6.12, duration = 12.7 ms
2016-11-21 14:48:00,693 _log_update: [1000] (56.2 %) of epoch 1 -- lr = 1e+01, cost = 6.17, duration = 12.7 ms
2016-11-21 14:48:26,244 _log_update: [1200] (67.5 %) of epoch 1 -- lr = 1e+01, cost = 5.89, duration = 12.7 ms
2016-11-21 14:48:51,822 _log_update: [1400] (78.7 %) of epoch 1 -- lr = 1e+01, cost = 5.89, duration = 12.7 ms
2016-11-21 14:49:17,398 _log_update: [1600] (90.0 %) of epoch 1 -- lr = 1e+01, cost = 5.53, duration = 12.7 ms
2016-11-21 14:49:45,618 _validate: [1769] First validation sample, perplexity 252.85.
2016-11-21 14:50:12,903 _validate: [1773] Center of validation, perplexity 257.53.
2016-11-21 14:50:47,080 _validate: [1778] Last validation sample, perplexity 255.46.
2016-11-21 14:50:47,103 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-21 14:50:47,103 _log_validation: [1778] Validation set cost history: [253.8]
2016-11-21 14:50:47,104 _reset: Generating a random order of input lines.
Finished training epoch 1 in 0 hours 4.9 minutes. Best validation perplexity 253.82.
2016-11-21 14:50:49,870 _log_update: [22] (1.2 %) of epoch 2 -- lr = 1e+01, cost = 5.60, duration = 12.5 ms
2016-11-21 14:51:14,974 _log_update: [222] (12.5 %) of epoch 2 -- lr = 1e+01, cost = 5.70, duration = 12.5 ms
2016-11-21 14:51:40,072 _log_update: [422] (23.7 %) of epoch 2 -- lr = 1e+01, cost = 5.54, duration = 12.5 ms
2016-11-21 14:52:05,176 _log_update: [622] (35.0 %) of epoch 2 -- lr = 1e+01, cost = 5.42, duration = 12.5 ms
2016-11-21 14:52:30,280 _log_update: [822] (46.2 %) of epoch 2 -- lr = 1e+01, cost = 5.47, duration = 12.5 ms
2016-11-21 14:52:55,411 _log_update: [1022] (57.5 %) of epoch 2 -- lr = 1e+01, cost = 4.98, duration = 12.5 ms
2016-11-21 14:53:20,548 _log_update: [1222] (68.7 %) of epoch 2 -- lr = 1e+01, cost = 5.48, duration = 12.5 ms
2016-11-21 14:53:45,657 _log_update: [1422] (80.0 %) of epoch 2 -- lr = 1e+01, cost = 5.27, duration = 12.5 ms
2016-11-21 14:54:10,762 _log_update: [1622] (91.2 %) of epoch 2 -- lr = 1e+01, cost = 5.25, duration = 12.5 ms
2016-11-21 14:54:35,910 _validate: [1769] First validation sample, perplexity 179.62.
2016-11-21 14:55:03,184 _validate: [1773] Center of validation, perplexity 181.23.
2016-11-21 14:55:37,323 _validate: [1778] Last validation sample, perplexity 180.32.
2016-11-21 14:55:37,340 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-21 14:55:37,341 _log_validation: [1778] Validation set cost history: 253.8 [181.5]
2016-11-21 14:55:37,341 _reset: Generating a random order of input lines.
Finished training epoch 2 in 0 hours 4.8 minutes. Best validation perplexity 181.48.
2016-11-21 14:55:42,868 _log_update: [44] (2.5 %) of epoch 3 -- lr = 1e+01, cost = 5.33, duration = 12.5 ms
2016-11-21 14:56:08,003 _log_update: [244] (13.7 %) of epoch 3 -- lr = 1e+01, cost = 4.98, duration = 12.5 ms
2016-11-21 14:56:33,122 _log_update: [444] (25.0 %) of epoch 3 -- lr = 1e+01, cost = 4.69, duration = 12.5 ms
2016-11-21 14:56:58,257 _log_update: [644] (36.2 %) of epoch 3 -- lr = 1e+01, cost = 4.72, duration = 12.5 ms
2016-11-21 14:57:23,412 _log_update: [844] (47.5 %) of epoch 3 -- lr = 1e+01, cost = 5.21, duration = 12.5 ms
2016-11-21 14:57:48,533 _log_update: [1044] (58.7 %) of epoch 3 -- lr = 1e+01, cost = 5.04, duration = 12.5 ms
2016-11-21 14:58:13,690 _log_update: [1244] (70.0 %) of epoch 3 -- lr = 1e+01, cost = 5.15, duration = 12.5 ms
2016-11-21 14:58:38,818 _log_update: [1444] (81.2 %) of epoch 3 -- lr = 1e+01, cost = 4.78, duration = 12.5 ms
2016-11-21 14:59:03,950 _log_update: [1644] (92.5 %) of epoch 3 -- lr = 1e+01, cost = 5.05, duration = 12.5 ms
2016-11-21 14:59:26,347 _validate: [1769] First validation sample, perplexity 152.32.
2016-11-21 14:59:53,610 _validate: [1773] Center of validation, perplexity 152.54.
2016-11-21 15:00:27,728 _validate: [1778] Last validation sample, perplexity 151.99.
2016-11-21 15:00:27,744 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-21 15:00:27,745 _log_validation: [1778] Validation set cost history: 253.8 181.5 [152.1]
2016-11-21 15:00:27,745 _reset: Generating a random order of input lines.
Finished training epoch 3 in 0 hours 4.8 minutes. Best validation perplexity 152.14.
2016-11-21 15:00:36,054 _log_update: [66] (3.7 %) of epoch 4 -- lr = 1e+01, cost = 4.83, duration = 12.5 ms
2016-11-21 15:01:01,220 _log_update: [266] (15.0 %) of epoch 4 -- lr = 1e+01, cost = 4.98, duration = 12.5 ms
2016-11-21 15:01:26,335 _log_update: [466] (26.2 %) of epoch 4 -- lr = 1e+01, cost = 4.98, duration = 12.5 ms
2016-11-21 15:01:51,431 _log_update: [666] (37.5 %) of epoch 4 -- lr = 1e+01, cost = 4.67, duration = 12.5 ms
2016-11-21 15:02:16,556 _log_update: [866] (48.7 %) of epoch 4 -- lr = 1e+01, cost = 4.55, duration = 12.5 ms
2016-11-21 15:02:41,691 _log_update: [1066] (60.0 %) of epoch 4 -- lr = 1e+01, cost = 4.86, duration = 13.6 ms
2016-11-21 15:03:06,877 _log_update: [1266] (71.2 %) of epoch 4 -- lr = 1e+01, cost = 4.98, duration = 12.5 ms
2016-11-21 15:03:32,020 _log_update: [1466] (82.5 %) of epoch 4 -- lr = 1e+01, cost = 4.91, duration = 12.5 ms
2016-11-21 15:03:57,152 _log_update: [1666] (93.7 %) of epoch 4 -- lr = 1e+01, cost = 5.01, duration = 12.5 ms
2016-11-21 15:04:16,780 _validate: [1769] First validation sample, perplexity 139.27.
2016-11-21 15:04:44,050 _validate: [1773] Center of validation, perplexity 139.30.
2016-11-21 15:05:18,162 _validate: [1778] Last validation sample, perplexity 138.49.
2016-11-21 15:05:18,179 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-21 15:05:18,179 _log_validation: [1778] Validation set cost history: 253.8 181.5 152.1 [138.7]
2016-11-21 15:05:18,179 _reset: Generating a random order of input lines.
Finished training epoch 4 in 0 hours 4.8 minutes. Best validation perplexity 138.71.
2016-11-21 15:05:29,246 _log_update: [88] (4.9 %) of epoch 5 -- lr = 1e+01, cost = 4.81, duration = 12.5 ms
2016-11-21 15:05:54,379 _log_update: [288] (16.2 %) of epoch 5 -- lr = 1e+01, cost = 4.66, duration = 12.5 ms
2016-11-21 15:06:19,527 _log_update: [488] (27.4 %) of epoch 5 -- lr = 1e+01, cost = 4.51, duration = 12.5 ms
2016-11-21 15:06:44,625 _log_update: [688] (38.7 %) of epoch 5 -- lr = 1e+01, cost = 4.89, duration = 12.5 ms
2016-11-21 15:07:09,724 _log_update: [888] (49.9 %) of epoch 5 -- lr = 1e+01, cost = 4.93, duration = 12.5 ms
2016-11-21 15:07:34,852 _log_update: [1088] (61.2 %) of epoch 5 -- lr = 1e+01, cost = 4.62, duration = 12.5 ms
2016-11-21 15:07:59,966 _log_update: [1288] (72.4 %) of epoch 5 -- lr = 1e+01, cost = 4.67, duration = 12.5 ms
2016-11-21 15:08:25,125 _log_update: [1488] (83.7 %) of epoch 5 -- lr = 1e+01, cost = 4.57, duration = 12.5 ms
2016-11-21 15:08:50,249 _log_update: [1688] (94.9 %) of epoch 5 -- lr = 1e+01, cost = 4.75, duration = 12.5 ms
2016-11-21 15:09:07,127 _validate: [1769] First validation sample, perplexity 133.82.
2016-11-21 15:09:34,387 _validate: [1773] Center of validation, perplexity 134.16.
2016-11-21 15:10:08,524 _validate: [1778] Last validation sample, perplexity 134.96.
2016-11-21 15:10:08,540 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-21 15:10:08,540 _log_validation: [1778] Validation set cost history: 253.8 181.5 152.1 138.7 [134.4]
2016-11-21 15:10:08,540 _reset: Generating a random order of input lines.
Finished training epoch 5 in 0 hours 4.8 minutes. Best validation perplexity 134.38.
2016-11-21 15:10:22,388 _log_update: [110] (6.2 %) of epoch 6 -- lr = 1e+01, cost = 4.43, duration = 12.5 ms
2016-11-21 15:10:47,569 _log_update: [310] (17.4 %) of epoch 6 -- lr = 1e+01, cost = 4.61, duration = 12.8 ms
2016-11-21 15:11:12,764 _log_update: [510] (28.7 %) of epoch 6 -- lr = 1e+01, cost = 4.61, duration = 12.5 ms
2016-11-21 15:11:37,935 _log_update: [710] (39.9 %) of epoch 6 -- lr = 1e+01, cost = 4.41, duration = 12.5 ms
2016-11-21 15:12:03,117 _log_update: [910] (51.2 %) of epoch 6 -- lr = 1e+01, cost = 4.41, duration = 12.5 ms
2016-11-21 15:12:28,293 _log_update: [1110] (62.4 %) of epoch 6 -- lr = 1e+01, cost = 4.32, duration = 12.5 ms
2016-11-21 15:12:53,490 _log_update: [1310] (73.7 %) of epoch 6 -- lr = 1e+01, cost = 4.10, duration = 12.5 ms
2016-11-21 15:13:18,689 _log_update: [1510] (84.9 %) of epoch 6 -- lr = 1e+01, cost = 4.46, duration = 12.5 ms
2016-11-21 15:13:43,846 _log_update: [1710] (96.2 %) of epoch 6 -- lr = 1e+01, cost = 4.28, duration = 12.5 ms
2016-11-21 15:13:57,962 _validate: [1769] First validation sample, perplexity 131.76.
2016-11-21 15:14:25,239 _validate: [1773] Center of validation, perplexity 131.75.
2016-11-21 15:14:59,342 _validate: [1778] Last validation sample, perplexity 130.82.
2016-11-21 15:14:59,358 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-21 15:14:59,358 _log_validation: [1778] Validation set cost history: 253.8 181.5 152.1 138.7 134.4 [131.2]
2016-11-21 15:14:59,359 _reset: Generating a random order of input lines.
Finished training epoch 6 in 0 hours 4.8 minutes. Best validation perplexity 131.21.
2016-11-21 15:15:16,025 _log_update: [132] (7.4 %) of epoch 7 -- lr = 1e+01, cost = 4.22, duration = 12.5 ms
2016-11-21 15:15:41,239 _log_update: [332] (18.7 %) of epoch 7 -- lr = 1e+01, cost = 4.39, duration = 12.5 ms
2016-11-21 15:16:06,513 _log_update: [532] (29.9 %) of epoch 7 -- lr = 1e+01, cost = 4.22, duration = 12.5 ms
2016-11-21 15:16:31,748 _log_update: [732] (41.2 %) of epoch 7 -- lr = 1e+01, cost = 4.21, duration = 12.5 ms
2016-11-21 15:16:56,905 _log_update: [932] (52.4 %) of epoch 7 -- lr = 1e+01, cost = 4.32, duration = 12.5 ms
2016-11-21 15:17:22,096 _log_update: [1132] (63.7 %) of epoch 7 -- lr = 1e+01, cost = 4.45, duration = 12.5 ms
2016-11-21 15:17:47,265 _log_update: [1332] (74.9 %) of epoch 7 -- lr = 1e+01, cost = 4.15, duration = 12.5 ms
2016-11-21 15:18:12,458 _log_update: [1532] (86.2 %) of epoch 7 -- lr = 1e+01, cost = 4.45, duration = 12.5 ms
2016-11-21 15:18:37,654 _log_update: [1732] (97.4 %) of epoch 7 -- lr = 1e+01, cost = 4.41, duration = 12.5 ms
2016-11-21 15:18:49,044 _validate: [1769] First validation sample, perplexity 130.58.
2016-11-21 15:19:16,336 _validate: [1773] Center of validation, perplexity 131.11.
2016-11-21 15:19:50,449 _validate: [1778] Last validation sample, perplexity 131.55.
2016-11-21 15:19:50,450 _log_validation: [1778] Validation set cost history: 253.8 181.5 152.1 138.7 134.4 [131.2] 131.5
2016-11-21 15:19:50,451 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-21 15:19:50,451 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-21 15:19:50,451 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-21 15:19:50,452 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-21 15:19:50,453 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-21 15:19:50,456 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-21 15:19:50,458 _reset_state: [1773] (99.72 %) of epoch 6
2016-11-21 15:19:50,458 _log_validation: [1773] Validation set cost history: 253.8 181.5 152.1 138.7 134.4 [131.2]
2016-11-21 15:19:50,458 set_state: Restored iterator to line 41957 of 42068.
2016-11-21 15:19:50,459 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-21 15:19:50,460 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-21 15:19:50,460 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-21 15:19:50,463 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-21 15:19:50,465 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-21 15:19:50,465 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
Model performance stopped improving. Decreasing learning rate from 10.0 to 5.0 and resetting state to 100 % of epoch 6.
2016-11-21 15:19:50,466 _reset: Generating a random order of input lines.
Finished training epoch 6 in 0 hours 4.9 minutes. Best validation perplexity 131.21.
2016-11-21 15:20:09,866 _log_update: [154] (8.7 %) of epoch 7 -- lr = 5, cost = 4.16, duration = 12.5 ms
2016-11-21 15:20:35,045 _log_update: [354] (19.9 %) of epoch 7 -- lr = 5, cost = 4.40, duration = 12.5 ms
2016-11-21 15:21:00,255 _log_update: [554] (31.2 %) of epoch 7 -- lr = 5, cost = 4.35, duration = 12.5 ms
2016-11-21 15:21:25,434 _log_update: [754] (42.4 %) of epoch 7 -- lr = 5, cost = 4.24, duration = 12.5 ms
2016-11-21 15:21:50,604 _log_update: [954] (53.7 %) of epoch 7 -- lr = 5, cost = 4.35, duration = 12.5 ms
2016-11-21 15:22:15,816 _log_update: [1154] (64.9 %) of epoch 7 -- lr = 5, cost = 4.28, duration = 12.5 ms
2016-11-21 15:22:41,002 _log_update: [1354] (76.2 %) of epoch 7 -- lr = 5, cost = 4.02, duration = 12.5 ms
2016-11-21 15:23:06,205 _log_update: [1554] (87.4 %) of epoch 7 -- lr = 5, cost = 4.60, duration = 12.5 ms
2016-11-21 15:23:31,396 _log_update: [1754] (98.7 %) of epoch 7 -- lr = 5, cost = 4.30, duration = 12.5 ms
2016-11-21 15:23:39,973 _validate: [1769] First validation sample, perplexity 127.30.
2016-11-21 15:24:07,252 _validate: [1773] Center of validation, perplexity 126.80.
2016-11-21 15:24:41,383 _validate: [1778] Last validation sample, perplexity 127.62.
2016-11-21 15:24:41,399 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-21 15:24:41,399 _log_validation: [1778] Validation set cost history: 253.8 181.5 152.1 138.7 134.4 131.2 [127.0]
2016-11-21 15:24:41,399 _reset: Generating a random order of input lines.
Finished training epoch 7 in 0 hours 4.8 minutes. Best validation perplexity 127.05.
2016-11-21 15:25:03,570 _log_update: [176] (9.9 %) of epoch 8 -- lr = 5, cost = 4.21, duration = 12.5 ms
2016-11-21 15:25:28,753 _log_update: [376] (21.1 %) of epoch 8 -- lr = 5, cost = 3.80, duration = 12.5 ms
2016-11-21 15:25:53,955 _log_update: [576] (32.4 %) of epoch 8 -- lr = 5, cost = 3.71, duration = 12.8 ms
2016-11-21 15:26:19,141 _log_update: [776] (43.6 %) of epoch 8 -- lr = 5, cost = 3.90, duration = 12.5 ms
2016-11-21 15:26:44,334 _log_update: [976] (54.9 %) of epoch 8 -- lr = 5, cost = 4.27, duration = 12.6 ms
2016-11-21 15:27:09,541 _log_update: [1176] (66.1 %) of epoch 8 -- lr = 5, cost = 4.02, duration = 12.5 ms
2016-11-21 15:27:34,752 _log_update: [1376] (77.4 %) of epoch 8 -- lr = 5, cost = 4.39, duration = 12.5 ms
2016-11-21 15:27:59,975 _log_update: [1576] (88.6 %) of epoch 8 -- lr = 5, cost = 3.94, duration = 12.5 ms
2016-11-21 15:28:31,021 _validate: [1769] First validation sample, perplexity 127.65.
2016-11-21 15:28:58,289 _validate: [1773] Center of validation, perplexity 127.94.
2016-11-21 15:29:12,086 _log_update: [1776] (99.9 %) of epoch 8 -- lr = 5, cost = 4.62, duration = 12.6 ms
2016-11-21 15:29:32,409 _validate: [1778] Last validation sample, perplexity 128.45.
2016-11-21 15:29:32,409 _log_validation: [1778] Validation set cost history: 253.8 181.5 152.1 138.7 134.4 131.2 [127.0] 127.8
2016-11-21 15:29:32,410 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-21 15:29:32,410 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-21 15:29:32,411 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-21 15:29:32,411 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-21 15:29:32,412 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-21 15:29:32,415 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-21 15:29:32,417 _reset_state: [1773] (99.72 %) of epoch 7
2016-11-21 15:29:32,417 _log_validation: [1773] Validation set cost history: 253.8 181.5 152.1 138.7 134.4 131.2 [127.0]
2016-11-21 15:29:32,418 set_state: Restored iterator to line 41956 of 42068.
2016-11-21 15:29:32,418 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-21 15:29:32,419 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-21 15:29:32,419 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-21 15:29:32,423 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-21 15:29:32,424 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-21 15:29:32,425 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
Model performance stopped improving. Decreasing learning rate from 5.0 to 2.5 and resetting state to 100 % of epoch 7.
2016-11-21 15:29:32,425 _reset: Generating a random order of input lines.
Finished training epoch 7 in 0 hours 4.9 minutes. Best validation perplexity 127.05.
2016-11-21 15:29:57,411 _log_update: [198] (11.1 %) of epoch 8 -- lr = 2, cost = 3.99, duration = 12.5 ms
2016-11-21 15:30:22,683 _log_update: [398] (22.4 %) of epoch 8 -- lr = 2, cost = 4.61, duration = 12.5 ms
2016-11-21 15:30:47,898 _log_update: [598] (33.6 %) of epoch 8 -- lr = 2, cost = 3.89, duration = 12.5 ms
2016-11-21 15:31:13,137 _log_update: [798] (44.9 %) of epoch 8 -- lr = 2, cost = 4.28, duration = 12.5 ms
2016-11-21 15:31:38,367 _log_update: [998] (56.1 %) of epoch 8 -- lr = 2, cost = 4.40, duration = 12.8 ms
2016-11-21 15:32:03,582 _log_update: [1198] (67.4 %) of epoch 8 -- lr = 2, cost = 4.35, duration = 12.5 ms
2016-11-21 15:32:28,802 _log_update: [1398] (78.6 %) of epoch 8 -- lr = 2, cost = 3.95, duration = 12.5 ms
2016-11-21 15:32:53,996 _log_update: [1598] (89.9 %) of epoch 8 -- lr = 2, cost = 4.30, duration = 12.5 ms
2016-11-21 15:33:22,185 _validate: [1769] First validation sample, perplexity 126.11.
2016-11-21 15:33:49,404 _validate: [1773] Center of validation, perplexity 126.05.
2016-11-21 15:34:23,473 _validate: [1778] Last validation sample, perplexity 125.73.
2016-11-21 15:34:23,489 _set_candidate_state: New candidate for optimal state saved to /l/senarvi/theanolm-recipes/penn-treebank/nnlm.h5.
2016-11-21 15:34:23,489 _log_validation: [1778] Validation set cost history: 253.8 181.5 152.1 138.7 134.4 131.2 127.0 [126.0]
2016-11-21 15:34:23,489 _reset: Generating a random order of input lines.
Finished training epoch 8 in 0 hours 4.9 minutes. Best validation perplexity 126.02.
2016-11-21 15:34:26,021 _log_update: [20] (1.1 %) of epoch 9 -- lr = 2, cost = 4.07, duration = 12.5 ms
2016-11-21 15:34:51,212 _log_update: [220] (12.4 %) of epoch 9 -- lr = 2, cost = 3.97, duration = 12.5 ms
2016-11-21 15:35:16,402 _log_update: [420] (23.6 %) of epoch 9 -- lr = 2, cost = 4.13, duration = 12.5 ms
2016-11-21 15:35:41,619 _log_update: [620] (34.9 %) of epoch 9 -- lr = 2, cost = 4.19, duration = 12.5 ms
2016-11-21 15:36:06,868 _log_update: [820] (46.1 %) of epoch 9 -- lr = 2, cost = 4.31, duration = 12.5 ms
2016-11-21 15:36:32,068 _log_update: [1020] (57.4 %) of epoch 9 -- lr = 2, cost = 4.05, duration = 12.5 ms
2016-11-21 15:36:57,256 _log_update: [1220] (68.6 %) of epoch 9 -- lr = 2, cost = 4.43, duration = 12.5 ms
2016-11-21 15:37:22,458 _log_update: [1420] (79.9 %) of epoch 9 -- lr = 2, cost = 4.19, duration = 12.5 ms
2016-11-21 15:37:47,642 _log_update: [1620] (91.1 %) of epoch 9 -- lr = 2, cost = 4.21, duration = 12.5 ms
2016-11-21 15:38:13,099 _validate: [1769] First validation sample, perplexity 128.52.
2016-11-21 15:38:40,320 _validate: [1773] Center of validation, perplexity 128.35.
2016-11-21 15:39:14,380 _validate: [1778] Last validation sample, perplexity 128.43.
2016-11-21 15:39:14,380 _log_validation: [1778] Validation set cost history: 253.8 181.5 152.1 138.7 134.4 131.2 127.0 [126.0] 128.4
2016-11-21 15:39:14,381 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-21 15:39:14,381 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-21 15:39:14,382 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-21 15:39:14,382 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-21 15:39:14,384 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-21 15:39:14,387 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-21 15:39:14,388 _reset_state: [1773] (99.72 %) of epoch 8
2016-11-21 15:39:14,388 _log_validation: [1773] Validation set cost history: 253.8 181.5 152.1 138.7 134.4 131.2 127.0 [126.0]
2016-11-21 15:39:14,389 set_state: Restored iterator to line 41955 of 42068.
2016-11-21 15:39:14,389 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-21 15:39:14,390 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-21 15:39:14,390 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-21 15:39:14,394 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-21 15:39:14,395 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-21 15:39:14,396 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
Model performance stopped improving. Decreasing learning rate from 2.5 to 1.25 and resetting state to 100 % of epoch 8.
2016-11-21 15:39:14,396 _reset: Generating a random order of input lines.
Finished training epoch 8 in 0 hours 4.8 minutes. Best validation perplexity 126.02.
2016-11-21 15:39:19,691 _log_update: [42] (2.4 %) of epoch 9 -- lr = 1, cost = 4.10, duration = 12.5 ms
2016-11-21 15:39:44,883 _log_update: [242] (13.6 %) of epoch 9 -- lr = 1, cost = 4.17, duration = 12.5 ms
2016-11-21 15:40:10,087 _log_update: [442] (24.9 %) of epoch 9 -- lr = 1, cost = 4.04, duration = 12.5 ms
2016-11-21 15:40:35,278 _log_update: [642] (36.1 %) of epoch 9 -- lr = 1, cost = 3.96, duration = 12.5 ms
2016-11-21 15:41:00,474 _log_update: [842] (47.4 %) of epoch 9 -- lr = 1, cost = 3.97, duration = 12.5 ms
2016-11-21 15:41:25,659 _log_update: [1042] (58.6 %) of epoch 9 -- lr = 1, cost = 3.53, duration = 12.5 ms
2016-11-21 15:41:50,840 _log_update: [1242] (69.9 %) of epoch 9 -- lr = 1, cost = 3.86, duration = 12.6 ms
2016-11-21 15:42:16,072 _log_update: [1442] (81.1 %) of epoch 9 -- lr = 1, cost = 4.27, duration = 12.5 ms
2016-11-21 15:42:41,301 _log_update: [1642] (92.4 %) of epoch 9 -- lr = 1, cost = 3.85, duration = 12.6 ms
2016-11-21 15:43:03,993 _validate: [1769] First validation sample, perplexity 127.96.
2016-11-21 15:43:31,220 _validate: [1773] Center of validation, perplexity 128.07.
2016-11-21 15:44:05,281 _validate: [1778] Last validation sample, perplexity 127.93.
2016-11-21 15:44:05,281 _log_validation: [1778] Validation set cost history: 253.8 181.5 152.1 138.7 134.4 131.2 127.0 [126.0] 128.0
2016-11-21 15:44:05,282 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-21 15:44:05,282 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-21 15:44:05,282 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-21 15:44:05,283 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-21 15:44:05,284 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-21 15:44:05,287 set_state: layers/output_layer/input/W <- array(256, 10001)
2016-11-21 15:44:05,288 _reset_state: [1773] (99.72 %) of epoch 8
2016-11-21 15:44:05,289 _log_validation: [1773] Validation set cost history: 253.8 181.5 152.1 138.7 134.4 131.2 127.0 [126.0]
2016-11-21 15:44:05,289 set_state: Restored iterator to line 41955 of 42068.
2016-11-21 15:44:05,290 set_state: layers/output_layer/input/b_gradient <- array(10001,)
2016-11-21 15:44:05,291 set_state: layers/hidden_layer/step_input/W_gradient <- array(256, 1024)
2016-11-21 15:44:05,291 set_state: layers/hidden_layer/layer_input/W_gradient <- array(100, 1024)
2016-11-21 15:44:05,294 set_state: layers/output_layer/input/W_gradient <- array(256, 10001)
2016-11-21 15:44:05,296 set_state: layers/projection_layer/W_gradient <- array(10001, 100)
2016-11-21 15:44:05,296 set_state: layers/hidden_layer/layer_input/b_gradient <- array(1024,)
Model performance stopped improving. Decreasing learning rate from 1.25 to 0.625 and resetting state to 100 % of epoch 8.
Finished training epoch 8 in 0 hours 4.8 minutes. Best validation perplexity 126.02.
Training finished in 0 hours 58.2 minutes.
2016-11-21 15:44:05,297 set_state: layers/hidden_layer/step_input/W <- array(256, 1024)
2016-11-21 15:44:05,298 set_state: layers/hidden_layer/layer_input/b <- array(1024,)
2016-11-21 15:44:05,298 set_state: layers/output_layer/input/b <- array(10001,)
2016-11-21 15:44:05,298 set_state: layers/hidden_layer/layer_input/W <- array(100, 1024)
2016-11-21 15:44:05,300 set_state: layers/projection_layer/W <- array(10001, 100)
2016-11-21 15:44:05,303 set_state: layers/output_layer/input/W <- array(256, 10001)
Best validation set perplexity: 126.054838017
train finished.
Reading vocabulary from network state.
Number of words in vocabulary: 10001
Number of word classes: 10001
Building neural network.
Restoring neural network state.
Building text scorer.
Number of sentences: 3761
Number of words: 200582
Number of predicted probabilities: 82430
Cross entropy (base e): 4.801637349958975
Perplexity: 121.70953556435126
./softmax.sh  2553.12s user 979.48s system 99% cpu 58:55.28 total
