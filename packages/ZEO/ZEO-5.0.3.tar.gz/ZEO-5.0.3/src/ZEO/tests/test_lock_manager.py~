import unittest
from zope.testing import setupstack
from ../StorageServer import LockManager

class Client:

    locked = False
    connected = True
    n_calls = 0

    def __init__(self):
        self.call_queue = []
        self.log = []

    def call_soon_threadsafe(func, *args):
        self.calls.append((func, args))

    def call_queued(self):
        while self.call_queue:
            func, args = self.call_queue.pop(0)
            func(*args)

    def lock(self):
        self.locked = True
        self.ncalls += 1

    def nolock(self):
        self.ncalls += 1

    def log(self, *a):
        self.log.append(a)

class Timer:

    timed = None

    def start(self, zs):
        self.timed(

class LockManagerTests(setupstack.TestCase):
    """Tests of the storage-server lock manager
    """

    def setUp(self):
        super(LockManagerTests, self).setUp()
        self.time_time = self.mock('time.time', return_value = 

    def test_basics(self):

        lm = LockManager
