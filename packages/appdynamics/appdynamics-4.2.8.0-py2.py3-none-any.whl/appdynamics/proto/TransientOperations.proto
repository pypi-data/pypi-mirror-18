package com.singularity.ee.dto.pb;

import "TransactionMonitor.proto";

message ClassBrowseInfo
{
    optional string name = 1;
    optional int64 nodeId = 2;
    optional bool instrumented = 3;
}

message ClassBrowseOperationResult
{
    repeated ClassBrowseInfo classesInfo = 1;
    optional bool truncated = 2 [default = false];
}

message MethodBrowseInfo
{
    optional string name = 1;
    optional string returnType = 2;
    optional int32 paramLength = 3;
    repeated string params = 4;
    optional bool instrumented = 5;
    optional bool abstractMethod = 6;
    optional bool finalMethod = 7;
    optional bool nativeMethod = 8;
    optional bool staticMethod = 9;
    optional bool synchronizedMethod = 10;
    optional bool privateMethod = 11;
    optional bool protectedMethod = 12;
    optional bool publicMethod = 13;
    optional string interceptorDescription = 14;
}

message MethodBrowseOperationResult
{
    repeated MethodBrowseInfo methodsInfo = 1;
    optional bool truncated = 2 [default = false];
}

message ClassMethodBrowserConfig
{
    optional StringMatch packageFilter = 1;
    optional string matchType = 2;
    optional string targetClassName = 3;
    optional bool methodInfoOperation = 4;
    optional bool allInstrumentedClasses = 5;
    optional string transientSessionId = 6;
    optional string transientSessionOpId = 7;
}

message EntryPointDiscoveryStackElement
{
    optional string callType = 1;
    optional string className = 2;
    optional string methodName = 3;
}

message EntryPointDiscoveryInfo
{
    optional string exitPoint = 1;
    repeated EntryPointDiscoveryStackElement stack = 2;
}

message EntryPointDiscoveryResult
{
    repeated EntryPointDiscoveryInfo entryPointsInfo = 1;
}

message ResponsePiggyBackObject
{
    repeated TransientEventData events = 1;
}

message TransientEventDataList
{
    repeated TransientEventData events = 1;
}

message TransientEventData
{
    message OperationParameter
    {
        optional ClassMethodBrowserConfig classMethodBrowserConfig = 1;
    }
    message OperationResult
    {
        optional ClassBrowseOperationResult classBrowseOperationResult = 1;
        optional MethodBrowseOperationResult methodBrowseOperationResult = 2;
        optional EntryPointDiscoveryResult entryPointDiscoveryResult = 3;
    }
    optional string sessionId = 1;
    optional string sessionType = 2;
    optional string operation = 3;
    optional int64 nodeId = 4;
    optional string opId = 5;
    optional string transientBTSessionId = 6;
    optional string transientBTSessionOperationId = 7;
    repeated OperationParameter npv = 8;
    repeated OperationResult data = 9;
}
