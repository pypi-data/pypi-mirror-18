#!/bin/bash
# Function: Auto Install OpenStack Monitor scripts.
# Author: SSCC(R&D Center,YouMingyang)
# Date: 11/15/2016
set +x

PWD=`pwd`
BASE_DIR=/usr/local/etc/zabbix_agentd.d

# mkdir
if [ ! -d $BASE_DIR ]; then
   mkdir -p $BASE_DIR
   mkdir $BASE_DIR/data
   mkdir $BASE_DIR/scripts
fi

# Copy collect python scripts and configs
cp $PWD/monitor/* $BASE_DIR/scripts

# Add UserParameter
cp openstack_userparams.conf $BASE_DIR
sed -i '$a Include=/usr/local/etc/zabbix_agentd.d/openstack_userparams.conf' /usr/local/etc/zabbix_agentd.conf

# restart zabbix_agentd
/etc/init.d/zabbix-agentd restart
#service zabbix_agent restart 
