/*!
 * Version: 1.00
 * Author: Michael JÃ¼nger
 * Website: https://michael.xn--jnger-kva.name
 * Docs: https://github.com/mhaze4/jquery-textflow
 * Repo: https://github.com/mhaze4/jquery-textflow
 * Issues: https://github.com/mhaze4/jquery-textflow/issues
*/
(function(i){var e=function(o,p){if(p){return o+Math.floor(Math.random()*(p-o))}return Math.floor(Math.random()*o)};var a=function(p,o,q){return setTimeout(p,e(o,q))};var m=function(o){var p=this;var q=o?o:p.getDefaultDirections();this.x=q[e(q.length)].x;this.y=q[e(q.length)].y};m.prototype.directions={none:{x:0,y:0},north:{x:0,y:-1},northEast:{x:1,y:-1},east:{x:1,y:0},southEast:{x:1,y:1},south:{x:0,y:1},southWest:{x:-1,y:1},west:{x:-1,y:0},northWest:{x:-1,y:-1}};m.prototype.getDefaultDirections=function(){var o=[];for(var p in self.directions){if(self.directions.hasOwnProperty(p)){o.push(self.directions[p])}}return o};var f=function(p,B,A,D,t,u,F,v,E,H){var G=this;var o=null;var C=null;var r=function(){G.rect={top:G.y-G.h,right:G.x+G.w,bottom:G.y,left:G.x}};var q=function(w){if(w<0){if(G.rect.right<0){v.removeElement(G)}}else{if(G.rect.left>v.width){v.removeElement(G)}}};var z=function(){G.ax+=G.acceleration*F.x;if(Math.abs(G.ax)<Math.abs(G.maxAx)){o=setTimeout(z,40)}else{G.ax=G.maxAx}};var s=function(){G.ax+=0.1*F.x;if(Math.abs(G.ax)>Math.abs(G.maxAx)){C=setTimeout(s,40)}else{G.ax=G.maxAx;o=null}};this.x=B;this.y=A;this.maxAx=u;this.ax=0;this.ay=0;this.text=E;this.fontSize=H;this.font=H+"pt "+p.font;this.color=p.color;this.acceleration=1/G.fontSize;this.w=D;this.h=t;this.vx=0;this.vy=0;this.rect=function(){return{top:G.y-G.fontSize,right:G.x+G.w,bottom:(G.y-G.fontSize)+G.h,left:G.x}};this.boostUp=function(w){G.ax+=(w.ax-G.ax)*(w.fontSize/G.fontSize);clearTimeout(C);clearTimeout(o);s()};this.breakDown=function(w){G.ax-=G.ax*(w.fontSize/G.fontSize);clearTimeout(o);clearTimeout(C);z()};this.start=function(){z()};this.move=function(){G.vx=G.ax;G.vy=G.ay;G.x+=G.vx;G.y+=G.vy;r();q(F.x)};r()};var n=function(t,z,v,x,q,A,p,u,o,s){var D=this;var C=null;var r=0;var w=window.innerWidth<=800?12:16;var B=window.innerWidth<=800?16:20;var y=function(){if(v.getElements().length<o){var H=e(w,B);var F=s[e(s.length)];var J;var E;var G=(e(1,10)*z.x);x.txtCtx.font=H+"pt "+t.font;J=x.txtCtx.measureText(F).width;E=z.x<0?D.width:-J;r=H;var I=new f(t,E,e(D.marginTop,D.height-D.marginBottom-D.marginTop-H),J,H,G,z,v,F,H);v.addElement(I);I.start()}C=a(y,1000,2500)};this.width=q;this.height=A;this.marginTop=p;this.marginBottom=u;this.resize=function(F,E){D.width=F;D.height=E};this.start=function(){y()};this.stop=function(){clearTimeout(C)}};var d=function(p,s,r){var v=this;var x=i("<canvas></canvas>");var u=x[0].getContext("2d");var t=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame;var q=window.cancelAnimationFrame||window.mozCancelRequestAnimationFrame||window.webkitCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame;var w=null;var o=function(){var z=r.getElements();var y,A;v.clear();for(y=0;y<z.length;y++){A=z[y];u.font=A.font;u.fillStyle=A.color;u.fillText(A.text,A.x,A.y)}w=t(o)};this.resize=function(){x.attr("width",s.width());x.attr("height",s.height());x.css({width:s.width()+"px",height:s.height()+"px"})};this.txtCtx=u;this.clear=function(){var y=u.fillStyle;u.fillStyle="rgba(255, 0, 0, 1)";u.clearRect(0,0,s.outerWidth(),s.outerHeight());u.fillStyle=y};this.size=function(){return{width:s.outerWidth(),height:s.outerHeight()}};this.start=function(){u.textAlign="start";o()};this.stop=function(){q(w);v.clear()};x.css({position:"absolute","z-index":2,background:"transparent",width:s.width()+"px",height:s.height()+"px",top:p.top,left:p.left});x.attr("width",s.width());x.attr("height",s.height());s.css("background",p.background);x.appendTo(s)};var h=function(w,q,x){var z=this;var v=null;var o=[];var r=[];var u=function(D,B){var G=[D.x,D.x+D.width,B.x,B.x+B.width];var E=[D.y,D.y+D.height,B.y,B.y+B.height];var F=function(I,H){return I-H};G.sort(F);E.sort(F);var C=G[2]-G[1];var A=E[2]-E[1];return C>A?"x":"y"};var y=function(B,A){if(B.rect.left>A.rect.right||A.rect.left>B.rect.right){return false}else{if(B.rect.top>A.rect.bottom||A.rect.top>B.rect.bottom){return false}}return true};var p=function(){for(var E=0;E<r.length-1;E++){var B=r[E];for(var C=E+1;C<r.length;C++){var A=r[C];if(y(B,A)){var F=u(B,A);if(F==="y"){var G;var D;if(w.x<0){if(B.rect.left<A.rect.left){G=B;D=A}else{G=A;D=B}G.boostUp(D);D.breakDown(G)}else{if(B.rect.right>A.rect.right){G=A;D=B}else{G=B;D=A}D.boostUp(G);G.breakDown(D)}}}}}};var s=function(){for(var A=0;A<o.length;A++){var B=o[A];B.move()}};var t=function(){s();p();v=setTimeout(t,15)};this.width=q;this.height=x;this.addElement=function(A){o.push(A);r.push(A)};this.removeElement=function(C){var B=[];var A,D;for(A=0;A<o.length;A++){D=o[A];if(D!==C){B.push(D)}}o=B;r=[];for(A=0;A<o.length;A++){D=o[A];r.push(D)}};this.getElements=function(){return r};this.resize=function(B,A){z.width=B;z.height=A};this.start=function(){t()};this.stop=function(){clearTimeout(v)}};var l=null;var j=null;var c=null;var g=false;var b=function(){if(!g){l.start();j.start();c.start();g=true}};var k=function(){if(g){l.stop();j.stop();c.stop();g=false}};i.fn.startTextFlow=function(){b()};i.fn.stopTextFlow=function(){k()};i.fn.textFlow=function(r){var p=i(this);var s=null;var q=null;var t=i.extend({width:"100%",height:"200px",top:0,left:0,maxTexts:15,marginTop:25,marginBottom:0,texts:["Add","your","own","texts","here"],color:"#000",background:"transparent",font:"sans-serif"},r);var u=i(this).attr("data-texts");var o=function(){var v=[m.prototype.directions.east,m.prototype.directions.west];p.css({width:t.width,height:t.height,top:t.top,left:t.left,position:"relative"});if(u){q=u.split(",")}else{q=t.texts}if(!(q instanceof Array)){throw Error("Texts must be an array")}s=new m(v);j=new h(s,p.outerWidth(),p.outerHeight());l=new d(t,p,j);c=new n(t,s,j,l,l.size().width,l.size().height,t.marginTop,t.marginBottom,t.maxTexts,q);p.startTextFlow()};o();i(window).resize(function(){l.resize();j.resize(p.outerWidth(),p.outerHeight());c.resize(l.size().width,l.size().height)});document.addEventListener("visibilitychange",function(){if(g){k()}else{b()}});return this}})(jQuery);