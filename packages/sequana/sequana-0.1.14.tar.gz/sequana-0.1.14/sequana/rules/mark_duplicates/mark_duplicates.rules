rule mark_duplicates:
    """ 
    Mark reads duplicated. Thus, variant caller is aware of reads duplicated.

    Required input:
        __mark_duplicates__input: bam file

    Required output:
        __mark_duplicates__output: bam file

    Contributors:
        Sequana consortium
    """
    input:
        __mark_duplicates__input
    output:
        bam = __mark_duplicates__output,
        metrics = __mark_duplicates__metrics
    log:
        out = "logs/mark_duplicates/stdout.logs",
        err = "logs/mark_duplicates/stderr.logs"
    params:
        options = config["mark_duplicates"]["options"]
    shell:
        """
        picard MarkDuplicates I={input} \
        O={output.bam} M={output.metrics} > {log.out} 2> {log.err}
        """
