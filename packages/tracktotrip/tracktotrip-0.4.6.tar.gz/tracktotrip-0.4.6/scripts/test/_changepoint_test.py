from tracktotrip.changepoint import pelt, normal_var_segment, normal_mean_segment
import numpy as np


_data = [0.0, 1.7845119598815327, 2.382123450880455, 3.8202729232715673, 3.0418365643312413, 3.40951274487647, 2.8561331108757795, 1.0899468819133762, 1.6402982124746657, 1.323426303949839, 0.7338886776782708, 1.2213800502894854, 1.6966793633178645, 1.1792203725717252, 1.0899470581010837, 1.444560000300612, 1.686961511765396, 1.3360821172152717, 1.5903967716845884, 0.870157058291928, 1.4362784825649333, 2.0437773359878513, 1.3283578459671372, 1.0697793550639627, 1.7024777603471948, 1.6403075962631128, 1.249673313493461, 1.234551855595168, 1.6690522063978523, 1.906853274558834, 1.6118227563997998, 1.444559999511057, 2.2222371874444673, 2.5937559041135527, 2.5321177511507704, 1.984089698889328, 1.9593219021080481, 2.6795272960953045, 3.2410779846404036, 3.788888782810825, 3.116185711671496, 2.3165895185862593, 1.8786008224844928, 1.3639092648615396, 1.4312700036260084, 0.6301984401370097, 1.3646275668455998, 2.623995267633135, 2.1183851623361942, 1.891027561953996, 1.0798028216983782, 1.0038292372332756, 1.5724929692874223, 1.9482052988891705, 1.7433563280980158, 1.0814902952428758, 1.4855853828420547, 1.1215054503444024, 1.5904018114967269, 2.104928409809712, 1.923910576151195, 2.193869030553018, 1.7223960608841749, 2.5985943695366083, 2.2564073780940825, 1.7050814626107444, 1.590097045659448, 0.9897407716985734, 1.4224876100917172, 1.662466410991186, 1.21696508287671, 0.8254371706513891, 0.10896611943528325, 0.7046427852743664, 1.5059555339162358, 1.6618239561795447, 2.1272449347268965, 1.903159770731909, 1.3986807716682292, 1.3049215900247502, 1.5150948770015327, 1.36922184641263, 0.9880917755142736, 1.6561926093225021, 2.5034749764094286, 3.0301911147500022, 2.669294424921936, 2.1039607668629685, 1.1272249925185291, 1.464194720485088, 2.1828305133025108, 1.9267685537486132, 1.6562298140200848, 1.7845300499534282, 1.1272253922807207, 0.8208725911235215, 1.3777787747532424, 1.78086111253253, 2.043782401072869, 1.5772633466758188, 1.7601939284883663, 1.2968801642824552, 1.9465308746107572, 1.669052284616532, 1.2253895195062912, 1.7103381545488072, 2.349804578456598, 2.202610638338477, 2.741569071844493, 2.22408972087179, 1.5453549145132028, 1.2923530132808372, 2.666263251820774, 2.631300756760187, 1.9510789772439732, 2.0059763988141284, 2.4488634240935663, 2.092143192890663, 1.62230654839104, 1.368272040165572, 0.5517706848541283, 1.2923520398892527, 1.8737496045991526, 1.474597268078928, 0.8826745746389555, 2.0257403742833913, 2.5637997256910428, 2.4709779131033818, 3.425849607811147, 3.877055162626707, 3.676326983690902, 3.2446134328333103, 2.696237064128552, 2.0059756773584736, 2.153278282745289, 1.4469816872991204, 1.435269981172988, 1.4867893671400967, 1.8573735385334873, 1.3422450430960766, 1.45635417129133, 1.6861541209391033, 1.906944459909729, 1.5614554042816557, 1.8204420437707014, 1.4045618352988563, 1.3422443732118636, 1.8852342970581726, 1.6561993996858138, 1.3975641995586707, 1.572502828996487, 1.9482215392254625, 2.0201361551014765, 1.5748122956611126, 1.8737465595498721, 2.696232340103844, 2.860416089249533, 2.106843011856103, 2.069595243217403, 1.7335853143982924, 1.780871370811082, 2.199595398854856, 2.385454304303603, 1.811723935884288, 1.9000959103994783, 1.5107877302257797, 1.4940222915288035, 2.092143916964618, 2.169833240760828, 2.7937025402653175, 2.7076620524694164, 2.166985890464308, 1.6640307619632448, 1.7808738970043274, 1.4677784479532927, 1.2169688997074048, 1.9205950908366674, 2.339950630979424, 2.3479641597039653, 2.0020373064602905, 2.1395599741927893, 2.4584314000293763, 2.4993490692859237, 2.1967380780734147, 1.9415412589983876, 2.3591374644898515, 1.9834186553811228, 3.237804695574842, 4.470662074205736, 4.424218172141812, 2.8244021870475122, 2.1995987931852703, 1.7968361244011226, 1.66679999973951, 2.5414648720518294, 2.116954925787295, 0.6174753565994803, 1.0734554809347636, 2.5746614255985567, 3.236367002949693, 3.622824553769559, 4.0491539689176, 3.369538711028058, 0.518560000006687, 1.0602740693238064, 1.6403314416007437, 1.103043055076811, 1.4429478696838784, 1.9873233887240525, 1.6149232229028496, 2.2291513311150246, 2.127234012580941, 1.6417507611381, 2.029989108884821, 2.9355578729099387, 3.749025062902302, 2.237561903730644, 1.5725160310074235, 1.8938943765096816, 1.6662653132149843, 1.1035517501043524, 0.6208062049440974, 1.4927921315025487, 1.6417517679263474, 1.4151630678112492, 1.8505656062423788, 1.4523581363199303, 1.8299830285866296, 2.3591380222695006, 2.23756198707805, 2.0397967906768053, 2.339950820307504, 1.8334800001082385, 1.4650007674544423, 2.7174819679970117, 3.2757594807746866, 3.209117009860368, 2.4296070419003297, 1.584638219640366, 1.235504293461397, 0.7952075728071104, 1.1699754196552454, 0.7834091226982421, 1.204759457137477, 0.935694724728837, 1.405324391645254, 1.4092997374355118, 1.730866805202505, 1.4984748902201006, 1.0489566435344333, 1.164037499649689, 1.7460562830898687, 2.0598449498221902, 1.8320906968163484, 1.0609809620058193, 1.2416174591292641, 0.7259571734673422, 1.1272316849692496, 1.4914777252607645, 1.684671994373522, 1.18970417071764, 1.973022902657524, 1.2271129959195481, 1.6690524019546527, 1.2268895814377467, 1.4611962973078614, 1.9581078316648324, 2.7236400460239776, 3.532079458018629, 2.7826977139249034, 1.6506934604143269, 1.4611966213812235, 1.8311742853411286, 1.404598836113849, 1.0962653844619834, 1.3913499600034605, 1.7371894967203685, 1.3891749696371138, 1.7771531312872424, 3.1481103428477994, 2.0305831492459316, 1.5760195063896787, 1.1035634095693194, 1.5353330674375736, 1.2660717891170656, 0.8516187857472364, 0.6846264830517981, 1.209154905781223, 1.2268902042409942, 0.7695826000390874, 1.2135445813559782, 1.6223469659556056, 1.3740999306924333, 0.643205246012197, 1.30496596974961, 0.1965443027888845, 0.9601280429472383, 0.6484422608768787, 0.481520000100204, 1.1145757825578861, 1.1111235982281387, 1.7808746618697926, 1.4984794669301917, 0.9721670511568536, 1.780875583264572, 1.4021079456684842, 1.6023843423280644, 2.0123007574661775, 1.8524297275877348, 2.7465010229739693, 3.5601912134534834, 1.9415502468666792, 2.7482124689904173, 2.466292332887371, 1.6662907085810388, 0.7492407688343605, 1.6584581187244245, 1.2660736739500147, 1.6392786761979394, 1.986770140838537, 2.3024281637745303, 1.7209723069036946, 1.2253897384919457, 1.691169393146262, 2.0524483764714723, 2.461064236956927, 2.5327693707879377, 1.8924179826814147, 1.8713991053590047, 1.502980018040032, 1.2660744141606768, 1.5772650380133768, 1.4471584076860042, 0.6172766077208015, 0.666719999895804, 2.6682883668643136, 2.86255956798778, 2.282446384464974, 2.3854664832216663, 1.684678738265423, 1.5029807925183924, 2.5208127556091813, 2.090172502345879, 2.0437950616429537, 1.4312801679511848, 1.6023869302243883, 0.8011934927420278, 0.66812726125826, 1.296886324381822, 1.7800318673810163, 0.7969258207486897, 1.260406778797676, 1.3446627677500893, 2.215812761630867, 2.7593326280188006, 2.6776924879756714, 2.3293172995020344, 2.3923848533731977, 1.9070269254685712, 2.1784418671660095, 1.4736116738849279, 1.175153793553502, 1.7059009685132962, 1.0401964611312848, 2.0403081060485806, 2.323878601931893, 1.758790363582038, 1.5955106845835165, 0.8681388113304292, 1.3022083809126126, 1.924478383256558, 1.9863177552286093, 2.3919052192843333, 2.192571336717989, 1.7372223379171976, 1.8237364730456307, 2.278284845692065, 2.684604199894982, 2.433558669877449, 2.7938226353924294, 2.6871797961278614, 1.8203476038583537, 1.2135650690849222, 1.3191042925346477, 1.5210372197105955, 1.494077893444924, 2.182920776112177, 2.5908406708782725, 3.2939617774214867, 2.894871942762992, 2.106936010651966, 1.5879233467339435, 0.9790720241254999, 1.5468698381263895, 1.6619080408458204, 1.1323474508463256, 0.8253628785155261, 0.9968571885483603, 1.746388925353337, 1.7478516598026228, 2.5954982444833017, 2.4054916107479465, 1.499409710667595, 1.0461177420812267, 1.588056082930846, 2.1400788622470817, 1.441449980426384, 1.3016256185139587, 1.148588724873448, 1.5391906178011365, 1.5880567888764572]

data = np.random.normal(0, 10, 100)
data = np.append(data, np.random.normal(0, 1, 100))
data=[0.204651115499319,-1.1088626762091165,10.487002980499511,-8.499622054429931,9.155861264200272,-6.876695953483733,2.2328471489267177,-1.151073370052,-8.760385910562409,-2.659243868761829,-5.597642583896762,14.859656630409972,9.184384106029608,-0.8731641663185263,-0.030149050200007015,-6.313199224388734,-5.149424688737263,14.656741740739843,11.550990583860159,5.168323734407067,16.163324245915444,-7.855465748367509,3.927589215747039,-8.180491075588716,7.126694947321894,14.280044275096317,-2.9849014865321255,-9.124943614667167,5.914714370634876,1.6457422068911873,2.2152459001556033,5.603018618173406,-10.504192425454864,-2.6966762640182367,-7.987971945528497,3.3957353825561665,-8.422934331917864,-6.460753571258097,-6.092606688124401,-6.080522106108898,23.355319267031692,-9.319796998627961,20.25495528537679,8.055962109255136,8.673741083079772,7.799678125839643,-11.656324342136948,-9.554115789291766,12.274985641600448,0.5137823167691978,-30.50143103280387,16.1819725809949,-1.0303123959499538,6.0784080422075215,1.595535052417846,10.43348917476697,4.461687190180576,-8.73002752273331,-3.1612480435503953,-19.202420743201525,-20.60873330967722,-5.7716417592396185,-3.7807111418263646,11.626497198856459,-15.777880216788072,-10.553552377171576,-18.42815827114537,0.725753757367148,12.787914537239207,11.405735632171707,-0.7185754992724886,-0.6848558987151667,4.722729127546187,-2.224534210522898,8.78920060659975,-12.995989097819402,-1.7355762398699706,3.7393142782372033,-10.954802040310472,-12.333256744391061,8.357874425683264,-6.768946239943363,-19.010976299458108,3.6768912790784123,19.023955099513717,-1.5317335877332086,2.2438738173052233,-13.858733715132223,-5.765015018246951,5.686470124235925,9.159872417512245,0.6782946028160013,1.876908562552526,-1.312170450254996,6.427109290209828,6.497141861496041,6.868436180554282,2.037361737670248,-4.702582599493622,-1.7614744963000324,-0.9394520909308819,0.02559968145996741,0.7765466756817229,0.40078032868092706,0.8154622665218532,0.630544087444717,-0.24140136926949093,0.7902348160550733,0.15776655555931135,2.018237500852695,-0.4395943001032243,0.8983575648522787,-0.8770762289503375,-0.5573344152253918,0.2785599099184186,-0.5872288557172219,-2.3682336801552664,-0.904356139448792,0.47066596376757397,-0.6504725208250023,2.563477969500439,0.40828518103244255,-1.1191171478933157,0.550098322039593,-1.2236697761524047,0.70138692125409,-0.33278009807949555,0.8220573959160465,0.7876208800773364,0.3659591695154098,0.5725598731175827,-0.5172831907988577,-0.40657236896497945,2.406875837668361,0.8894508147722919,-0.7999752373488634,0.3884113114944174,-0.46299308825889446,0.21435274413798855,-0.7265270172754789,-1.5558989571516797,-0.10528245828017137,0.29830632027240184,-0.6888757531497827,-1.2387860139432534,0.6509970954815003,1.3871607754921054,-0.06667616068023685,0.37956868077627604,0.3505438397816041,0.7286091267729085,-0.062305401692416294,0.2207291463082053,-2.5640425431326688,0.24673667541189548,-0.8171938348563004,-0.11063662287616081,-0.5944709172789162,1.0101122765643575,0.8306612458682768,0.29178923169675275,0.8664656656238306,-0.11196676953259015,0.04433777515537973,-1.6865258844536641,-0.9747420571936366,-1.3961955731419824,-1.3436317804987077,0.8481292827686215,-0.12704024823589283,-1.8228802893777207,-0.7193598032102642,-0.09091160150037902,-0.8597525675876828,-0.5007660885247058,0.35461811282115724,0.22005742023107266,0.6810144461847393,0.12925408694973678,-0.8894501758840323,-0.21101161281952638,1.3270793844372109,-1.4749157548896734,-2.1956708385462473,0.6014479226876183,-0.6630018049019374,0.19496052284774348,-1.4917294518608113,-0.5352315974034294,0.7102703638745649,-1.9747581260852494,0.1375417838808715,-0.6764224697163361,-0.3857144298266294,-0.17503805906844733,1.2184165283583521,1.2134607491986535,-1.1874733355294849,0.21288928623950537,-0.052837841876365754]
result = pelt(normal_var_segment(_data, np.mean(_data)), len(_data))
import matplotlib.pyplot as plt
plt.plot(_data)
print(len(_data), result)
for r in result:
    plt.axvline(r, color='r')
plt.show()


# from changepoint.rchangepoint import estimate_cp
# model = MeanShiftModel()
# stats_ts, pvals, nums = model.detect_mean_shift(data, B=1000)
# print(len(data), len(nums))
# print(estimate_cp(data))

