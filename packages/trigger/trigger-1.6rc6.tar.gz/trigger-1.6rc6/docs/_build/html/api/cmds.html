

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>trigger.cmds — Command execution library &mdash; Trigger 1.6.rc4 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Trigger 1.6.rc4 documentation" href="../index.html"/>
        <link rel="up" title="API Documentation" href="index.html"/>
        <link rel="next" title="trigger.conf — Configuration &amp; Settings module" href="conf.html"/>
        <link rel="prev" title="trigger.changemgmt — Change management library" href="changemgmt.html"/>
 
<style type="text/css">
    span.changelog-support {color: #4070A0;}
    span.changelog-bug {color: #A04040;}
    span.changelog-feature {color: #40A056;}
    a.changelog-release {font-weight: bold;}
</style>


  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Trigger
          

          
          </a>

          
            
            
              <div class="version">
                1.6.rc4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../platforms.html">Supported Platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/index.html">Usage Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Usage Examples</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API Documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="acl.html"><code class="docutils literal"><span class="pre">trigger.acl</span></code> &#8212; ACL parsing library</a></li>
<li class="toctree-l2"><a class="reference internal" href="changemgmt.html"><code class="docutils literal"><span class="pre">trigger.changemgmt</span></code> &#8212; Change management library</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#"><code class="docutils literal"><span class="pre">trigger.cmds</span></code> &#8212; Command execution library</a></li>
<li class="toctree-l2"><a class="reference internal" href="conf.html"><code class="docutils literal"><span class="pre">trigger.conf</span></code> &#8212; Configuration &amp; Settings module</a></li>
<li class="toctree-l2"><a class="reference internal" href="contrib.html"><code class="docutils literal"><span class="pre">trigger.contrib</span></code> &#8212; Extra, optional tools that solve common problems, extend, or modify core functionality.</a></li>
<li class="toctree-l2"><a class="reference internal" href="exceptions.html"><code class="docutils literal"><span class="pre">trigger.exceptions</span></code> &#8212; Trigger&#8217;s Exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="gorc.html"><code class="docutils literal"><span class="pre">trigger.gorc</span></code> &#8212; Determine commands to run upon login</a></li>
<li class="toctree-l2"><a class="reference internal" href="netdevices.html"><code class="docutils literal"><span class="pre">trigger.netdevices</span></code> &#8212; Network device metadata library</a></li>
<li class="toctree-l2"><a class="reference internal" href="netscreen.html"><code class="docutils literal"><span class="pre">trigger.netscreen</span></code> &#8212; Juniper NetScreen firewall parser</a></li>
<li class="toctree-l2"><a class="reference internal" href="rancid.html"><code class="docutils literal"><span class="pre">trigger.rancid</span></code> &#8212; RANCID Compatibility Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="tacacsrc.html"><code class="docutils literal"><span class="pre">trigger.tacacsrc</span></code> &#8212; Network credentials library</a></li>
<li class="toctree-l2"><a class="reference internal" href="twister.html"><code class="docutils literal"><span class="pre">trigger.twister</span></code> &#8212; Asynchronous device interaction library</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html"><code class="docutils literal"><span class="pre">trigger.utils</span></code> &#8212; CLI tools and utilities library</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support.html">Getting Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../experimental.html">Experimental</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Trigger</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">API Documentation</a> &raquo;</li>
      
    <li><code class="docutils literal"><span class="pre">trigger.cmds</span></code> &#8212; Command execution library</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/api/cmds.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-trigger.cmds">
<span id="trigger-cmds-command-execution-library"></span><h1><a class="reference internal" href="#module-trigger.cmds" title="trigger.cmds"><code class="xref py py-mod docutils literal"><span class="pre">trigger.cmds</span></code></a> &#8212; Command execution library<a class="headerlink" href="#module-trigger.cmds" title="Permalink to this headline">¶</a></h1>
<p>This module abstracts the asynchronous execution of commands on multiple
network devices. It allows for integrated parsing and event-handling of return
data for rapid integration to existing or newly-created tools.</p>
<p>The <a class="reference internal" href="#trigger.cmds.Commando" title="trigger.cmds.Commando"><code class="xref py py-obj docutils literal"><span class="pre">Commando</span></code></a> class is designed to be extended but can still be
used as-is to execute commands and return the results as-is.</p>
<dl class="class">
<dt id="trigger.cmds.Commando">
<em class="property">class </em><code class="descclassname">trigger.cmds.</code><code class="descname">Commando</code><span class="sig-paren">(</span><em>devices=None</em>, <em>commands=None</em>, <em>creds=None</em>, <em>incremental=None</em>, <em>max_conns=10</em>, <em>verbose=False</em>, <em>timeout=30</em>, <em>production_only=True</em>, <em>allow_fallback=True</em>, <em>with_errors=True</em>, <em>force_cli=False</em>, <em>with_acls=False</em>, <em>command_interval=0</em>, <em>stop_reactor=True</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.Commando" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute commands asynchronously on multiple network devices.</p>
<p>This class is designed to be extended but can still be used as-is to execute
commands and return the results as-is.</p>
<p>At the bare minimum you must specify a list of <code class="docutils literal"><span class="pre">devices</span></code> to interact with.
You may optionally specify a list of <code class="docutils literal"><span class="pre">commands</span></code> to execute on those
devices, but doing so will execute the same commands on every device
regardless of platform.</p>
<p>If <code class="docutils literal"><span class="pre">commands</span></code> are not specified, they will be expected to be emitted by
the <code class="docutils literal"><span class="pre">generate</span></code> method for a given platform. Otherwise no commands will be
executed.</p>
<p>If you wish to customize the commands executed by device, you must define a
<code class="docutils literal"><span class="pre">to_{vendor_name}</span></code> method containing your custom logic.</p>
<p>If you wish to customize what is done with command results returned from a
device, you must define a <code class="docutils literal"><span class="pre">from_{vendor_name}</span></code> method containing your
custom logic.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>devices</strong> &#8211; A list of device hostnames or <a class="reference internal" href="netdevices.html#trigger.netdevices.NetDevice" title="trigger.netdevices.NetDevice"><code class="xref py py-obj docutils literal"><span class="pre">NetDevice</span></code></a> objects</li>
<li><strong>commands</strong> &#8211; (Optional) A list of commands to execute on the <code class="docutils literal"><span class="pre">devices</span></code>.</li>
<li><strong>creds</strong> &#8211; (Optional) A 3-tuple of (username, password, realm). If only (username,
password) are provided, realm will be populated from
<a class="reference internal" href="../configuration.html#std:setting-DEFAULT_REALM"><code class="xref std std-setting docutils literal"><span class="pre">DEFAULT_REALM</span></code></a>. If unset it will fetch from <code class="docutils literal"><span class="pre">.tacacsrc</span></code>.</li>
<li><strong>incremental</strong> &#8211; (Optional) A callback that will be called with an empty sequence upon
connection and then called every time a result comes back from the
device, with the list of all results.</li>
<li><strong>max_conns</strong> &#8211; (Optional) The maximum number of simultaneous connections to keep open.</li>
<li><strong>verbose</strong> &#8211; (Optional) Whether or not to display informational messages to the
console.</li>
<li><strong>timeout</strong> &#8211; (Optional) Time in seconds to wait for each command executed to return a
result. Set to <code class="docutils literal"><span class="pre">None</span></code> to disable timeout (not recommended).</li>
<li><strong>production_only</strong> &#8211; (Optional) If set, includes all devices instead of excluding any devices
where <code class="docutils literal"><span class="pre">adminStatus</span></code> is not set to <code class="docutils literal"><span class="pre">PRODUCTION</span></code>.</li>
<li><strong>allow_fallback</strong> &#8211; If set (default), allow fallback to base parse/generate methods when
they are not customized in a subclass, otherwise an exception is raised
when a method is called that has not been explicitly defined.</li>
<li><strong>with_errors</strong> &#8211; (Optional) Return exceptions as results instead of raising them. The
default is to always return them.</li>
<li><strong>force_cli</strong> &#8211; (Optional) Juniper only. If set, sends commands using CLI instead of
Junoscript.</li>
<li><strong>with_acls</strong> &#8211; Whether to load ACL associations (requires Redis). Defaults to whatever
is specified in settings.WITH_ACLS</li>
<li><strong>command_interval</strong> &#8211; (Optional) Amount of time in seconds to wait between sending commands.</li>
<li><strong>stop_reactor</strong> &#8211; Whether to stop the reactor loop when all results have returned.
(Default: <code class="docutils literal"><span class="pre">True</span></code>)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="trigger.cmds.Commando.append_parsed_results">
<code class="descname">append_parsed_results</code><span class="sig-paren">(</span><em>device</em>, <em>results</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.Commando.append_parsed_results" title="Permalink to this definition">¶</a></dt>
<dd><p>A simple method for appending results called by template parser
method.</p>
<p>If you want to customize the default method for storing parsed
results, overload this in your subclass.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>device</strong> &#8211; A <a class="reference internal" href="netdevices.html#trigger.netdevices.NetDevice" title="trigger.netdevices.NetDevice"><code class="xref py py-obj docutils literal"><span class="pre">NetDevice</span></code></a> object</li>
<li><strong>results</strong> &#8211; The results to store. Anything you want really.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.cmds.Commando.errback">
<code class="descname">errback</code><span class="sig-paren">(</span><em>failure</em>, <em>device</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.Commando.errback" title="Permalink to this definition">¶</a></dt>
<dd><p>The default errback. Overload for custom behavior but make sure it
always decrements the connections.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>failure</strong> &#8211; Usually a Twisted <code class="docutils literal"><span class="pre">Failure</span></code> instance.</li>
<li><strong>device</strong> &#8211; A <a class="reference internal" href="netdevices.html#trigger.netdevices.NetDevice" title="trigger.netdevices.NetDevice"><code class="xref py py-obj docutils literal"><span class="pre">NetDevice</span></code></a> object</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.cmds.Commando.generate">
<code class="descname">generate</code><span class="sig-paren">(</span><em>device</em>, <em>commands=None</em>, <em>extra=None</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.Commando.generate" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate commands to be run on a device. If you don&#8217;t provide
<code class="docutils literal"><span class="pre">commands</span></code> to the class constructor, this will return an empty list.</p>
<p>Define a &#8216;to_{vendor_name}&#8217; method to customize the behavior for each
platform.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>device</strong> (<a class="reference internal" href="netdevices.html#trigger.netdevices.NetDevice" title="trigger.netdevices.NetDevice"><code class="xref py py-obj docutils literal"><span class="pre">NetDevice</span></code></a>) &#8211; NetDevice object</li>
<li><strong>commands</strong> (<a class="reference internal" href="acl.html#trigger.acl.queue.Queue.list" title="trigger.acl.queue.Queue.list"><em>list</em></a>) &#8211; (Optional) A list of commands to execute on the device. If not
specified in they will be inherited from commands passed to the
class constructor.</li>
<li><strong>extra</strong> &#8211; (Optional) A dictionary of extra data to send to the generate
method for the device.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.cmds.Commando.map_parsed_results">
<code class="descname">map_parsed_results</code><span class="sig-paren">(</span><em>command=None</em>, <em>fsm=None</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.Commando.map_parsed_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dict of <code class="docutils literal"><span class="pre">{command:</span> <span class="pre">fsm,</span> <span class="pre">...}</span></code></p>
</dd></dl>

<dl class="method">
<dt id="trigger.cmds.Commando.map_results">
<code class="descname">map_results</code><span class="sig-paren">(</span><em>commands=None</em>, <em>results=None</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.Commando.map_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dict of <code class="docutils literal"><span class="pre">{command:</span> <span class="pre">result,</span> <span class="pre">...}</span></code></p>
</dd></dl>

<dl class="method">
<dt id="trigger.cmds.Commando.parse">
<code class="descname">parse</code><span class="sig-paren">(</span><em>results</em>, <em>device</em>, <em>commands=None</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.Commando.parse" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse output from a device. Calls to <code class="docutils literal"><span class="pre">self._lookup_method</span></code> to find
specific <code class="docutils literal"><span class="pre">from</span></code> method.</p>
<p>Define a &#8216;from_{vendor_name}&#8217; method to customize the behavior for each
platform.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>results</strong> (<a class="reference internal" href="acl.html#trigger.acl.queue.Queue.list" title="trigger.acl.queue.Queue.list"><em>list</em></a>) &#8211; The results of the commands executed on the device</li>
<li><strong>device</strong> (<a class="reference internal" href="netdevices.html#trigger.netdevices.NetDevice" title="trigger.netdevices.NetDevice"><code class="xref py py-obj docutils literal"><span class="pre">NetDevice</span></code></a>) &#8211; Device object</li>
<li><strong>commands</strong> (<a class="reference internal" href="acl.html#trigger.acl.queue.Queue.list" title="trigger.acl.queue.Queue.list"><em>list</em></a>) &#8211; (Optional) A list of commands to execute on the device. If not
specified in they will be inherited from commands passed to the
class constructor.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.cmds.Commando.parse_template">
<code class="descname">parse_template</code><span class="sig-paren">(</span><em>results</em>, <em>device</em>, <em>commands=None</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.Commando.parse_template" title="Permalink to this definition">¶</a></dt>
<dd><p>Generator function that processes unstructured CLI data and yields either
a TextFSM based object or generic raw output.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>results</strong> (<em>str</em>) &#8211; The unstructured &#8220;raw&#8221; CLI data from device.</li>
<li><strong>device</strong> (<a class="reference internal" href="netdevices.html#trigger.netdevices.NetDevice" title="trigger.netdevices.NetDevice"><code class="xref py py-obj docutils literal"><span class="pre">NetDevice</span></code></a>) &#8211; NetDevice object</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="trigger.cmds.Commando.reactor_running">
<code class="descname">reactor_running</code><a class="headerlink" href="#trigger.cmds.Commando.reactor_running" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether reactor event loop is running or not</p>
</dd></dl>

<dl class="method">
<dt id="trigger.cmds.Commando.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.Commando.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Nothing happens until you execute this to perform the actual work.</p>
</dd></dl>

<dl class="method">
<dt id="trigger.cmds.Commando.select_next_device">
<code class="descname">select_next_device</code><span class="sig-paren">(</span><em>jobs=None</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.Commando.select_next_device" title="Permalink to this definition">¶</a></dt>
<dd><p>Select another device for the active queue.</p>
<p>Currently only returns the next device in the job queue. This is
abstracted out so that this behavior may be customized, such as for
future support for incremental callbacks.</p>
<p>If a device is determined to be invalid, you must return <code class="docutils literal"><span class="pre">None</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>jobs</strong> &#8211; (Optional) The jobs queue. If not set, uses <code class="docutils literal"><span class="pre">self.jobs</span></code>.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A <a class="reference internal" href="netdevices.html#trigger.netdevices.NetDevice" title="trigger.netdevices.NetDevice"><code class="xref py py-obj docutils literal"><span class="pre">NetDevice</span></code></a> object or <code class="docutils literal"><span class="pre">None</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.cmds.Commando.store_error">
<code class="descname">store_error</code><span class="sig-paren">(</span><em>device</em>, <em>error</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.Commando.store_error" title="Permalink to this definition">¶</a></dt>
<dd><p>A simple method for storing an error called by all default
parse/generate methods.</p>
<p>If you want to customize the default method for storing results,
overload this in your subclass.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>device</strong> &#8211; A <a class="reference internal" href="netdevices.html#trigger.netdevices.NetDevice" title="trigger.netdevices.NetDevice"><code class="xref py py-obj docutils literal"><span class="pre">NetDevice</span></code></a> object</li>
<li><strong>error</strong> &#8211; The error to store. Anything you want really, but usually a Twisted
<code class="docutils literal"><span class="pre">Failure</span></code> instance.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.cmds.Commando.store_results">
<code class="descname">store_results</code><span class="sig-paren">(</span><em>device</em>, <em>results</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.Commando.store_results" title="Permalink to this definition">¶</a></dt>
<dd><p>A simple method for storing results called by all default
parse/generate methods.</p>
<p>If you want to customize the default method for storing results,
overload this in your subclass.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>device</strong> &#8211; A <a class="reference internal" href="netdevices.html#trigger.netdevices.NetDevice" title="trigger.netdevices.NetDevice"><code class="xref py py-obj docutils literal"><span class="pre">NetDevice</span></code></a> object</li>
<li><strong>results</strong> &#8211; The results to store. Anything you want really.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="trigger.cmds.Commando.to_juniper">
<code class="descname">to_juniper</code><span class="sig-paren">(</span><em>device</em>, <em>commands=None</em>, <em>extra=None</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.Commando.to_juniper" title="Permalink to this definition">¶</a></dt>
<dd><p>This just creates a series of <code class="docutils literal"><span class="pre">&lt;command&gt;foo&lt;/command&gt;</span></code> elements to
pass along to execute_junoscript()</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="trigger.cmds.ReactorlessCommando">
<em class="property">class </em><code class="descclassname">trigger.cmds.</code><code class="descname">ReactorlessCommando</code><span class="sig-paren">(</span><em>devices=None</em>, <em>commands=None</em>, <em>creds=None</em>, <em>incremental=None</em>, <em>max_conns=10</em>, <em>verbose=False</em>, <em>timeout=30</em>, <em>production_only=True</em>, <em>allow_fallback=True</em>, <em>with_errors=True</em>, <em>force_cli=False</em>, <em>with_acls=False</em>, <em>command_interval=0</em>, <em>stop_reactor=True</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.ReactorlessCommando" title="Permalink to this definition">¶</a></dt>
<dd><p>A reactor-less Commando subclass.</p>
<p>This allows multiple instances to coexist, with the side-effect that you
have to manage the reactor start/stop manually.</p>
<p>An example of how this could be used:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">twisted.internet</span> <span class="k">import</span> <span class="n">defer</span><span class="p">,</span> <span class="n">reactor</span>

<span class="n">devices</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dev1&#39;</span><span class="p">,</span> <span class="s1">&#39;dev2&#39;</span><span class="p">]</span>

<span class="c1"># Our Commando instances. This is an example  to show we have two instances</span>
<span class="c1"># co-existing under the same reactor.</span>
<span class="n">c1</span> <span class="o">=</span> <span class="n">ShowClock</span><span class="p">(</span><span class="n">devices</span><span class="p">)</span>
<span class="n">c2</span> <span class="o">=</span> <span class="n">ShowUsers</span><span class="p">(</span><span class="n">devices</span><span class="p">)</span>
<span class="n">instances</span> <span class="o">=</span> <span class="p">[</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">]</span>

<span class="c1"># Call the run method for each instance to get a list of Deferred task objects.</span>
<span class="n">deferreds</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">instances</span><span class="p">:</span>
    <span class="n">deferreds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">run</span><span class="p">())</span>

<span class="c1"># Here we use a DeferredList to track a list of Deferred tasks that only</span>
<span class="c1"># returns once they&#39;ve all completed.</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">defer</span><span class="o">.</span><span class="n">DeferredList</span><span class="p">(</span><span class="n">deferreds</span><span class="p">)</span>

<span class="c1"># Once every task has returned a result, stop the reactor</span>
<span class="n">d</span><span class="o">.</span><span class="n">addBoth</span><span class="p">(</span><span class="k">lambda</span> <span class="n">_</span><span class="p">:</span> <span class="n">reactor</span><span class="o">.</span><span class="n">stop</span><span class="p">())</span>

<span class="c1"># And... finally, start the reactor to kick things off.</span>
<span class="n">reactor</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>

<span class="c1"># Inspect your results</span>
<span class="nb">print</span> <span class="n">d</span><span class="o">.</span><span class="n">result</span>
</pre></div>
</div>
<dl class="method">
<dt id="trigger.cmds.ReactorlessCommando.monitor_result">
<code class="descname">monitor_result</code><span class="sig-paren">(</span><em>result</em>, <em>reactor</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.ReactorlessCommando.monitor_result" title="Permalink to this definition">¶</a></dt>
<dd><p>Loop periodically or until the factory stops to check if we&#8217;re
<code class="docutils literal"><span class="pre">all_done</span></code> and then return the results.</p>
</dd></dl>

<dl class="method">
<dt id="trigger.cmds.ReactorlessCommando.run">
<code class="descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.ReactorlessCommando.run" title="Permalink to this definition">¶</a></dt>
<dd><p>We&#8217;ve overloaded the run method to return a Deferred task object.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="trigger.cmds.NetACLInfo">
<em class="property">class </em><code class="descclassname">trigger.cmds.</code><code class="descname">NetACLInfo</code><span class="sig-paren">(</span><em>**args</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.NetACLInfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Class to fetch and parse interface information. Exposes a config
attribute which is a dictionary of devices passed to the constructor and
their interface information.</p>
<p>Each device is a dictionary of interfaces. Each interface field will
default to an empty list if not populated after parsing.  Below is a
skeleton of the basic config, with expected fields:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">config</span> <span class="p">{</span>
    <span class="s1">&#39;device1&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;interface1&#39;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s1">&#39;acl_in&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;acl_out&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;addr&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="p">[],</span>
            <span class="s1">&#39;subnets&#39;</span><span class="p">:</span> <span class="p">[],</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Interface field descriptions:</p>
<blockquote>
<div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">addr:</th><td class="field-body">List of <code class="docutils literal"><span class="pre">IPy.IP</span></code> objects of interface addresses</td>
</tr>
<tr class="field-even field"><th class="field-name">acl_in:</th><td class="field-body">List of inbound ACL names</td>
</tr>
<tr class="field-odd field"><th class="field-name">acl_out:</th><td class="field-body">List of outbound ACL names</td>
</tr>
<tr class="field-even field"><th class="field-name">description:</th><td class="field-body">List of interface description(s)</td>
</tr>
<tr class="field-odd field"><th class="field-name">subnets:</th><td class="field-body">List of <code class="docutils literal"><span class="pre">IPy.IP</span></code> objects of interface networks/CIDRs</td>
</tr>
</tbody>
</table>
</div></blockquote>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">NetACLInfo</span><span class="p">(</span><span class="n">devices</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;jm10-cc101-lab.lab.aol.net&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="go">Fetching jm10-cc101-lab.lab.aol.net</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[&lt;NetDevice: jm10-cc101-lab.lab.aol.net&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dev</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="n">dev</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[&#39;lo0.0&#39;, &#39;ge-0/0/0.0&#39;, &#39;ge-0/2/0.0&#39;, &#39;ge-0/1/0.0&#39;, &#39;fxp0.0&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="n">dev</span><span class="p">][</span><span class="s1">&#39;lo0.0&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
<span class="go">[&#39;acl_in&#39;, &#39;subnets&#39;, &#39;addr&#39;, &#39;acl_out&#39;, &#39;description&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lo0</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="n">dev</span><span class="p">][</span><span class="s1">&#39;lo0.0&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lo0</span><span class="p">[</span><span class="s1">&#39;acl_in&#39;</span><span class="p">];</span> <span class="n">lo0</span><span class="p">[</span><span class="s1">&#39;addr&#39;</span><span class="p">]</span>
<span class="go">[&#39;abc123&#39;]</span>
<span class="go">[IP(&#39;66.185.128.160&#39;)]</span>
</pre></div>
</div>
<p>This accepts all arguments from the <a class="reference internal" href="#trigger.cmds.Commando" title="trigger.cmds.Commando"><code class="xref py py-obj docutils literal"><span class="pre">Commando</span></code></a> parent class,
as well as this one extra:</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>skip_disabled</strong> &#8211; Whether to include interface names without any information. (Default:
<code class="docutils literal"><span class="pre">True</span></code>)</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="trigger.cmds.NetACLInfo.IPhost">
<code class="descname">IPhost</code><span class="sig-paren">(</span><em>addr</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.NetACLInfo.IPhost" title="Permalink to this definition">¶</a></dt>
<dd><p>Given &#8216;172.20.1.4/24&#8217;, return IP(&#8216;172.20.1.4/32&#8217;).</p>
</dd></dl>

<dl class="method">
<dt id="trigger.cmds.NetACLInfo.IPsubnet">
<code class="descname">IPsubnet</code><span class="sig-paren">(</span><em>addr</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.NetACLInfo.IPsubnet" title="Permalink to this definition">¶</a></dt>
<dd><p>Given &#8216;172.20.1.4/24&#8217;, return IP(&#8216;172.20.1.0/24&#8217;).</p>
</dd></dl>

<dl class="method">
<dt id="trigger.cmds.NetACLInfo.from_arista">
<code class="descname">from_arista</code><span class="sig-paren">(</span><em>data</em>, <em>device</em>, <em>commands=None</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.NetACLInfo.from_arista" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse IOS config based on EBNF grammar</p>
</dd></dl>

<dl class="method">
<dt id="trigger.cmds.NetACLInfo.from_brocade">
<code class="descname">from_brocade</code><span class="sig-paren">(</span><em>data</em>, <em>device</em>, <em>commands=None</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.NetACLInfo.from_brocade" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse IOS config based on EBNF grammar</p>
</dd></dl>

<dl class="method">
<dt id="trigger.cmds.NetACLInfo.from_cisco">
<code class="descname">from_cisco</code><span class="sig-paren">(</span><em>data</em>, <em>device</em>, <em>commands=None</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.NetACLInfo.from_cisco" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse IOS config based on EBNF grammar</p>
</dd></dl>

<dl class="method">
<dt id="trigger.cmds.NetACLInfo.from_force10">
<code class="descname">from_force10</code><span class="sig-paren">(</span><em>data</em>, <em>device</em>, <em>commands=None</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.NetACLInfo.from_force10" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse IOS config based on EBNF grammar</p>
</dd></dl>

<dl class="method">
<dt id="trigger.cmds.NetACLInfo.from_foundry">
<code class="descname">from_foundry</code><span class="sig-paren">(</span><em>data</em>, <em>device</em>, <em>commands=None</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.NetACLInfo.from_foundry" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse IOS config based on EBNF grammar</p>
</dd></dl>

<dl class="method">
<dt id="trigger.cmds.NetACLInfo.from_juniper">
<code class="descname">from_juniper</code><span class="sig-paren">(</span><em>data</em>, <em>device</em>, <em>commands=None</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.NetACLInfo.from_juniper" title="Permalink to this definition">¶</a></dt>
<dd><p>Do all the magic to parse Junos interfaces</p>
</dd></dl>

<dl class="method">
<dt id="trigger.cmds.NetACLInfo.to_arista">
<code class="descname">to_arista</code><span class="sig-paren">(</span><em>dev</em>, <em>commands=None</em>, <em>extra=None</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.NetACLInfo.to_arista" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to IOS, but:</p>
<blockquote>
<div><ul class="simple">
<li>Arista has no &#8220;show conf&#8221; so we have to do &#8220;show run&#8221;</li>
<li>The regex used in the CLI for Arista is more &#8220;precise&#8221; so we have
to change the pattern a little bit compared to the on in
generate_ios_cmd</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="method">
<dt id="trigger.cmds.NetACLInfo.to_brocade">
<code class="descname">to_brocade</code><span class="sig-paren">(</span><em>dev</em>, <em>commands=None</em>, <em>extra=None</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.NetACLInfo.to_brocade" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the &#8220;show me all interface information&#8221; command we pass to
IOS devices</p>
</dd></dl>

<dl class="method">
<dt id="trigger.cmds.NetACLInfo.to_cisco">
<code class="descname">to_cisco</code><span class="sig-paren">(</span><em>dev</em>, <em>commands=None</em>, <em>extra=None</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.NetACLInfo.to_cisco" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the &#8220;show me all interface information&#8221; command we pass to
IOS devices</p>
</dd></dl>

<dl class="method">
<dt id="trigger.cmds.NetACLInfo.to_force10">
<code class="descname">to_force10</code><span class="sig-paren">(</span><em>dev</em>, <em>commands=None</em>, <em>extra=None</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.NetACLInfo.to_force10" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Similar to IOS, but:</dt>
<dd><ul class="first last simple">
<li>You only get the &#8220;grep&#8221; (&#8220;include&#8221; equivalent) when using &#8220;show
run&#8221;.</li>
<li>The regex must be quoted.</li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="trigger.cmds.NetACLInfo.to_foundry">
<code class="descname">to_foundry</code><span class="sig-paren">(</span><em>dev</em>, <em>commands=None</em>, <em>extra=None</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.NetACLInfo.to_foundry" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the &#8220;show me all interface information&#8221; command we pass to
IOS devices</p>
</dd></dl>

<dl class="method">
<dt id="trigger.cmds.NetACLInfo.to_juniper">
<code class="descname">to_juniper</code><span class="sig-paren">(</span><em>dev</em>, <em>commands=None</em>, <em>extra=None</em><span class="sig-paren">)</span><a class="headerlink" href="#trigger.cmds.NetACLInfo.to_juniper" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates an etree.Element object suitable for use with
JunoScript</p>
</dd></dl>

</dd></dl>

</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="conf.html" class="btn btn-neutral float-right" title="trigger.conf — Configuration &amp; Settings module" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="changemgmt.html" class="btn btn-neutral" title="trigger.changemgmt — Change management library" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2006-2016, AOL Inc.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.6.rc4',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>