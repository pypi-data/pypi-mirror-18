

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Working with NetDevices &mdash; Trigger 1.6.rc4 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Trigger 1.6.rc4 documentation" href="../index.html"/>
        <link rel="up" title="Usage Guide" href="index.html"/>
        <link rel="next" title="Plugins" href="plugins.html"/>
        <link rel="prev" title="Determine commands to run upon login using .gorc" href="gorc.html"/>
 
<style type="text/css">
    span.changelog-support {color: #4070A0;}
    span.changelog-bug {color: #A04040;}
    span.changelog-feature {color: #40A056;}
    a.changelog-release {font-weight: bold;}
</style>


  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Trigger
          

          
          </a>

          
            
            
              <div class="version">
                1.6.rc4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../platforms.html">Supported Platforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Usage Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="cli.html">Command-line Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="gorc.html">Determine commands to run upon login using <code class="docutils literal"><span class="pre">.gorc</span></code></a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Working with NetDevices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#your-source-data">Your Source Data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#a-brief-overview">A Brief Overview</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#anatomy-of-a-device">Anatomy of a Device</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#field-values">Field Values</a></li>
<li class="toctree-l4"><a class="reference internal" href="#minium-required-fields">Minium Required Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="#common-fields">Common Fields</a></li>
<li class="toctree-l4"><a class="reference internal" href="#other-fields">Other Fields</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#quick-start">Quick Start</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#importing-from-rancid">Importing from RANCID</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#supported-formats">Supported Formats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#csv">CSV</a></li>
<li class="toctree-l4"><a class="reference internal" href="#xml">XML</a></li>
<li class="toctree-l4"><a class="reference internal" href="#json">JSON</a></li>
<li class="toctree-l4"><a class="reference internal" href="#rancid">RANCID</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sqlite">SQLite</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#developing-with-netdevices">Developing with NetDevices</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#how-it-works">How it works</a></li>
<li class="toctree-l4"><a class="reference internal" href="#instantiating-netdevices">Instantiating NetDevices</a></li>
<li class="toctree-l4"><a class="reference internal" href="#what-s-in-a-netdevice">What&#8217;s in a NetDevice?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#searching-for-devices">Searching for devices</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plugins.html">Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="tacacsrc.html">Managing Credentials with .tacacsrc</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Usage Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/index.html">API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../support.html">Getting Help</a></li>
<li class="toctree-l1"><a class="reference internal" href="../experimental.html">Experimental</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Trigger</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Usage Guide</a> &raquo;</li>
      
    <li>Working with NetDevices</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/usage/netdevices.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="working-with-netdevices">
<h1>Working with NetDevices<a class="headerlink" href="#working-with-netdevices" title="Permalink to this headline">¶</a></h1>
<p><a class="reference internal" href="../api/netdevices.html#trigger.netdevices.NetDevices" title="trigger.netdevices.NetDevices"><code class="xref py py-obj docutils literal"><span class="pre">NetDevices</span></code></a> is the core of Trigger&#8217;s device interaction.
Anything that communicates with devices relies on the metadata stored within
<a class="reference internal" href="../api/netdevices.html#trigger.netdevices.NetDevice" title="trigger.netdevices.NetDevice"><code class="xref py py-obj docutils literal"><span class="pre">NetDevice</span></code></a> objects.</p>
<div class="section" id="your-source-data">
<h2>Your Source Data<a class="headerlink" href="#your-source-data" title="Permalink to this headline">¶</a></h2>
<p>Before you can work with device metadata, you must tell Trigger how and from
where to read it. You may either modify the values for these options within
<code class="docutils literal"><span class="pre">settings.py</span></code> or you may specify the values as environment variables of the
same name as the configuration options.</p>
<p>Please see <span class="xref doc">configuration</span> for more information on how to do this. There
are two configuration options that facilitate this:</p>
<dl class="docutils">
<dt><a class="reference internal" href="../configuration.html#std:setting-NETDEVICES_SOURCE"><code class="xref std std-setting docutils literal"><span class="pre">NETDEVICES_SOURCE</span></code></a></dt>
<dd>A URL or file path from which the metadata may be obtained. This defaults to
<code class="xref py py-obj docutils literal"><span class="pre">/etc/trigger/netdevices.json</span></code>, but can be any URL with variables.</dd>
<dt><code class="xref std std-setting docutils literal"><span class="pre">NETDEVICES_LOADERS</span></code></dt>
<dd>(Advanced) A tuple of data loader classes, specified as strings. This is an
advanced setting that you may use to create custom loaders if any of the
default loaders do not meet your needs. The primary default loader is the
<code class="xref py py-obj docutils literal"><span class="pre">JSONLoader</span></code>.</dd>
</dl>
<div class="section" id="a-brief-overview">
<h3>A Brief Overview<a class="headerlink" href="#a-brief-overview" title="Permalink to this headline">¶</a></h3>
<p>When you instantiate <a class="reference internal" href="../api/netdevices.html#trigger.netdevices.NetDevices" title="trigger.netdevices.NetDevices"><code class="xref py py-obj docutils literal"><span class="pre">NetDevices</span></code></a> the location specified
<a class="reference internal" href="../configuration.html#std:setting-NETDEVICES_SOURCE"><code class="xref std std-setting docutils literal"><span class="pre">NETDEVICES_SOURCE</span></code></a> is passed onto the <code class="xref std std-setting docutils literal"><span class="pre">NETDEVICES_LOADERS</span></code>
to try to parse and return device metadata.</p>
<p>Using the loaders, you don&#8217;t have to tell Trigger what the format of your
metadata source is. It tries to determine it automatically based on whether one
of the pre-defined loaders successfully returns data without throwing an error.</p>
</div>
</div>
<div class="section" id="anatomy-of-a-device">
<h2>Anatomy of a Device<a class="headerlink" href="#anatomy-of-a-device" title="Permalink to this headline">¶</a></h2>
<p>Trigger&#8217;s <a class="reference internal" href="../api/netdevices.html#trigger.netdevices.NetDevice" title="trigger.netdevices.NetDevice"><code class="xref py py-obj docutils literal"><span class="pre">NetDevice</span></code></a> objects represent everything Trigger
needs to know about each device under its care. These objects are pretty
complicated, but all you really need to know right now are the bare minimum set
of fields that Trigger needs to know about your devices. These fields are used
to control the behaviors and select the correct driver for each platform.</p>
<div class="section" id="field-values">
<h3>Field Values<a class="headerlink" href="#field-values" title="Permalink to this headline">¶</a></h3>
<p>Field values are expected to be strings. They are normalized prior to
evaluation, so case-sensitivity can be left up to you based on how you choose
to manage your data in your environment.</p>
<p>You may also specify custom fields not used or required by Trigger that you may
use for your own purposes, such as writing custom utilities.</p>
</div>
<div class="section" id="minium-required-fields">
<h3>Minium Required Fields<a class="headerlink" href="#minium-required-fields" title="Permalink to this headline">¶</a></h3>
<p>These are the bare minimum required fields for basic operations of Trigger on
most device platforms. Due to distinct differences across device platforms by
vendor, hardware, and operating system versions, not all device platforms can
be supported with the minimum felds.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Support for certain device platforms, such as the Cisco Nexus, require
specifying other fields as detailed in the next section.</p>
</div>
<dl class="docutils">
<dt>nodeName</dt>
<dd>The device hostname or IP address. Trigger does not validate this value for
you, so it must be able to be to be reconciled by the host system on which
Trigger is running. You may also specify a port here by separating the
hostname and port by a colon (e.g. <code class="docutils literal"><span class="pre">hostname:2222</span></code>) . We&#8217;ll cover that in
more detail later.</dd>
<dt>manufacturer</dt>
<dd>The representative name of the hardware vendor. This is also used to
dynamically populate the <code class="docutils literal"><span class="pre">vendor</span></code> attribute on the device object. For
Trigger&#8217;s list of supported vendors, please see
<a class="reference internal" href="../configuration.html#std:setting-SUPPORTED_VENDORS"><code class="xref std std-setting docutils literal"><span class="pre">SUPPORTED_VENDORS</span></code></a>.</dd>
<dt>adminStatus</dt>
<dd>(Recommended) The administrative status of the device. One of <code class="docutils literal"><span class="pre">PRODUCTION</span></code> or
<code class="docutils literal"><span class="pre">NON-PRODUCTION</span></code>. By default, Trigger will only work with devices that
are in <code class="docutils literal"><span class="pre">PRODUCTION</span></code> status. This is covered in more detail under
<a class="reference internal" href="#instantiating-netdevices"><span class="std std-ref">Instantiating NetDevices</span></a>. If you do NOT specifiy <code class="docutils literal"><span class="pre">adminStatus</span></code>,
Trigger will fallback to the default value specified in
<a class="reference internal" href="../configuration.html#std:setting-DEFAULT_ADMIN_STATUS"><code class="xref std std-setting docutils literal"><span class="pre">DEFAULT_ADMIN_STATUS</span></code></a>.</dd>
<dt>deviceType</dt>
<dd>(Recommended) The type of device (e.g. router, switch, etc.). For the list
of supported device types, please see <a class="reference internal" href="../configuration.html#std:setting-SUPPORTED_TYPES"><code class="xref std std-setting docutils literal"><span class="pre">SUPPORTED_TYPES</span></code></a>. If you do
NOT specify <code class="docutils literal"><span class="pre">deviceType</span></code>, Trigger will fallback to the type specified in
<a class="reference internal" href="../configuration.html#std:setting-FALLBACK_TYPE"><code class="xref std std-setting docutils literal"><span class="pre">FALLBACK_TYPE</span></code></a>.</dd>
</dl>
<p>For example the minimum required fields for a device using JSON might be:</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;nodeName&quot;</span><span class="o">:</span> <span class="s2">&quot;n9k1&quot;</span><span class="p">,</span>
    <span class="s2">&quot;deviceType&quot;</span><span class="o">:</span> <span class="s2">&quot;SWITCH&quot;</span><span class="p">,</span>
    <span class="s2">&quot;manufacturer&quot;</span><span class="o">:</span> <span class="s2">&quot;CISCO&quot;</span><span class="p">,</span>
    <span class="s2">&quot;model&quot;</span><span class="o">:</span> <span class="s2">&quot;NEXUS&quot;</span><span class="p">,</span>
    <span class="s2">&quot;adminStatus&quot;</span><span class="o">:</span> <span class="s2">&quot;PRODUCTION&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="common-fields">
<h3>Common Fields<a class="headerlink" href="#common-fields" title="Permalink to this headline">¶</a></h3>
<p>Some vendors, such as Cisco for example, have a wide array of hardware types
with many different operating systems. For this reason, not all devices can be
supported with just vendor and device type. To identify these platforms,
we also make use of the <code class="docutils literal"><span class="pre">make</span></code> and <code class="docutils literal"><span class="pre">model</span></code> fields.</p>
<p>The following fields are required for full support of all officially supported
vendor platforms.</p>
<dl class="docutils">
<dt>make</dt>
<dd>The device platform such as <code class="docutils literal"><span class="pre">Cisco</span> <span class="pre">Nexus</span></code> or just <code class="docutils literal"><span class="pre">Nexus</span></code>.</dd>
<dt>model</dt>
<dd>The specific device model as it appears on the network device, such as
<code class="docutils literal"><span class="pre">N9K</span></code> or <code class="docutils literal"><span class="pre">NEXUS</span> <span class="pre">9000</span></code>.</dd>
</dl>
</div>
<div class="section" id="other-fields">
<h3>Other Fields<a class="headerlink" href="#other-fields" title="Permalink to this headline">¶</a></h3>
<p>There are a ton of other default fields that Trigger utilizes for other
purposes.</p>
</div>
</div>
<div class="section" id="quick-start">
<h2>Quick Start<a class="headerlink" href="#quick-start" title="Permalink to this headline">¶</a></h2>
<p>To get started quickly managing real devices, try this:</p>
<ol class="arabic simple">
<li>Create a <a class="reference internal" href="#csv-format"><span class="std std-ref">CSV</span></a> file.</li>
<li>Tell Trigger where to find your file by setting the locatoin of the file in
<a class="reference internal" href="../configuration.html#std:setting-NETDEVICES_SOURCE"><code class="xref std std-setting docutils literal"><span class="pre">NETDEVICES_SOURCE</span></code></a> in your <code class="docutils literal"><span class="pre">settings.py</span></code>.</li>
</ol>
<div class="section" id="importing-from-rancid">
<h3>Importing from RANCID<a class="headerlink" href="#importing-from-rancid" title="Permalink to this headline">¶</a></h3>
<p>Do you have RANCID? Try using that instead! To learn more please visit the
section on working with the <a class="reference internal" href="#rancid-format"><span class="std std-ref">RANCID</span></a> format.</p>
</div>
</div>
<div class="section" id="supported-formats">
<h2>Supported Formats<a class="headerlink" href="#supported-formats" title="Permalink to this headline">¶</a></h2>
<p>Trigger currently comes with loaders that support the following formats:</p>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#csv" id="id2">CSV</a></li>
<li><a class="reference internal" href="#xml" id="id3">XML</a></li>
<li><a class="reference internal" href="#json" id="id4">JSON</a></li>
<li><a class="reference internal" href="#rancid" id="id5">RANCID</a></li>
<li><a class="reference internal" href="#sqlite" id="id6">SQLite</a></li>
</ul>
</div>
<p>Except when using CSV or RANCID as a data source, the contents of your source
data should be a dump of relevant metadata fields from your CMDB.</p>
<p>If you don&#8217;t have a CMDB, then you&#8217;re going to have to populate this file
manually.</p>
<div class="section" id="csv">
<span id="csv-format"></span><h3><a class="toc-backref" href="#id2">CSV</a><a class="headerlink" href="#csv" title="Permalink to this headline">¶</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.3.</span></p>
</div>
<p>This method is the most lightweight, but also the most limited. But it&#8217;s a
great starting point!</p>
<p>The bare minimum config for CSV is a file populated comma-separated values,
each on their own line with <code class="docutils literal"><span class="pre">hostname,vendor</span></code>. For example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">test1</span><span class="o">-</span><span class="n">abc</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">aol</span><span class="o">.</span><span class="n">com</span><span class="p">,</span><span class="n">juniper</span>
<span class="n">test2</span><span class="o">-</span><span class="n">abc</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">aol</span><span class="o">.</span><span class="n">com</span><span class="p">,</span><span class="n">cisco</span>
</pre></div>
</div>
<p>The most fields you may populate are the same as with the RANCID support.
Please see the explanation of the fields populated by the <a class="reference internal" href="#rancid-format"><span class="std std-ref">RANCID format</span></a>. A &#8220;fully-populated&#8221; CSV file would look more like this:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">test1</span><span class="o">-</span><span class="n">abc</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">aol</span><span class="o">.</span><span class="n">com</span><span class="p">,</span><span class="n">juniper</span><span class="p">,</span><span class="n">up</span><span class="p">,</span><span class="n">router</span>
<span class="n">test2</span><span class="o">-</span><span class="n">abc</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">aol</span><span class="o">.</span><span class="n">com</span><span class="p">,</span><span class="n">juniper</span><span class="p">,</span><span class="n">up</span><span class="p">,</span><span class="n">router</span>
<span class="n">fw1</span><span class="o">-</span><span class="n">xyz</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">aol</span><span class="o">.</span><span class="n">com</span><span class="p">,</span><span class="n">netscreen</span><span class="p">,</span><span class="n">up</span><span class="p">,</span><span class="n">firewall</span>
<span class="n">lab1</span><span class="o">-</span><span class="n">switch</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">aol</span><span class="o">.</span><span class="n">com</span><span class="p">,</span><span class="n">foundry</span><span class="p">,</span><span class="n">up</span><span class="p">,</span><span class="n">switch</span>
</pre></div>
</div>
</div>
<div class="section" id="xml">
<span id="xml-format"></span><h3><a class="toc-backref" href="#id3">XML</a><a class="headerlink" href="#xml" title="Permalink to this headline">¶</a></h3>
<p>XML is the slowest method supported by Trigger, but it is currently the default
for legacy reasons. At some point we will switch JSON to the default.</p>
<p>Here is a sample what the <code class="docutils literal"><span class="pre">netdevices.xml</span></code> file bundled with the Trigger
source code looks like:</p>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="c">&lt;!-- Dummy version of netdevices.xml, with just one real entry modeled from the real file --&gt;</span>
<span class="nt">&lt;NetDevices&gt;</span>
    <span class="nt">&lt;device</span> <span class="na">nodeName=</span><span class="s">&quot;test1-abc.net.aol.com&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;adminStatus&gt;</span>PRODUCTION<span class="nt">&lt;/adminStatus&gt;</span>
        <span class="nt">&lt;assetID&gt;</span>0000012345<span class="nt">&lt;/assetID&gt;</span>
        <span class="nt">&lt;authMethod&gt;</span>tacacs<span class="nt">&lt;/authMethod&gt;</span>
        <span class="nt">&lt;barcode&gt;</span>0101010101<span class="nt">&lt;/barcode&gt;</span>
        <span class="nt">&lt;budgetCode&gt;</span>1234578<span class="nt">&lt;/budgetCode&gt;</span>
        <span class="nt">&lt;budgetName&gt;</span>Data Center<span class="nt">&lt;/budgetName&gt;</span>
        <span class="nt">&lt;coordinate&gt;</span>16ZZ<span class="nt">&lt;/coordinate&gt;</span>
        <span class="nt">&lt;deviceType&gt;</span>ROUTER<span class="nt">&lt;/deviceType&gt;</span>
        <span class="nt">&lt;enablePW&gt;</span>boguspassword<span class="nt">&lt;/enablePW&gt;</span>
        <span class="nt">&lt;lastUpdate&gt;</span>2010-07-19 19:56:32.0<span class="nt">&lt;/lastUpdate&gt;</span>
        <span class="nt">&lt;layer2&gt;</span>1<span class="nt">&lt;/layer2&gt;</span>
        <span class="nt">&lt;layer3&gt;</span>1<span class="nt">&lt;/layer3&gt;</span>
        <span class="nt">&lt;layer4&gt;</span>1<span class="nt">&lt;/layer4&gt;</span>
        <span class="nt">&lt;lifecycleStatus&gt;</span>INSTALLED<span class="nt">&lt;/lifecycleStatus&gt;</span>
        <span class="nt">&lt;loginPW&gt;&lt;/loginPW&gt;</span>
        <span class="nt">&lt;make&gt;</span>M40 INTERNET BACKBONE ROUTER<span class="nt">&lt;/make&gt;</span>
        <span class="nt">&lt;manufacturer&gt;</span>JUNIPER<span class="nt">&lt;/manufacturer&gt;</span>
        <span class="nt">&lt;model&gt;</span>M40-B-AC<span class="nt">&lt;/model&gt;</span>
        <span class="nt">&lt;nodeName&gt;</span>test1-abc.net.aol.com<span class="nt">&lt;/nodeName&gt;</span>
        <span class="nt">&lt;onCallEmail&gt;</span>nobody@aol.net<span class="nt">&lt;/onCallEmail&gt;</span>
        <span class="nt">&lt;onCallID&gt;</span>17<span class="nt">&lt;/onCallID&gt;</span>
        <span class="nt">&lt;onCallName&gt;</span>Data Center<span class="nt">&lt;/onCallName&gt;</span>
        <span class="nt">&lt;owningTeam&gt;</span>Data Center<span class="nt">&lt;/owningTeam&gt;</span>
        <span class="nt">&lt;OOBTerminalServerConnector&gt;</span>C<span class="nt">&lt;/OOBTerminalServerConnector&gt;</span>
        <span class="nt">&lt;OOBTerminalServerFQDN&gt;</span>ts1.oob.aol.com<span class="nt">&lt;/OOBTerminalServerFQDN&gt;</span>
        <span class="nt">&lt;OOBTerminalServerNodeName&gt;</span>ts1<span class="nt">&lt;/OOBTerminalServerNodeName&gt;</span>
        <span class="nt">&lt;OOBTerminalServerPort&gt;</span>5<span class="nt">&lt;/OOBTerminalServerPort&gt;</span>
        <span class="nt">&lt;OOBTerminalServerTCPPort&gt;</span>5005<span class="nt">&lt;/OOBTerminalServerTCPPort&gt;</span>
        <span class="nt">&lt;operationStatus&gt;</span>MONITORED<span class="nt">&lt;/operationStatus&gt;</span>
        <span class="nt">&lt;owner&gt;</span>12345678 - Network Engineering<span class="nt">&lt;/owner&gt;</span>
        <span class="nt">&lt;projectName&gt;</span>Test Lab<span class="nt">&lt;/projectName&gt;</span>
        <span class="nt">&lt;room&gt;</span>CR10<span class="nt">&lt;/room&gt;</span>
        <span class="nt">&lt;serialNumber&gt;</span>987654321<span class="nt">&lt;/serialNumber&gt;</span>
        <span class="nt">&lt;site&gt;</span>LAB<span class="nt">&lt;/site&gt;</span>
    <span class="nt">&lt;/device&gt;</span>
    ...
<span class="nt">&lt;/NetDevices&gt;</span>
</pre></div>
</div>
<p>Please see <code class="docutils literal"><span class="pre">configs/netdevices.xml</span></code> within the Trigger source distribution for a
full example.</p>
</div>
<div class="section" id="json">
<span id="json-format"></span><h3><a class="toc-backref" href="#id4">JSON</a><a class="headerlink" href="#json" title="Permalink to this headline">¶</a></h3>
<p>JSON is the fastest method supported by Trigger. This is especially the case if
you utilize the optional C extension of  <code class="xref py py-obj docutils literal"><span class="pre">simplejson</span></code>. The file can be minified and does
not need to be indented.</p>
<p>Here is a sample of what the <code class="docutils literal"><span class="pre">netdevices.json</span></code> file bundled with the Trigger
source code looks like (pretty-printed for readabilty):</p>
<div class="highlight-javascript"><div class="highlight"><pre><span></span><span class="p">[</span>
    <span class="p">{</span>
        <span class="s2">&quot;adminStatus&quot;</span><span class="o">:</span> <span class="s2">&quot;PRODUCTION&quot;</span><span class="p">,</span>
        <span class="s2">&quot;enablePW&quot;</span><span class="o">:</span> <span class="s2">&quot;boguspassword&quot;</span><span class="p">,</span>
        <span class="s2">&quot;OOBTerminalServerTCPPort&quot;</span><span class="o">:</span> <span class="s2">&quot;5005&quot;</span><span class="p">,</span>
        <span class="s2">&quot;assetID&quot;</span><span class="o">:</span> <span class="s2">&quot;0000012345&quot;</span><span class="p">,</span>
        <span class="s2">&quot;OOBTerminalServerNodeName&quot;</span><span class="o">:</span> <span class="s2">&quot;ts1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;onCallEmail&quot;</span><span class="o">:</span> <span class="s2">&quot;nobody@aol.net&quot;</span><span class="p">,</span>
        <span class="s2">&quot;onCallID&quot;</span><span class="o">:</span> <span class="s2">&quot;17&quot;</span><span class="p">,</span>
        <span class="s2">&quot;OOBTerminalServerFQDN&quot;</span><span class="o">:</span> <span class="s2">&quot;ts1.oob.aol.com&quot;</span><span class="p">,</span>
        <span class="s2">&quot;owner&quot;</span><span class="o">:</span> <span class="s2">&quot;12345678 - Network Engineering&quot;</span><span class="p">,</span>
        <span class="s2">&quot;OOBTerminalServerPort&quot;</span><span class="o">:</span> <span class="s2">&quot;5&quot;</span><span class="p">,</span>
        <span class="s2">&quot;onCallName&quot;</span><span class="o">:</span> <span class="s2">&quot;Data Center&quot;</span><span class="p">,</span>
        <span class="s2">&quot;nodeName&quot;</span><span class="o">:</span> <span class="s2">&quot;test1-abc.net.aol.com&quot;</span><span class="p">,</span>
        <span class="s2">&quot;make&quot;</span><span class="o">:</span> <span class="s2">&quot;M40 INTERNET BACKBONE ROUTER&quot;</span><span class="p">,</span>
        <span class="s2">&quot;budgetCode&quot;</span><span class="o">:</span> <span class="s2">&quot;1234578&quot;</span><span class="p">,</span>
        <span class="s2">&quot;budgetName&quot;</span><span class="o">:</span> <span class="s2">&quot;Data Center&quot;</span><span class="p">,</span>
        <span class="s2">&quot;operationStatus&quot;</span><span class="o">:</span> <span class="s2">&quot;MONITORED&quot;</span><span class="p">,</span>
        <span class="s2">&quot;deviceType&quot;</span><span class="o">:</span> <span class="s2">&quot;ROUTER&quot;</span><span class="p">,</span>
        <span class="s2">&quot;lastUpdate&quot;</span><span class="o">:</span> <span class="s2">&quot;2010-07-19 19:56:32.0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;authMethod&quot;</span><span class="o">:</span> <span class="s2">&quot;tacacs&quot;</span><span class="p">,</span>
        <span class="s2">&quot;projectName&quot;</span><span class="o">:</span> <span class="s2">&quot;Test Lab&quot;</span><span class="p">,</span>
        <span class="s2">&quot;barcode&quot;</span><span class="o">:</span> <span class="s2">&quot;0101010101&quot;</span><span class="p">,</span>
        <span class="s2">&quot;site&quot;</span><span class="o">:</span> <span class="s2">&quot;LAB&quot;</span><span class="p">,</span>
        <span class="s2">&quot;loginPW&quot;</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
        <span class="s2">&quot;lifecycleStatus&quot;</span><span class="o">:</span> <span class="s2">&quot;INSTALLED&quot;</span><span class="p">,</span>
        <span class="s2">&quot;manufacturer&quot;</span><span class="o">:</span> <span class="s2">&quot;JUNIPER&quot;</span><span class="p">,</span>
        <span class="s2">&quot;layer3&quot;</span><span class="o">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;layer2&quot;</span><span class="o">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;room&quot;</span><span class="o">:</span> <span class="s2">&quot;CR10&quot;</span><span class="p">,</span>
        <span class="s2">&quot;layer4&quot;</span><span class="o">:</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span>
        <span class="s2">&quot;serialNumber&quot;</span><span class="o">:</span> <span class="s2">&quot;987654321&quot;</span><span class="p">,</span>
        <span class="s2">&quot;owningTeam&quot;</span><span class="o">:</span> <span class="s2">&quot;Data Center&quot;</span><span class="p">,</span>
        <span class="s2">&quot;coordinate&quot;</span><span class="o">:</span> <span class="s2">&quot;16ZZ&quot;</span><span class="p">,</span>
        <span class="s2">&quot;model&quot;</span><span class="o">:</span> <span class="s2">&quot;M40-B-AC&quot;</span><span class="p">,</span>
        <span class="s2">&quot;OOBTerminalServerConnector&quot;</span><span class="o">:</span> <span class="s2">&quot;C&quot;</span>
    <span class="p">},</span>
    <span class="p">...</span>
<span class="p">]</span>
</pre></div>
</div>
<p>To use JSON, create your <a class="reference internal" href="../configuration.html#std:setting-NETDEVICES_SOURCE"><code class="xref std std-setting docutils literal"><span class="pre">NETDEVICES_SOURCE</span></code></a> file full of objects that
look like the one above.</p>
<p>Please see <code class="docutils literal"><span class="pre">configs/netdevices.json</span></code> within the Trigger source distribution for
a full example.</p>
</div>
<div class="section" id="rancid">
<span id="rancid-format"></span><h3><a class="toc-backref" href="#id5">RANCID</a><a class="headerlink" href="#rancid" title="Permalink to this headline">¶</a></h3>
<p>If you&#8217;ve already got a RANCID instance in your environment, this is the
easiest method to get running. At this time, however, the metadata available
from RANCID is very limited and populates only the following fields for each
<code class="xref py py-obj docutils literal"><span class="pre">Netdevice</span></code> object:</p>
<ul class="simple">
<li>nodeName</li>
<li>manufacturer</li>
<li>deviceType</li>
<li>adminStatus</li>
</ul>
<p>The support for RANCID comes in two forms: single or multiple instance.</p>
<p>Single instance is the default and expects to find the <code class="docutils literal"><span class="pre">router.db</span></code> file and
the <code class="docutils literal"><span class="pre">configs</span></code> directory in the root directory you specify.</p>
<p>Multiple instance will instead walk the root directory and expect to find
<code class="docutils literal"><span class="pre">router.db</span></code> and <code class="docutils literal"><span class="pre">configs</span></code> in each subdirectory it finds. Multiple instance
can be toggled by seting the value of <a class="reference internal" href="../configuration.html#std:setting-RANCID_RECURSE_SUBDIRS"><code class="xref std std-setting docutils literal"><span class="pre">RANCID_RECURSE_SUBDIRS</span></code></a> to
<code class="docutils literal"><span class="pre">True</span></code> to your <code class="docutils literal"><span class="pre">settings.py</span></code>.</p>
<p>To use RANCID as a data source, set the value of <a class="reference internal" href="../configuration.html#std:setting-NETDEVICES_SOURCE"><code class="xref std std-setting docutils literal"><span class="pre">NETDEVICES_SOURCE</span></code></a> in
<code class="docutils literal"><span class="pre">settings.py</span></code> to the absolute path of location of of the root directory where
your RANCID data is stored.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Make sure that the value of <a class="reference internal" href="../configuration.html#std:setting-RANCID_RECURSE_SUBDIRS"><code class="xref std std-setting docutils literal"><span class="pre">RANCID_RECURSE_SUBDIRS</span></code></a> matches the RANCID
method you are using. This setting defaults to <code class="docutils literal"><span class="pre">False</span></code>, so if you only
have a single RANCID instance, there is no need to add it to your
<code class="docutils literal"><span class="pre">settings.py</span></code>.</p>
</div>
<p>Lastly, to illustrate what a <a class="reference internal" href="../api/netdevices.html#trigger.netdevices.NetDevice" title="trigger.netdevices.NetDevice"><code class="xref py py-obj docutils literal"><span class="pre">NetDevice</span></code></a> object that has
been populated by RANCID looks like, here is the output of <code class="docutils literal"><span class="pre">.dump()</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Hostname</span><span class="p">:</span>          <span class="n">test1</span><span class="o">-</span><span class="n">abc</span><span class="o">.</span><span class="n">net</span><span class="o">.</span><span class="n">aol</span><span class="o">.</span><span class="n">com</span>
<span class="n">Owning</span> <span class="n">Org</span><span class="o">.</span><span class="p">:</span>       <span class="kc">None</span>
<span class="n">Owning</span> <span class="n">Team</span><span class="p">:</span>       <span class="kc">None</span>
<span class="n">OnCall</span> <span class="n">Team</span><span class="p">:</span>       <span class="kc">None</span>

<span class="n">Vendor</span><span class="p">:</span>            <span class="n">Juniper</span> <span class="p">(</span><span class="n">juniper</span><span class="p">)</span>
<span class="n">Make</span><span class="p">:</span>              <span class="kc">None</span>
<span class="n">Model</span><span class="p">:</span>             <span class="kc">None</span>
<span class="n">Type</span><span class="p">:</span>              <span class="n">ROUTER</span>
<span class="n">Location</span><span class="p">:</span>          <span class="kc">None</span> <span class="kc">None</span> <span class="kc">None</span>

<span class="n">Project</span><span class="p">:</span>           <span class="kc">None</span>
<span class="n">Serial</span><span class="p">:</span>            <span class="kc">None</span>
<span class="n">Asset</span> <span class="n">Tag</span><span class="p">:</span>         <span class="kc">None</span>
<span class="n">Budget</span> <span class="n">Code</span><span class="p">:</span>       <span class="kc">None</span> <span class="p">(</span><span class="kc">None</span><span class="p">)</span>

<span class="n">Admin</span> <span class="n">Status</span><span class="p">:</span>      <span class="n">PRODUCTION</span>
<span class="n">Lifecycle</span> <span class="n">Status</span><span class="p">:</span>  <span class="kc">None</span>
<span class="n">Operation</span> <span class="n">Status</span><span class="p">:</span>  <span class="kc">None</span>
<span class="n">Last</span> <span class="n">Updated</span><span class="p">:</span>      <span class="kc">None</span>
</pre></div>
</div>
<p>Compare that to what a device dump looks like when fully populated from CMDB
metadata in <a class="reference internal" href="#netdevice-info"><span class="std std-ref">What&#8217;s in a NetDevice?</span></a>. It&#8217;s important to keep this in mind, because
if you want to do device associations using any of the unpopulated fields,
you&#8217;re gonna have a bad time. This is subject to change as RANCID support
evolves, but this is the way it is for now.</p>
</div>
<div class="section" id="sqlite">
<span id="sqlite-format"></span><h3><a class="toc-backref" href="#id6">SQLite</a><a class="headerlink" href="#sqlite" title="Permalink to this headline">¶</a></h3>
<p>SQLite is somewhere between JSON and XML as far as performance, but also comes
with the added benefit that support is built into Python, and you get a real
database file you can leverage in other ways outside of Trigger.</p>
<div class="highlight-sql"><div class="highlight"><pre><span></span><span class="c1">--</span>
<span class="c1">-- Table structure for table `netdevices`</span>
<span class="c1">--</span>
<span class="c1">-- This is for &#39;netdevices.sql&#39; SQLite support within</span>
<span class="c1">-- trigger.netdevices.NetDevices for storing and tracking network device</span>
<span class="c1">-- metadata.</span>
<span class="c1">--</span>
<span class="c1">-- This is based on the current set of existing attributes in use and is by no</span>
<span class="c1">-- means exclusive. Feel free to add your own fields to suit your environment.</span>
<span class="c1">--</span>

<span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">netdevices</span> <span class="p">(</span>
    <span class="n">id</span>  <span class="nb">INTEGER</span> <span class="k">PRIMARY</span> <span class="k">KEY</span><span class="p">,</span>
    <span class="n">OOBTerminalServerConnector</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">OOBTerminalServerFQDN</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">OOBTerminalServerNodeName</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">OOBTerminalServerPort</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">OOBTerminalServerTCPPort</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">acls</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">adminStatus</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">assetID</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">authMethod</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">barcode</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">budgetCode</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">budgetName</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">bulk_acls</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">connectProtocol</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">coordinate</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">deviceType</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">enablePW</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">explicit_acls</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">gslb_master</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">implicit_acls</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">lastUpdate</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">layer2</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">layer3</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">layer4</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">lifecycleStatus</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">loginPW</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">make</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">manufacturer</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">model</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">nodeName</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">onCallEmail</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">onCallID</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">onCallName</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">operationStatus</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="k">owner</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">owningTeam</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">projectID</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">projectName</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">room</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">serialNumber</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">),</span>
    <span class="n">site</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="p">);</span>
</pre></div>
</div>
<p>To use SQLite, create a database using the schema provided within Trigger
source distribution at <code class="docutils literal"><span class="pre">configs/netdevices.sql</span></code>. You will need to populate the
database full of rows with the columns above and set
<a class="reference internal" href="../configuration.html#std:setting-NETDEVICES_SOURCE"><code class="xref std std-setting docutils literal"><span class="pre">NETDEVICES_SOURCE</span></code></a> the absolute path of the database file.</p>
</div>
</div>
<div class="section" id="developing-with-netdevices">
<h2>Developing with NetDevices<a class="headerlink" href="#developing-with-netdevices" title="Permalink to this headline">¶</a></h2>
<p>First things first, you must instantiate <a class="reference internal" href="../api/netdevices.html#trigger.netdevices.NetDevices" title="trigger.netdevices.NetDevices"><code class="xref py py-obj docutils literal"><span class="pre">NetDevices</span></code></a>.  It
has three things it requires before you can properly do this:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you do not want to load ACL associations you may skip them by passing
<code class="docutils literal"><span class="pre">with_acls=False</span></code> to <a class="reference internal" href="../api/netdevices.html#trigger.netdevices.NetDevices" title="trigger.netdevices.NetDevices"><code class="xref py py-obj docutils literal"><span class="pre">NetDevices</span></code></a> and then you only need
to satisfy the first requirement. A this time it is not possible to
globally disable ACL support, so this will only work for the purpose of
this walkthrough or when you manually instantiate NetDevices objects.</p>
</div>
<ol class="arabic simple">
<li>The <a class="reference internal" href="../configuration.html#std:setting-NETDEVICES_SOURCE"><code class="xref std std-setting docutils literal"><span class="pre">NETDEVICES_SOURCE</span></code></a> file must be readable and must properly
parse using one of the default loaders formats supported in
<code class="xref std std-setting docutils literal"><span class="pre">NETDEVICES_LOADERS</span></code> (see above);</li>
<li>An instance of Redis (you may skip this by passing <code class="docutils literal"><span class="pre">with_acls=False</span></code>
to the <a class="reference internal" href="../api/netdevices.html#trigger.netdevices.NetDevices" title="trigger.netdevices.NetDevices"><code class="xref py py-obj docutils literal"><span class="pre">NetDevices</span></code></a> constructor).</li>
<li>The path to <code class="docutils literal"><span class="pre">autoacl.py</span></code> must be valid, and must properly parse (you
may skip this if you just want to ignore the warnings for now).</li>
</ol>
<div class="section" id="how-it-works">
<h3>How it works<a class="headerlink" href="#how-it-works" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../api/netdevices.html#trigger.netdevices.NetDevices" title="trigger.netdevices.NetDevices"><code class="xref py py-obj docutils literal"><span class="pre">NetDevices</span></code></a> object itself is an immutable,
dictionary-like <a class="reference external" href="http://en.wikipedia.org/wiki/Singleton_pattern">Singleton</a> object. If you don&#8217;t know what a Singleton is, it
means that there can only be one instance of this object in any program. The
actual instance object itself an instance of the inner
<a class="reference internal" href="../api/netdevices.html#trigger.netdevices.NetDevices._actual" title="trigger.netdevices.NetDevices._actual"><code class="xref py py-class docutils literal"><span class="pre">_actual</span></code></a> class which is stored in the
module object as <code class="docutils literal"><span class="pre">NetDevices._Singleton</span></code>. This is done as a performance boost
because many Trigger components require a NetDevices instance, and if we had to
keep creating new ones, we&#8217;d be waiting each time one had to parse
<a class="reference internal" href="../configuration.html#std:setting-NETDEVICES_SOURCE"><code class="xref std std-setting docutils literal"><span class="pre">NETDEVICES_SOURCE</span></code></a> all over again.</p>
<p>Upon startup, each device object/element/row found within
<a class="reference internal" href="../configuration.html#std:setting-NETDEVICES_SOURCE"><code class="xref std std-setting docutils literal"><span class="pre">NETDEVICES_SOURCE</span></code></a> is used to create a
<a class="reference internal" href="../api/netdevices.html#trigger.netdevices.NetDevice" title="trigger.netdevices.NetDevice"><code class="xref py py-obj docutils literal"><span class="pre">NetDevice</span></code></a> object. This object pulls in ACL associations
from <a class="reference internal" href="../api/acl.html#trigger.acl.db.AclsDB" title="trigger.acl.db.AclsDB"><code class="xref py py-obj docutils literal"><span class="pre">AclsDB</span></code></a>.</p>
<div class="section" id="the-singleton-pattern">
<h4>The Singleton Pattern<a class="headerlink" href="#the-singleton-pattern" title="Permalink to this headline">¶</a></h4>
<p>The NetDevices module object has a <code class="docutils literal"><span class="pre">_Singleton</span></code> attribute that defaults to
<code class="docutils literal"><span class="pre">None</span></code>. Upon creating an instance, this is populated with the
<a class="reference internal" href="../api/netdevices.html#trigger.netdevices.NetDevices._actual" title="trigger.netdevices.NetDevices._actual"><code class="xref py py-obj docutils literal"><span class="pre">_actual</span></code></a> instance:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nd</span> <span class="o">=</span> <span class="n">NetDevices</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nd</span><span class="o">.</span><span class="n">_Singleton</span>
<span class="go">&lt;trigger.netdevices._actual object at 0x2ae3dcf48710&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">NetDevices</span><span class="o">.</span><span class="n">_Singleton</span>
<span class="go">&lt;trigger.netdevices._actual object at 0x2ae3dcf48710&gt;</span>
</pre></div>
</div>
<p>This is how new instances are prevented. Whenever you create a new reference by
instantiating NetDevices again, what you are really doing is creating a reference
to <code class="docutils literal"><span class="pre">NetDevices._Singleton</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">other_nd</span> <span class="o">=</span> <span class="n">NetDevices</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">other_nd</span><span class="o">.</span><span class="n">_Singleton</span>
<span class="go">&lt;trigger.netdevices._actual object at 0x2ae3dcf48710&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nd</span><span class="o">.</span><span class="n">_Singleton</span> <span class="ow">is</span> <span class="n">other_nd</span><span class="o">.</span><span class="n">_Singleton</span>
<span class="go">True</span>
</pre></div>
</div>
<p>The only time this would be an issue is if you needed to change the actual contents
of your object (such as when debugging or passing <code class="docutils literal"><span class="pre">production_only=False</span></code>).
If you need to do this, set the value to <code class="docutils literal"><span class="pre">None</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">NetDevices</span><span class="o">.</span><span class="n">_Singleton</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
<p>Then the next call to <a class="reference internal" href="../api/netdevices.html#trigger.netdevices.NetDevices" title="trigger.netdevices.NetDevices"><code class="xref py py-obj docutils literal"><span class="pre">NetDevices()</span></code></a> will start from
scratch. Keep in mind because of this pattern it is not easy to have more than
one instance (there are ways but we&#8217;re not going to list them here!). All
existing instances will inherit the value of <code class="docutils literal"><span class="pre">NetDevices._Singleton</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">third_nd</span> <span class="o">=</span> <span class="n">NetDevices</span><span class="p">(</span><span class="n">production_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">third_nd</span><span class="o">.</span><span class="n">_Singleton</span>
<span class="go">&lt;trigger.netdevices._actual object at 0x2ae3dcf506d0&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nd</span><span class="o">.</span><span class="n">_Singleton</span>
<span class="go">&lt;trigger.netdevices._actual object at 0x2ae3dcf506d0&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">third_nd</span><span class="o">.</span><span class="n">_Singleton</span> <span class="ow">is</span> <span class="n">nd</span><span class="o">.</span><span class="n">_Singleton</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="instantiating-netdevices">
<span id="id1"></span><h3>Instantiating NetDevices<a class="headerlink" href="#instantiating-netdevices" title="Permalink to this headline">¶</a></h3>
<p>Throughout the Trigger code, the convention when instantiating and referencing a
<a class="reference internal" href="../api/netdevices.html#trigger.netdevices.NetDevices" title="trigger.netdevices.NetDevices"><code class="xref py py-obj docutils literal"><span class="pre">NetDevices</span></code></a> instance, is to assign it to the variable
<code class="docutils literal"><span class="pre">nd</span></code>.  All examples will use this, so keep that in mind:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">trigger.netdevices</span> <span class="k">import</span> <span class="n">NetDevices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nd</span> <span class="o">=</span> <span class="n">NetDevices</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">nd</span><span class="p">)</span>
<span class="go">3</span>
</pre></div>
</div>
<p>By default, this only includes any devices for which <code class="docutils literal"><span class="pre">adminStatus</span></code> (aka
administrative status) is <code class="docutils literal"><span class="pre">PRODUCTION</span></code>. This means that the device is used
in your production environment. If you would like you get all devices regardless
of <code class="docutils literal"><span class="pre">adminStatus</span></code>, you must pass <code class="docutils literal"><span class="pre">production_only=False</span></code> to the constructor:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">trigger.netdevices</span> <span class="k">import</span> <span class="n">NetDevices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nd</span> <span class="o">=</span> <span class="n">NetDevices</span><span class="p">(</span><span class="n">production_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">nd</span><span class="p">)</span>
<span class="go">4</span>
</pre></div>
</div>
<p>The included sample metadata files contains one device that is marked as
<code class="docutils literal"><span class="pre">NON-PRODUCTION</span></code>.</p>
</div>
<div class="section" id="what-s-in-a-netdevice">
<span id="netdevice-info"></span><h3>What&#8217;s in a NetDevice?<a class="headerlink" href="#what-s-in-a-netdevice" title="Permalink to this headline">¶</a></h3>
<p>A <a class="reference internal" href="../api/netdevices.html#trigger.netdevices.NetDevice" title="trigger.netdevices.NetDevice"><code class="xref py py-obj docutils literal"><span class="pre">NetDevice</span></code></a> object has a number of attributes you can use
creatively to correlate
or identify them:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dev</span> <span class="o">=</span> <span class="n">nd</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;test1-abc&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dev</span>
<span class="go">&lt;NetDevice: test1-abc.net.aol.com&gt;</span>
</pre></div>
</div>
<p>Printing it displays the hostname:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">dev</span>
<span class="go">test1-abc.net.aol.com</span>
</pre></div>
</div>
<p>You can dump the values:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dev</span><span class="o">.</span><span class="n">dump</span><span class="p">()</span>

<span class="go">        Hostname:          test1-abc.net.aol.com</span>
<span class="go">        Owning Org.:       12345678 - Network Engineering</span>
<span class="go">        Owning Team:       Data Center</span>
<span class="go">        OnCall Team:       Data Center</span>

<span class="go">        Vendor:            Juniper (JUNIPER)</span>
<span class="go">        Make:              M40 INTERNET BACKBONE ROUTER</span>
<span class="go">        Model:             M40-B-AC</span>
<span class="go">        Type:              ROUTER</span>
<span class="go">        Location:          LAB CR10 16ZZ</span>

<span class="go">        Project:           Test Lab</span>
<span class="go">        Serial:            987654321</span>
<span class="go">        Asset Tag:         0000012345</span>
<span class="go">        Budget Code:       1234578 (Data Center)</span>

<span class="go">        Admin Status:      PRODUCTION</span>
<span class="go">        Lifecycle Status:  INSTALLED</span>
<span class="go">        Operation Status:  MONITORED</span>
<span class="go">        Last Updated:      2010-07-19 19:56:32.0</span>
</pre></div>
</div>
<p>You can reference them as attributes:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dev</span><span class="o">.</span><span class="n">nodeName</span><span class="p">,</span> <span class="n">dev</span><span class="o">.</span><span class="n">vendor</span><span class="p">,</span> <span class="n">dev</span><span class="o">.</span><span class="n">deviceType</span>
<span class="go">(&#39;test1-abc.net.aol.com&#39;, &lt;Vendor: Juniper&gt;, &#39;ROUTER&#39;)</span>
</pre></div>
</div>
<p>There are some special methods to perform identity tests:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dev</span><span class="o">.</span><span class="n">is_router</span><span class="p">(),</span> <span class="n">dev</span><span class="o">.</span><span class="n">is_switch</span><span class="p">(),</span> <span class="n">dev</span><span class="o">.</span><span class="n">is_firewall</span><span class="p">()</span>
<span class="go">(True, False, False)</span>
</pre></div>
</div>
<p>You can view the ACLs assigned to the device:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you have passed <code class="docutils literal"><span class="pre">with_acls=False</span></code>, none of these attributes will be
populated and will instead return an empty <code class="docutils literal"><span class="pre">set()</span></code>).</p>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dev</span><span class="o">.</span><span class="n">explicit_acls</span>
<span class="go">set([&#39;abc123&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dev</span><span class="o">.</span><span class="n">implicit_acls</span>
<span class="go">set([&#39;juniper-router.policer&#39;, &#39;juniper-router-protect&#39;])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dev</span><span class="o">.</span><span class="n">acls</span>
<span class="go">set([&#39;juniper-router.policer&#39;, &#39;juniper-router-protect&#39;, &#39;abc123&#39;])</span>
</pre></div>
</div>
<p>Or get the next time it&#8217;s ok to make changes to this device (more on this
later):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dev</span><span class="o">.</span><span class="n">bounce</span><span class="o">.</span><span class="n">next_ok</span><span class="p">(</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="go">datetime.datetime(2011, 7, 13, 9, 0, tzinfo=&lt;UTC&gt;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="n">dev</span><span class="o">.</span><span class="n">bounce</span><span class="o">.</span><span class="n">status</span><span class="p">()</span>
<span class="go">red</span>
</pre></div>
</div>
</div>
<div class="section" id="searching-for-devices">
<h3>Searching for devices<a class="headerlink" href="#searching-for-devices" title="Permalink to this headline">¶</a></h3>
<div class="section" id="like-a-dictionary">
<h4>Like a dictionary<a class="headerlink" href="#like-a-dictionary" title="Permalink to this headline">¶</a></h4>
<p>Since the object is like a dictionary, you may reference devices as keys by
their hostnames:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nd</span>
<span class="go">{&#39;test2-abc.net.aol.com&#39;: &lt;NetDevice: test2-abc.net.aol.com&gt;,</span>
<span class="go"> &#39;test1-abc.net.aol.com&#39;: &lt;NetDevice: test1-abc.net.aol.com&gt;,</span>
<span class="go"> &#39;lab1-switch.net.aol.com&#39;: &lt;NetDevice: lab1-switch.net.aol.com&gt;,</span>
<span class="go"> &#39;fw1-xyz.net.aol.com&#39;: &lt;NetDevice: fw1-xyz.net.aol.com&gt;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nd</span><span class="p">[</span><span class="s1">&#39;test1-abc.net.aol.com&#39;</span><span class="p">]</span>
<span class="go">&lt;NetDevice: test1-abc.net.aol.com&gt;</span>
</pre></div>
</div>
<p>You may also perform any other operations to iterate devices as you would with
a dictionary (<code class="docutils literal"><span class="pre">.keys()</span></code>, <code class="docutils literal"><span class="pre">.itervalues()</span></code>, etc.).</p>
</div>
<div class="section" id="special-methods">
<h4>Special methods<a class="headerlink" href="#special-methods" title="Permalink to this headline">¶</a></h4>
<p>There are a number of ways you can search for devices. In all cases, you are
returned a list.</p>
<p>The simplest usage is just to list all devices:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nd</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="go">[&lt;NetDevice: test2-abc.net.aol.com&gt;, &lt;NetDevice: test1-abc.net.aol.com&gt;,</span>
<span class="go"> &lt;NetDevice: lab1-switch.net.aol.com&gt;, &lt;NetDevice: fw1-xyz.net.aol.com&gt;]</span>
</pre></div>
</div>
<p>Using <code class="docutils literal"><span class="pre">all()</span></code> is going to be very rare, as you&#8217;re more likely to work with a
subset of your
devices.</p>
<p>Find a device by its shortname (minus the domain):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nd</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;test1-abc&#39;</span><span class="p">)</span>
<span class="go">&lt;NetDevice: test1-abc.net.aol.com&gt;</span>
</pre></div>
</div>
<p>List devices by type (switches, routers, or firewalls):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nd</span><span class="o">.</span><span class="n">list_routers</span><span class="p">()</span>
<span class="go">[&lt;NetDevice: test2-abc.net.aol.com&gt;, &lt;NetDevice: test1-abc.net.aol.com&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nd</span><span class="o">.</span><span class="n">list_switches</span><span class="p">()</span>
<span class="go">[&lt;NetDevice: lab1-switch.net.aol.com&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nd</span><span class="o">.</span><span class="n">list_firewalls</span><span class="p">()</span>
<span class="go">[&lt;NetDevice: fw1-xyz.net.aol.com&gt;]</span>
</pre></div>
</div>
<p>Perform a case-sensitive search on any field (it defaults to <code class="docutils literal"><span class="pre">nodeName</span></code>):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nd</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="go">[&lt;NetDevice: test2-abc.net.aol.com&gt;, &lt;NetDevice: test1-abc.net.aol.com&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nd</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;test2&#39;</span><span class="p">)</span>
<span class="go">[&lt;NetDevice: test2-abc.net.aol.com&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nd</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="s1">&#39;NON-PRODUCTION&#39;</span><span class="p">,</span> <span class="s1">&#39;adminStatus&#39;</span><span class="p">)</span>
<span class="go">[&lt;NetDevice: test2-abc.net.aol.com&gt;]</span>
</pre></div>
</div>
<p>Or you could just roll your own list comprehension to do the same thing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">d</span> <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">nd</span><span class="o">.</span><span class="n">all</span><span class="p">()</span> <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">adminStatus</span> <span class="o">==</span> <span class="s1">&#39;NON-PRODUCTION&#39;</span><span class="p">]</span>
<span class="go">[&lt;NetDevice: test2-abc.net.aol.com&gt;]</span>
</pre></div>
</div>
<p>Perform a case-INsenstive search on any number of fields as keyword arguments:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nd</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">oncallname</span><span class="o">=</span><span class="s1">&#39;data center&#39;</span><span class="p">,</span> <span class="n">adminstatus</span><span class="o">=</span><span class="s1">&#39;non&#39;</span><span class="p">)</span>
<span class="go">[&lt;NetDevice: test2-abc.net.aol.com&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nd</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">vendor</span><span class="o">=</span><span class="s1">&#39;netscreen&#39;</span><span class="p">)</span>
<span class="go">[&lt;NetDevice: fw1-xyz.net.aol.com&gt;]</span>
</pre></div>
</div>
</div>
<div class="section" id="helper-function">
<h4>Helper function<a class="headerlink" href="#helper-function" title="Permalink to this headline">¶</a></h4>
<p>Another nifty tool within the module is <a class="reference internal" href="../api/netdevices.html#trigger.netdevices.device_match" title="trigger.netdevices.device_match"><code class="xref py py-obj docutils literal"><span class="pre">device_match</span></code></a>,
which returns a NetDevice object:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">trigger.netdevices</span> <span class="k">import</span> <span class="n">device_match</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">device_match</span><span class="p">(</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="go">2 possible matches found for &#39;test&#39;:</span>
<span class="go"> [ 1] test1-abc.net.aol.com</span>
<span class="go"> [ 2] test2-abc.net.aol.com</span>
<span class="go"> [ 0] Exit</span>

<span class="go">Enter a device number: 2</span>
<span class="go">&lt;NetDevice: test2-abc.net.aol.com&gt;</span>
</pre></div>
</div>
<p>If there are multiple matches, it presents a prompt and lets you choose,
otherwise it chooses for you:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">device_match</span><span class="p">(</span><span class="s1">&#39;fw&#39;</span><span class="p">)</span>
<span class="go">Matched &#39;fw1-xyz.net.aol.com&#39;.</span>
<span class="go">&lt;NetDevice: fw1-xyz.net.aol.com&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="plugins.html" class="btn btn-neutral float-right" title="Plugins" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="gorc.html" class="btn btn-neutral" title="Determine commands to run upon login using .gorc" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2006-2016, AOL Inc.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.6.rc4',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>